{
  "lexicon": 1,
  "id": "app.gainforest.evaluator.service",
  "description": "Declaration record published at rkey 'self' to register an account as an evaluator service. Analogous to app.bsky.labeler.service for labelers.",
  "defs": {
    "main": {
      "type": "record",
      "description": "An evaluator service declaration. Publish at /app.gainforest.evaluator.service/self to declare this account as an evaluator.",
      "key": "literal:self",
      "record": {
        "type": "object",
        "required": ["policies", "createdAt"],
        "properties": {
          "policies": {
            "type": "ref",
            "ref": "#evaluatorPolicies",
            "description": "The evaluator's policies including supported evaluation types and access model."
          },
          "createdAt": {
            "type": "string",
            "format": "datetime",
            "description": "Timestamp of when this evaluator service was declared."
          }
        }
      }
    },
    "evaluatorPolicies": {
      "type": "object",
      "description": "Policies declaring what this evaluator does and how it operates.",
      "required": ["evaluationTypes"],
      "properties": {
        "accessModel": {
          "type": "string",
          "maxGraphemes": 64,
          "knownValues": ["open", "subscription"],
          "description": "Whether this evaluator requires user subscription ('subscription') or processes all matching records ('open')."
        },
        "evaluationTypes": {
          "type": "array",
          "items": { "type": "string", "maxGraphemes": 64 },
          "maxLength": 20,
          "description": "List of evaluation type identifiers this evaluator produces (e.g., 'species-id', 'data-quality')."
        },
        "evaluationTypeDefinitions": {
          "type": "array",
          "items": { "type": "ref", "ref": "#evaluationTypeDefinition" },
          "maxLength": 20,
          "description": "Detailed definitions for each evaluation type, including human-readable descriptions."
        },
        "subjectCollections": {
          "type": "array",
          "items": { "type": "string", "maxGraphemes": 128 },
          "maxLength": 20,
          "description": "NSIDs of record collections this evaluator can evaluate (e.g., 'app.gainforest.dwc.occurrence')."
        }
      }
    },
    "evaluationTypeDefinition": {
      "type": "object",
      "description": "Definition of a single evaluation type produced by this evaluator.",
      "required": ["identifier", "resultType"],
      "properties": {
        "identifier": {
          "type": "string",
          "maxGraphemes": 64,
          "description": "The evaluation type identifier (must match an entry in evaluationTypes)."
        },
        "resultType": {
          "type": "string",
          "maxGraphemes": 128,
          "description": "The lexicon reference for the result type (e.g., 'app.gainforest.evaluator.defs#speciesIdResult')."
        },
        "method": {
          "type": "ref",
          "ref": "app.gainforest.evaluator.defs#methodInfo",
          "description": "Default method info for this evaluation type (can be overridden per-evaluation)."
        },
        "locales": {
          "type": "array",
          "items": { "type": "ref", "ref": "#evaluationTypeLocale" },
          "maxLength": 20,
          "description": "Human-readable names and descriptions in various languages."
        }
      }
    },
    "evaluationTypeLocale": {
      "type": "object",
      "description": "Localized name and description for an evaluation type.",
      "required": ["lang", "name", "description"],
      "properties": {
        "lang": {
          "type": "string",
          "maxGraphemes": 16,
          "description": "Language code (BCP-47, e.g., 'en', 'pt-BR')."
        },
        "name": {
          "type": "string",
          "maxGraphemes": 128,
          "description": "Short human-readable name for this evaluation type."
        },
        "description": {
          "type": "string",
          "maxGraphemes": 2048,
          "description": "Longer description of what this evaluation type does."
        }
      }
    }
  }
}
