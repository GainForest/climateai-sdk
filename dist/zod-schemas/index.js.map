{"version":3,"sources":["../../src/zod-schemas/blobref.ts","../../src/zod-schemas/file.ts"],"sourcesContent":["import z from \"zod\";\nimport { CID } from \"multiformats/cid\";\nimport type { Version } from \"multiformats/cid\";\nimport { BlobRef } from \"@atproto/lexicon\";\n\nexport const BlobRefGeneratorSchema = z.object({\n  $type: z.literal(\"blob-ref-generator\"),\n  ref: z.object({\n    $link: z.string(),\n  }),\n  mimeType: z.string(),\n  size: z.number(),\n});\n\nexport type BlobRefGenerator = z.infer<typeof BlobRefGeneratorSchema>;\n\nexport const toBlobRef = (input: BlobRefGenerator) => {\n  const validCID: CID<unknown, number, number, Version> = CID.parse(\n    input.ref.$link\n  );\n  return BlobRef.fromJsonRef({\n    $type: \"blob\",\n    ref: validCID,\n    mimeType: input.mimeType,\n    size: input.size,\n  });\n};\n\nexport const toBlobRefGenerator = (blobRef: BlobRef): BlobRefGenerator => {\n  const json = blobRef.toJSON();\n  return {\n    $type: \"blob-ref-generator\",\n    ref: json.ref,\n    mimeType: json.mimeType,\n    size: json.size,\n  };\n};\n","import z from \"zod\";\n\nexport const FileGeneratorSchema = z.object({\n  name: z.string(),\n  type: z.string(),\n  dataBase64: z.string(),\n});\n\nexport type FileGenerator = z.infer<typeof FileGeneratorSchema>;\n\nexport const toFile = async (fileGenerator: FileGenerator) => {\n  const file = new File(\n    [Buffer.from(fileGenerator.dataBase64, \"base64\")],\n    fileGenerator.name,\n    { type: fileGenerator.type }\n  );\n  return file;\n};\n\nexport const toFileGenerator = async (file: File) => {\n  return {\n    name: file.name,\n    type: file.type,\n    dataBase64: await file\n      .arrayBuffer()\n      .then((buffer) => Buffer.from(buffer).toString(\"base64\")),\n  };\n};\n"],"mappings":";AAAA,OAAO,OAAO;AACd,SAAS,WAAW;AAEpB,SAAS,eAAe;AAEjB,IAAM,yBAAyB,EAAE,OAAO;AAAA,EAC7C,OAAO,EAAE,QAAQ,oBAAoB;AAAA,EACrC,KAAK,EAAE,OAAO;AAAA,IACZ,OAAO,EAAE,OAAO;AAAA,EAClB,CAAC;AAAA,EACD,UAAU,EAAE,OAAO;AAAA,EACnB,MAAM,EAAE,OAAO;AACjB,CAAC;AAIM,IAAM,YAAY,CAAC,UAA4B;AACpD,QAAM,WAAkD,IAAI;AAAA,IAC1D,MAAM,IAAI;AAAA,EACZ;AACA,SAAO,QAAQ,YAAY;AAAA,IACzB,OAAO;AAAA,IACP,KAAK;AAAA,IACL,UAAU,MAAM;AAAA,IAChB,MAAM,MAAM;AAAA,EACd,CAAC;AACH;AAEO,IAAM,qBAAqB,CAAC,YAAuC;AACxE,QAAM,OAAO,QAAQ,OAAO;AAC5B,SAAO;AAAA,IACL,OAAO;AAAA,IACP,KAAK,KAAK;AAAA,IACV,UAAU,KAAK;AAAA,IACf,MAAM,KAAK;AAAA,EACb;AACF;;;ACpCA,OAAOA,QAAO;AAEP,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,MAAMA,GAAE,OAAO;AAAA,EACf,MAAMA,GAAE,OAAO;AAAA,EACf,YAAYA,GAAE,OAAO;AACvB,CAAC;AAIM,IAAM,SAAS,OAAO,kBAAiC;AAC5D,QAAM,OAAO,IAAI;AAAA,IACf,CAAC,OAAO,KAAK,cAAc,YAAY,QAAQ,CAAC;AAAA,IAChD,cAAc;AAAA,IACd,EAAE,MAAM,cAAc,KAAK;AAAA,EAC7B;AACA,SAAO;AACT;AAEO,IAAM,kBAAkB,OAAO,SAAe;AACnD,SAAO;AAAA,IACL,MAAM,KAAK;AAAA,IACX,MAAM,KAAK;AAAA,IACX,YAAY,MAAM,KACf,YAAY,EACZ,KAAK,CAAC,WAAW,OAAO,KAAK,MAAM,EAAE,SAAS,QAAQ,CAAC;AAAA,EAC5D;AACF;","names":["z"]}