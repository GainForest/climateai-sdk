{"version":3,"sources":["../src/_internal/utilities/atproto/getBlobUrl.ts","../src/_internal/utilities/atproto/parseAtUri.ts","../src/_internal/server/session.ts","../src/_internal/zod-schemas/blobref.ts","../src/_internal/lib/isObject.ts","../src/_internal/utilities/transform/index.ts","../src/_internal/server/trpc.ts","../src/_internal/server/utils/agent.ts","../src/_internal/zod-schemas/file.ts","../src/_internal/server/routers/atproto/common/uploadFileAsBlob.ts","../src/_internal/server/routers/atproto/auth/login.ts","../src/_internal/server/routers/atproto/auth/resume.ts","../src/_internal/server/routers/atproto/auth/logout.ts","../src/_internal/lib/tryCatch.ts","../lex-api/util.ts","../lex-api/lexicons.ts","../lex-api/types/app/certified/location.ts","../lex-api/types/app/gainforest/organization/defaultSite.ts","../lex-api/types/app/gainforest/organization/info.ts","../lex-api/types/app/gainforest/organization/layer.ts","../lex-api/types/app/gainforest/organization/observations/measuredTreesCluster.ts","../lex-api/types/app/gainforest/organization/project.ts","../lex-api/types/app/gainforest/organization/site.ts","../lex-api/types/org/hypercerts/claim/activity.ts","../lex-api/types/org/hypercerts/claim/contribution.ts","../src/_internal/server/utils/classify-xrpc-error.ts","../src/_internal/server/utils/validate-record-or-throw.ts","../src/_internal/server/routers/atproto/gainforest/organization/info/get.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/get.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/getDefault.ts","../src/_internal/server/routers/atproto/gainforest/organization/observations/measuredTreesCluster/get.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/create.ts","../src/_internal/server/routers/atproto/gainforest/organization/info/createOrUpdate.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/getAll.ts","../src/_internal/lib/geojson/validate.ts","../src/_internal/lib/geojson/computations.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/utils.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/create.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/update.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/setDefault.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/delete.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/getAll.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/getAllAcrossOrgs.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/get.ts","../src/_internal/server/routers/atproto/hypercerts/location/get.ts","../src/_internal/server/utils/ownership.ts","../src/_internal/server/routers/atproto/gainforest/organization/project/utils.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/addToProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/site/removeFromProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/observations/measuredTreesCluster/addToProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/observations/measuredTreesCluster/removeFromProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/addToProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/removeFromProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/get.ts","../src/_internal/server/routers/atproto/gainforest/organization/project/get.ts","../src/_internal/server/routers/atproto/gainforest/organization/project/getAll.ts","../src/_internal/server/routers/_app.ts","../src/_internal/index.ts","../src/_public/index.ts"],"names":["BlobRef","SignJWT","jwtVerify","cookies","z","CID","superjson","initTRPC","TRPCError","Agent","CredentialSession","file","isObject","id","Lexicons","ValidationError","is$typed","validate","isMain","validateMain","hashMain","XRPCError","geometry","featureCollection","centerOfMass","turfCentroid","turfArea","turfBbox","activitiesFetchError"],"mappings":"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","file":"index.cjs","sourcesContent":["import {\n  type LargeBlob,\n  type LargeImage,\n  type SmallBlob,\n  type SmallImage,\n  type Uri,\n} from \"@/../lex-api/types/app/gainforest/common/defs\";\nimport type { $Typed } from \"@/../lex-api/util\";\nimport type { BlobRefGenerator } from \"@/_internal/zod-schemas/blobref\";\nimport { BlobRef } from \"@atproto/api\";\nimport { SupportedPDSDomain } from \"../..\";\n\nconst getBlobUrl = <T extends SupportedPDSDomain>(\n  did: string,\n  imageData:\n    | string\n    | BlobRef\n    | BlobRefGenerator\n    | $Typed<Uri | SmallImage | LargeImage | SmallBlob | LargeBlob>\n    | Uri\n    | SmallImage\n    | LargeImage\n    | SmallBlob\n    | LargeBlob,\n  pdsDomain: T\n) => {\n  if (typeof imageData === \"string\") {\n    const imageUrl = new URL(imageData);\n    return imageUrl.toString();\n  }\n\n  const isBlobRef =\n    imageData instanceof BlobRef ||\n    (\"ref\" in imageData && \"mimeType\" in imageData && \"size\" in imageData);\n  if (isBlobRef) {\n    const ref = imageData.ref as unknown as { $link?: string } | string;\n    const cid = typeof ref === \"string\" ? ref : (ref?.$link ?? String(ref));\n    const encodedCid = encodeURIComponent(cid);\n    return `https://${pdsDomain}/xrpc/com.atproto.sync.getBlob?did=${did}&cid=${encodedCid}`;\n  }\n\n  // Handle $Typed cases\n  if (imageData.$type === \"app.gainforest.common.defs#uri\") {\n    const uri = imageData.uri;\n    // TODO: handle other URI types\n    // if (uri.startsWith(\"at://\")) {\n    //   const { did: uriDid, rkey: uriRkey } = parseAtUri(uri);\n    //   return `${PDS_URL}/xrpc/com.atproto.repo.getRecord?did=${uriDid}&rkey=${uriRkey}`;\n    // }\n    return uri;\n  }\n\n  if (\n    imageData.$type === \"app.gainforest.common.defs#smallBlob\" ||\n    imageData.$type === \"app.gainforest.common.defs#largeBlob\"\n  ) {\n    const blob = imageData.blob;\n    return getBlobUrl(did, blob, pdsDomain);\n  }\n\n  if (\n    imageData.$type === \"app.gainforest.common.defs#smallImage\" ||\n    imageData.$type === \"app.gainforest.common.defs#largeImage\"\n  ) {\n    const image = imageData.image;\n    return getBlobUrl(did, image, pdsDomain);\n  }\n\n  if (\"blob\" in imageData) {\n    const blob = imageData.blob;\n    return getBlobUrl(did, blob, pdsDomain);\n  }\n\n  if (\"image\" in imageData) {\n    const image = imageData.image;\n    return getBlobUrl(did, image, pdsDomain);\n  }\n\n  if (\"uri\" in imageData) {\n    const uri = imageData.uri;\n    return uri;\n  }\n\n  // Line for compile time check that all cases are handled. THIS SHOULD NEVER BE REACHED.\n  const imageDataTypeCheck = imageData satisfies never;\n  return imageDataTypeCheck;\n};\n\nexport { getBlobUrl };\n","const parseAtUri = (atUri: string) => {\n  let cleanedAtUri = atUri.replace(\"at://\", \"\");\n\n  const splitUri = cleanedAtUri.split(\"/\");\n\n  const did = splitUri.at(0) ?? \"\";\n  const collection = splitUri.at(1) ?? \"\";\n  const rkey = splitUri.at(2) ?? \"self\";\n\n  return { did, collection, rkey };\n};\n\nexport { parseAtUri };\n","import { cookies } from \"next/headers\";\nimport { SignJWT, jwtVerify } from \"jose\";\nimport type { JwtPayload } from \"@atproto/oauth-client-node\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport interface StoredSession extends JwtPayload {\n  accessJwt: string;\n  refreshJwt: string;\n  did: string;\n  handle: string;\n}\n\nconst SECRET_KEY = new TextEncoder().encode(\n  process.env.COOKIE_SECRET || \"your-secret-key-min-32-chars-long\"\n);\n\nasync function encrypt(payload: StoredSession): Promise<string> {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"30d\")\n    .sign(SECRET_KEY);\n}\n\nasync function decrypt(token: string): Promise<StoredSession | null> {\n  try {\n    const { payload } = await jwtVerify(token, SECRET_KEY);\n    return payload as StoredSession;\n  } catch {\n    return null;\n  }\n}\n\nexport async function getSessionFromRequest(\n  service: SupportedPDSDomain = \"climateai.org\"\n): Promise<StoredSession | null> {\n  const cookieStore = await cookies();\n  const encryptedSession = cookieStore.get(`${service}_session`);\n\n  if (!encryptedSession) {\n    return null;\n  }\n\n  return await decrypt(encryptedSession.value);\n}\n\nexport async function saveSession(\n  session: StoredSession,\n  service: SupportedPDSDomain = \"climateai.org\"\n) {\n  const cookieStore = await cookies();\n  const encrypted = await encrypt(session);\n\n  cookieStore.set(`${service}_session`, encrypted, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 60 * 60 * 24 * 30,\n    path: \"/\",\n  });\n\n  return encrypted;\n}\n\nexport async function clearSession(\n  service: SupportedPDSDomain = \"climateai.org\"\n) {\n  const cookieStore = await cookies();\n  cookieStore.delete(`${service}_session`);\n}\n","import z from \"zod\";\nimport { CID } from \"multiformats/cid\";\nimport type { Version } from \"multiformats/cid\";\nimport { BlobRef } from \"@atproto/api\";\n\nconst BlobRefGeneratorSchema = z.object({\n  $type: z.literal(\"blob-ref-generator\"),\n  ref: z.object({\n    $link: z.string(),\n  }),\n  mimeType: z.string(),\n  size: z.number(),\n});\n\ntype BlobRefGenerator = z.infer<typeof BlobRefGeneratorSchema>;\n\nconst toBlobRef = (input: BlobRefGenerator) => {\n  const validCID: CID<unknown, number, number, Version> = CID.parse(\n    input.ref.$link\n  );\n  return BlobRef.fromJsonRef({\n    $type: \"blob\",\n    ref: validCID,\n    mimeType: input.mimeType,\n    size: input.size,\n  });\n};\n\nconst toBlobRefGenerator = (blobRef: BlobRef): BlobRefGenerator => {\n  const json = blobRef.toJSON() as Omit<BlobRefGenerator, \"$type\"> & {\n    $type: \"blob\";\n  };\n  return {\n    $type: \"blob-ref-generator\",\n    ref: json.ref,\n    mimeType: json.mimeType,\n    size: json.size,\n  };\n};\n\nexport {\n  BlobRefGeneratorSchema,\n  toBlobRef,\n  toBlobRefGenerator,\n  type BlobRefGenerator,\n  BlobRef,\n};\n","export const isObject = (value: unknown): value is object => {\n  return (\n    typeof value === \"object\" &&\n    value !== null &&\n    !Array.isArray(value) &&\n    !(value instanceof RegExp) &&\n    !(value instanceof Date) &&\n    !(value instanceof Set) &&\n    !(value instanceof Map)\n  );\n};\n","// utils/transformer.ts\nimport type { DataTransformer } from \"@trpc/server\";\nimport superjson, { type SuperJSONResult } from \"superjson\";\nimport {\n  type BlobRefGenerator,\n  toBlobRef,\n} from \"@/_internal/zod-schemas/blobref\";\nimport { BlobRef } from \"@atproto/api\";\nimport { isObject } from \"@/_internal/lib/isObject\";\n\ntype ReplaceType<T, U, V> =\n  // If T directly extends U, substitute to V\n  T extends U ? V\n  : // If T is an array, recursively apply ReplaceType on the element type\n  T extends (infer Item)[] ? ReplaceType<Item, U, V>[]\n  : // If T is an object, recursively apply ReplaceType on all properties\n  T extends object ? { [K in keyof T]: ReplaceType<T[K], U, V> }\n  : // Otherwise, keep original type\n    T;\n\ntype Serialize<T> = ReplaceType<T, BlobRef, BlobRefGenerator>;\n\nconst _serialize = <T>(data: T): Serialize<T> => {\n  return JSON.parse(JSON.stringify(data)) as Serialize<T>;\n};\n\nconst _deserialize = <T>(data: Serialize<T>): T => {\n  const isObj = isObject(data);\n  if (!isObj) {\n    if (Array.isArray(data)) {\n      return data.map(_deserialize) as T;\n    }\n    return data as T;\n  }\n  if (\"$type\" in data && data.$type === \"blob\" && \"ref\" in data) {\n    try {\n      return toBlobRef(data as unknown as BlobRefGenerator) as T;\n    } catch {\n      return data as T;\n    }\n  }\n\n  const obj = data as Record<string, unknown>;\n  return Object.fromEntries(\n    Object.entries(obj).map(([key, value]) => [key, _deserialize(value)])\n  ) as T;\n};\n\nexport const customTransformer: DataTransformer = {\n  serialize: (object) => {\n    // typeof object = object\n    // This logic runs for transforming the query or mutation parameters before they are sent to the server.\n    // Conversion of object to string is automatically handled by TRPC.\n    const atprotoSerialized = _serialize(object);\n    const serializedObject = superjson.serialize(atprotoSerialized);\n    return serializedObject;\n  },\n  deserialize: <T>(object: SuperJSONResult): T => {\n    // typeof object = { json: object }\n    // This logic runs for transforming the query or mutation response before it is received by the client.\n    // The received response is automatically converted from stringified JSON to object by TRPC.\n    const superjsonDeserialized = superjson.deserialize(object) as Serialize<T>;\n    const deserializedObject = _deserialize(superjsonDeserialized);\n    // console.log(\"deserialized object\", deserializedObject);\n    return deserializedObject as T;\n  },\n};\n\nexport type SerializedSuperjson<T> = Omit<SuperJSONResult, \"json\"> & {\n  json: Serialize<T>;\n};\n\nexport const serialize = <T>(data: T) => {\n  const result = customTransformer.serialize(data);\n  return result as SerializedSuperjson<T>;\n};\n\nexport const deserialize = <T>(object: SerializedSuperjson<T>): T => {\n  return customTransformer.deserialize(object);\n};\n","import { initTRPC, TRPCError } from \"@trpc/server\";\nimport { getSessionFromRequest } from \"./session\";\nimport { customTransformer } from \"../utilities/transform\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport async function createContext<T extends SupportedPDSDomain>(opts?: {\n  req?: Request;\n  allowedPDSDomains: T[];\n}) {\n  // Extract session from cookies/headers\n  const session =\n    opts?.req ? await getSessionFromRequest(opts.allowedPDSDomains[0]) : null;\n\n  return {\n    session,\n  };\n}\n\nexport type TrpcContext = Awaited<ReturnType<typeof createContext>>;\n\nconst t = initTRPC.context<TrpcContext>().create({\n  transformer: customTransformer,\n});\n\nexport const createTRPCRouter = t.router;\nexport const publicProcedure = t.procedure;\n\nexport const protectedProcedure = t.procedure.use(({ ctx, next }) => {\n  if (!ctx.session) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You must be logged in\",\n    });\n  }\n  return next({ ctx });\n});\n","import { Agent, CredentialSession } from \"@atproto/api\";\nimport { getSessionFromRequest } from \"../session\";\nimport { TRPCError } from \"@trpc/server\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const getReadAgent = <T extends SupportedPDSDomain>(pdsDomain: T) => {\n  return new Agent({\n    service: new URL(`https://${pdsDomain}`),\n  });\n};\n\nexport const getWriteAgent = async <T extends SupportedPDSDomain>(\n  pdsDomain: T\n) => {\n  const session = await getSessionFromRequest(pdsDomain);\n  if (!session)\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized.\",\n    });\n  const credentialSession = new CredentialSession(\n    new URL(`https://${pdsDomain}`)\n  );\n  const result = await credentialSession.resumeSession({\n    accessJwt: session.accessJwt,\n    refreshJwt: session.refreshJwt,\n    handle: session.handle,\n    did: session.did,\n    active: true,\n  });\n  if (!result.success)\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"Failed to resume session.\",\n    });\n  return new Agent(credentialSession);\n};\n","import z from \"zod\";\n\nexport const FileGeneratorSchema = z.object({\n  name: z.string(),\n  type: z.string(),\n  dataBase64: z.string(),\n});\n\nexport type FileGenerator = z.infer<typeof FileGeneratorSchema>;\n\nexport const toFile = async (fileGenerator: FileGenerator) => {\n  const file = new File(\n    [Buffer.from(fileGenerator.dataBase64, \"base64\")],\n    fileGenerator.name,\n    { type: fileGenerator.type }\n  );\n  return file;\n};\n\nexport const toFileGenerator = async (file: File) => {\n  return {\n    name: file.name,\n    type: file.type,\n    dataBase64: await file\n      .arrayBuffer()\n      .then((buffer) => Buffer.from(buffer).toString(\"base64\")),\n  };\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport z, { file } from \"zod\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport {\n  FileGeneratorSchema,\n  toFile,\n  type FileGenerator,\n} from \"@/_internal/zod-schemas/file\";\nimport { BlobRef, type Agent } from \"@atproto/api\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const uploadFileAsBlobPure = async (\n  file: File | FileGenerator,\n  agent: Agent\n) => {\n  let fileToUpload: File;\n  if (file instanceof File) {\n    fileToUpload = file;\n  } else {\n    fileToUpload = await toFile(file);\n  }\n  const response = await agent.uploadBlob(fileToUpload);\n\n  if (response.success !== true) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to upload file as blob.\",\n    });\n  }\n  return response.data;\n};\n\nexport const uploadFileAsBlobFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        file: FileGeneratorSchema,\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      const response = await uploadFileAsBlobPure(input.file, agent);\n\n      return response;\n    });\n};\n","import { type SupportedPDSDomain } from \"@/_internal/index\";\nimport { saveSession, type StoredSession } from \"@/_internal/server/session\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport { CredentialSession } from \"@atproto/api\";\nimport { TRPCError } from \"@trpc/server\";\nimport z from \"zod\";\n\nexport const loginFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        handlePrefix: z.string().regex(/^^[a-zA-Z0-9-]+$/), // alphanumerics and hyphens only\n        service: allowedPDSDomainSchema,\n        password: z.string(),\n      })\n    )\n    .mutation(async ({ input }) => {\n      const session = new CredentialSession(\n        new URL(`https://${input.service}`)\n      );\n      const result = await session.login({\n        identifier: `${input.handlePrefix}.${input.service}`,\n        password: input.password,\n      });\n      if (!result.success) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Login failed\",\n        });\n      }\n      const context: StoredSession = {\n        accessJwt: result.data.accessJwt,\n        refreshJwt: result.data.refreshJwt,\n        did: result.data.did,\n        handle: result.data.handle,\n      };\n      await saveSession(context, input.service);\n      return {\n        did: context.did,\n        handle: context.handle,\n        service: input.service,\n      };\n    });\n};\n","import { type SupportedPDSDomain } from \"@/_internal/index\";\nimport { getSessionFromRequest } from \"@/_internal/server/session\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport { TRPCError } from \"@trpc/server\";\nimport z from \"zod\";\n\nexport const resumeFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        service: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const session = await getSessionFromRequest(input.service);\n      if (!session) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"No session found\",\n        });\n      }\n      return {\n        did: session.did,\n        handle: session.handle,\n        service: input.service,\n      };\n    });\n};\n","import { type SupportedPDSDomain } from \"@/_internal/index\";\nimport { clearSession } from \"@/_internal/server/session\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\n\nexport const logoutFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        service: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      await clearSession(input.service);\n      return {\n        success: true,\n      };\n    });\n};\n","export const tryCatch = async <T>(\n  promise: Promise<T>\n): Promise<[T, null] | [null, Error]> => {\n  try {\n    const result = await promise;\n    return [result, null];\n  } catch (error) {\n    return [null, error as Error];\n  }\n};\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\n\nimport { type ValidationResult } from '@atproto/lexicon'\n\nexport type OmitKey<T, K extends keyof T> = {\n  [K2 in keyof T as K2 extends K ? never : K2]: T[K2]\n}\n\nexport type $Typed<V, T extends string = string> = V & { $type: T }\nexport type Un$Typed<V extends { $type?: string }> = OmitKey<V, '$type'>\n\nexport type $Type<Id extends string, Hash extends string> = Hash extends 'main'\n  ? Id\n  : `${Id}#${Hash}`\n\nfunction isObject<V>(v: V): v is V & object {\n  return v != null && typeof v === 'object'\n}\n\nfunction is$type<Id extends string, Hash extends string>(\n  $type: unknown,\n  id: Id,\n  hash: Hash,\n): $type is $Type<Id, Hash> {\n  return hash === 'main'\n    ? $type === id\n    : // $type === `${id}#${hash}`\n      typeof $type === 'string' &&\n        $type.length === id.length + 1 + hash.length &&\n        $type.charCodeAt(id.length) === 35 /* '#' */ &&\n        $type.startsWith(id) &&\n        $type.endsWith(hash)\n}\n\nexport type $TypedObject<\n  V,\n  Id extends string,\n  Hash extends string,\n> = V extends {\n  $type: $Type<Id, Hash>\n}\n  ? V\n  : V extends { $type?: string }\n    ? V extends { $type?: infer T extends $Type<Id, Hash> }\n      ? V & { $type: T }\n      : never\n    : V & { $type: $Type<Id, Hash> }\n\nexport function is$typed<V, Id extends string, Hash extends string>(\n  v: V,\n  id: Id,\n  hash: Hash,\n): v is $TypedObject<V, Id, Hash> {\n  return isObject(v) && '$type' in v && is$type(v.$type, id, hash)\n}\n\nexport function maybe$typed<V, Id extends string, Hash extends string>(\n  v: V,\n  id: Id,\n  hash: Hash,\n): v is V & object & { $type?: $Type<Id, Hash> } {\n  return (\n    isObject(v) &&\n    ('$type' in v ? v.$type === undefined || is$type(v.$type, id, hash) : true)\n  )\n}\n\nexport type Validator<R = unknown> = (v: unknown) => ValidationResult<R>\nexport type ValidatorParam<V extends Validator> =\n  V extends Validator<infer R> ? R : never\n\n/**\n * Utility function that allows to convert a \"validate*\" utility function into a\n * type predicate.\n */\nexport function asPredicate<V extends Validator>(validate: V) {\n  return function <T>(v: T): v is T & ValidatorParam<V> {\n    return validate(v).success\n  }\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport {\n  type LexiconDoc,\n  Lexicons,\n  ValidationError,\n  type ValidationResult,\n} from '@atproto/lexicon'\nimport { type $Typed, is$typed, maybe$typed } from './util.js'\n\nexport const schemaDict = {\n  AppCertifiedLocation: {\n    lexicon: 1,\n    id: 'app.certified.location',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A location reference',\n        key: 'any',\n        record: {\n          type: 'object',\n          required: [\n            'lpVersion',\n            'srs',\n            'locationType',\n            'location',\n            'createdAt',\n          ],\n          properties: {\n            lpVersion: {\n              type: 'string',\n              description: 'The version of the Location Protocol',\n              maxLength: 10,\n            },\n            srs: {\n              type: 'string',\n              format: 'uri',\n              description:\n                'The Spatial Reference System URI (e.g., http://www.opengis.net/def/crs/OGC/1.3/CRS84) that defines the coordinate system.',\n              maxLength: 100,\n            },\n            locationType: {\n              type: 'string',\n              description:\n                'An identifier for the format of the location data (e.g., coordinate-decimal, geojson-point)',\n              knownValues: ['coordinate-decimal', 'geojson-point'],\n              maxLength: 20,\n            },\n            location: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'The location of where the work was performed as a URI or blob.',\n            },\n            name: {\n              type: 'string',\n              description: 'Optional name for this location',\n              maxLength: 1000,\n              maxGraphemes: 100,\n            },\n            description: {\n              type: 'string',\n              description: 'Optional description for this location',\n              maxLength: 2000,\n              maxGraphemes: 500,\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestCommonDefs: {\n    lexicon: 1,\n    id: 'app.gainforest.common.defs',\n    defs: {\n      uri: {\n        type: 'object',\n        required: ['uri'],\n        description: 'Object containing a URI to external data',\n        properties: {\n          uri: {\n            type: 'string',\n            format: 'uri',\n            maxGraphemes: 1024,\n            description: 'URI to external data',\n          },\n        },\n      },\n      smallBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 10485760,\n            description: 'Blob to external data (up to 10MB)',\n          },\n        },\n      },\n      largeBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 104857600,\n            description: 'Blob to external data (up to 100MB)',\n          },\n        },\n      },\n      smallImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a small image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 5242880,\n            description: 'Image (up to 5MB)',\n          },\n        },\n      },\n      largeImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a large image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 10485760,\n            description: 'Image (up to 10MB)',\n          },\n        },\n      },\n      indexedOrganization: {\n        type: 'object',\n        required: ['id', 'name'],\n        properties: {\n          id: {\n            type: 'string',\n            format: 'uri',\n            description: 'The URI of the organization',\n          },\n          name: {\n            type: 'string',\n            description: 'The name of the organization',\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationDefaultSite: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.defaultSite',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of the default site for an organization',\n        key: 'literal:self',\n        record: {\n          type: 'object',\n          required: ['site', 'createdAt'],\n          properties: {\n            site: {\n              type: 'string',\n              format: 'at-uri',\n              description:\n                'The reference to the default site record in the PDS',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationDraftEcocert: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.draft.ecocert',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A declaration of an unpublished ecocert for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: [\n            'title',\n            'coverImage',\n            'workScopes',\n            'workStartDate',\n            'workEndDate',\n            'description',\n            'shortDescription',\n            'contributors',\n            'site',\n            'createdAt',\n          ],\n          nullable: ['coverImage'],\n          properties: {\n            title: {\n              type: 'string',\n              description: 'The title of the ecocert',\n            },\n            coverImage: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallImage',\n              description: 'The cover image of the ecocert',\n            },\n            workScopes: {\n              type: 'array',\n              description: 'The work scopes of the ecocert',\n              items: {\n                type: 'string',\n                description: 'The work scope of the ecocert',\n              },\n            },\n            workStartDate: {\n              type: 'string',\n              description: 'The start date of the work',\n              format: 'datetime',\n            },\n            workEndDate: {\n              type: 'string',\n              description: 'The end date of the work',\n              format: 'datetime',\n            },\n            description: {\n              type: 'string',\n              description: 'The description of the ecocert in markdown',\n            },\n            shortDescription: {\n              type: 'string',\n              description: 'The short description of the ecocert in markdown',\n            },\n            contributors: {\n              type: 'array',\n              description: 'The contributors of the ecocert in markdown',\n              items: {\n                type: 'string',\n                description: 'The contributor of the ecocert',\n              },\n            },\n            site: {\n              type: 'string',\n              format: 'at-uri',\n              description: 'The reference to the site record in the PDS',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationGetIndexedOrganizations: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.getIndexedOrganizations',\n    defs: {\n      main: {\n        type: 'query',\n        description: 'Get all organizations to view initially on map',\n        parameters: {\n          type: 'params',\n          properties: {},\n        },\n        output: {\n          encoding: 'application/json',\n          schema: {\n            type: 'object',\n            required: ['organizations'],\n            properties: {\n              organizations: {\n                type: 'array',\n                items: {\n                  type: 'ref',\n                  ref: 'lex:app.gainforest.common.defs#indexedOrganization',\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationInfo: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.info',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of an organization or project',\n        key: 'literal:self',\n        record: {\n          type: 'object',\n          required: [\n            'displayName',\n            'shortDescription',\n            'longDescription',\n            'objectives',\n            'country',\n            'visibility',\n            'createdAt',\n          ],\n          properties: {\n            displayName: {\n              type: 'string',\n              description: 'The name of the organization or project',\n              minLength: 8,\n              maxLength: 255,\n            },\n            shortDescription: {\n              type: 'string',\n              description: 'The description of the organization or project',\n              minLength: 50,\n              maxLength: 2000,\n            },\n            longDescription: {\n              type: 'string',\n              description:\n                'The long description of the organization or project in markdown',\n              minLength: 50,\n              maxLength: 5000,\n            },\n            coverImage: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallImage',\n              description: 'Cover image for the organization',\n            },\n            logo: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallImage',\n              description: 'Logo for the organization',\n            },\n            objectives: {\n              type: 'array',\n              description: 'The objectives of the organization or project',\n              items: {\n                type: 'string',\n                enum: [\n                  'Conservation',\n                  'Research',\n                  'Education',\n                  'Community',\n                  'Other',\n                ],\n              },\n            },\n            startDate: {\n              type: 'string',\n              description: 'The start date of the organization or project',\n              format: 'datetime',\n            },\n            website: {\n              type: 'string',\n              description: 'The website of the organization or project',\n              format: 'uri',\n            },\n            country: {\n              type: 'string',\n              description:\n                'The country of the organization or project in two letter code (ISO 3166-1 alpha-2)',\n            },\n            visibility: {\n              type: 'string',\n              description:\n                'The visibility of the organization or project in the Green Globe',\n              enum: ['Public', 'Hidden'],\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationLayer: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.layer',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a layer for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['name', 'type', 'uri', 'createdAt'],\n          properties: {\n            name: {\n              type: 'string',\n              description: 'The name of the site',\n            },\n            type: {\n              type: 'string',\n              description: 'The type of the layer',\n              enum: [\n                'geojson_points',\n                'geojson_points_trees',\n                'geojson_line',\n                'choropleth',\n                'choropleth_shannon',\n                'raster_tif',\n                'tms_tile',\n              ],\n            },\n            uri: {\n              type: 'string',\n              format: 'uri',\n              description: 'The URI of the layer',\n            },\n            description: {\n              type: 'string',\n              description: 'The description of the layer',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsDendogram: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.dendogram',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A declaration of a dendogram observation for an organization',\n        key: 'literal:self',\n        record: {\n          type: 'object',\n          required: ['dendogram', 'createdAt'],\n          properties: {\n            dendogram: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallBlob',\n              description: 'An SVG of the dendogram uploaded as blob',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsFauna: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.fauna',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a fauna observation for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each fauna observation',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the fauna observation',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsFlora: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.flora',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a flora observation for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each flora observation',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the flora observation',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsMeasuredTreesCluster: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.measuredTreesCluster',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A declaration of a measured trees cluster for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['shapefile', 'createdAt'],\n          properties: {\n            shapefile: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallBlob',\n              description:\n                'A blob pointing to a shapefile of the measured trees cluster',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationPredictionsFauna: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.predictions.fauna',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a fauna prediction for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each fauna prediction',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the fauna prediction',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationPredictionsFlora: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.predictions.flora',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a flora prediction for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each flora prediction',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the flora prediction',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationProject: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.project',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a project for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: [\n            'name',\n            'shortDescription',\n            'ecocerts',\n            'sites',\n            'measuredTreesClusters',\n            'layers',\n            'createdAt',\n          ],\n          properties: {\n            name: {\n              type: 'string',\n              description: 'The name of the site',\n            },\n            description: {\n              type: 'string',\n              description: 'The description of the project in markdown',\n            },\n            shortDescription: {\n              type: 'string',\n              description: 'The short description of the project',\n            },\n            ecocerts: {\n              type: 'array',\n              description:\n                'An array of at-uris pointing to the records of the ecocerts related to the project',\n              items: {\n                type: 'string',\n                format: 'at-uri',\n                description: 'The reference to the ecocert record in the PDS',\n              },\n            },\n            layers: {\n              type: 'array',\n              description:\n                'An array of at-uris pointing to the records of the layers related to the project',\n              items: {\n                type: 'string',\n                format: 'at-uri',\n                description: 'The reference to the layer record in the PDS',\n              },\n            },\n            sites: {\n              type: 'array',\n              description:\n                'An array of at-uris pointing to the records of the sites related to the project',\n              items: {\n                type: 'string',\n                format: 'at-uri',\n                description: 'The reference to the site record in the PDS',\n              },\n            },\n            measuredTreesClusters: {\n              type: 'array',\n              description:\n                'An array of at-uris pointing to the records of the measured trees clusters related to the project',\n              items: {\n                type: 'string',\n                format: 'at-uri',\n                description:\n                  'The reference to the measured trees cluster record in the PDS',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationSite: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.site',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a site for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['name', 'lat', 'lon', 'area', 'shapefile', 'createdAt'],\n          properties: {\n            name: {\n              type: 'string',\n              description: 'The name of the site',\n            },\n            lat: {\n              type: 'string',\n              description: 'The latitude of the centerpoint of the site',\n            },\n            lon: {\n              type: 'string',\n              description: 'The longitude of the centerpoint of the site',\n            },\n            area: {\n              type: 'string',\n              description: 'The area of the site in hectares',\n            },\n            shapefile: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallBlob',\n              description:\n                'A blob pointing to a geoJSON file containing the site boundaries',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  ComAtprotoRepoStrongRef: {\n    lexicon: 1,\n    id: 'com.atproto.repo.strongRef',\n    description: 'A URI with a content-hash fingerprint.',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['uri', 'cid'],\n        properties: {\n          uri: {\n            type: 'string',\n            format: 'at-uri',\n          },\n          cid: {\n            type: 'string',\n            format: 'cid',\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimActivity: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.activity',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A hypercert record tracking impact work.',\n        key: 'any',\n        record: {\n          type: 'object',\n          required: [\n            'title',\n            'shortDescription',\n            'createdAt',\n            'startDate',\n            'endDate',\n          ],\n          properties: {\n            title: {\n              type: 'string',\n              description: 'Title of the hypercert',\n              maxLength: 256,\n            },\n            shortDescription: {\n              type: 'string',\n              description: 'Short blurb of the impact work done.',\n              maxLength: 3000,\n              maxGraphemes: 300,\n            },\n            description: {\n              type: 'string',\n              description:\n                'Optional longer description of the impact work done.',\n              maxLength: 30000,\n              maxGraphemes: 3000,\n            },\n            image: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallImage',\n              ],\n              description:\n                'The hypercert visual representation as a URI or image blob',\n            },\n            workScope: {\n              type: 'ref',\n              ref: 'lex:org.hypercerts.claim.activity#workScope',\n            },\n            startDate: {\n              type: 'string',\n              format: 'datetime',\n              description: 'When the work began',\n            },\n            endDate: {\n              type: 'string',\n              format: 'datetime',\n              description: 'When the work ended',\n            },\n            contributions: {\n              type: 'array',\n              description:\n                'A strong reference to the contributions done to create the impact in the hypercerts. The record referenced must conform with the lexicon org.hypercerts.claim.contribution',\n              items: {\n                type: 'ref',\n                ref: 'lex:com.atproto.repo.strongRef',\n              },\n            },\n            rights: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the rights that this hypercert has. The record referenced must conform with the lexicon org.hypercerts.claim.rights',\n            },\n            location: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the location where the work for done hypercert was located. The record referenced must conform with the lexicon app.certified.location',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n      workScope: {\n        type: 'object',\n        description:\n          'Logical scope of the work using label-based conditions. All labels in `allOf` must apply; at least one label in `anyOf` must apply if provided; no label in `noneOf` may apply.',\n        properties: {\n          allOf: {\n            type: 'array',\n            description: 'Labels that MUST all hold for the scope to apply.',\n            items: {\n              type: 'string',\n            },\n            maxLength: 100,\n          },\n          anyOf: {\n            type: 'array',\n            description:\n              'Labels of which AT LEAST ONE must hold (optional). If omitted or empty, imposes no additional condition.',\n            items: {\n              type: 'string',\n            },\n            maxLength: 100,\n          },\n          noneOf: {\n            type: 'array',\n            description: 'Labels that MUST NOT hold for the scope to apply.',\n            items: {\n              type: 'string',\n            },\n            maxLength: 100,\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimCollection: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.collection',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A collection/group of hypercerts that have a specific property.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['title', 'claims', 'createdAt'],\n          properties: {\n            title: {\n              type: 'string',\n              description: 'The title of this collection',\n              maxLength: 800,\n              maxGraphemes: 80,\n            },\n            shortDescription: {\n              type: 'string',\n              maxLength: 3000,\n              maxGraphemes: 300,\n              description: 'A short description of this collection',\n            },\n            coverPhoto: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'The cover photo of this collection (either in URI format or in a blob).',\n            },\n            claims: {\n              type: 'array',\n              description:\n                'Array of claims with their associated weights in this collection',\n              items: {\n                type: 'ref',\n                ref: 'lex:org.hypercerts.claim.collection#claimItem',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n      claimItem: {\n        type: 'object',\n        required: ['claim', 'weight'],\n        properties: {\n          claim: {\n            type: 'ref',\n            ref: 'lex:com.atproto.repo.strongRef',\n            description:\n              'A strong reference to a hypercert claim record. This claim must conform to the lexicon org.hypercerts.claim.activity',\n          },\n          weight: {\n            type: 'string',\n            description:\n              'The weight/importance of this hypercert claim in the collection (a percentage from 0-100, stored as a string to avoid float precision issues). The total claim weights should add up to 100.',\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimContribution: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.contribution',\n    defs: {\n      main: {\n        type: 'record',\n        description: \"A contribution made toward a hypercert's impact.\",\n        key: 'any',\n        record: {\n          type: 'object',\n          required: ['contributors', 'createdAt'],\n          properties: {\n            role: {\n              type: 'string',\n              description: 'Role or title of the contributor(s).',\n              maxLength: 100,\n            },\n            contributors: {\n              type: 'array',\n              description:\n                'List of the contributors (names, pseudonyms, or DIDs). If multiple contributors are stored in the same hypercertContribution, then they would have the exact same role.',\n              items: {\n                type: 'string',\n              },\n            },\n            description: {\n              type: 'string',\n              description: 'What the contribution concretely achieved',\n              maxLength: 2000,\n              maxGraphemes: 500,\n            },\n            startDate: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'When this contribution started. This should be a subset of the hypercert timeframe.',\n            },\n            endDate: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'When this contribution finished.  This should be a subset of the hypercert timeframe.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimEvaluation: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.evaluation',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'An evaluation of a hypercert or other claim',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['subject', 'evaluators', 'summary', 'createdAt'],\n          properties: {\n            subject: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the evaluated claim. (e.g measurement, hypercert, contribution, etc)',\n            },\n            evaluators: {\n              type: 'array',\n              description: 'DIDs of the evaluators',\n              items: {\n                type: 'string',\n                format: 'did',\n              },\n              maxLength: 100,\n            },\n            evaluations: {\n              type: 'array',\n              description:\n                'Evaluation data (URIs or blobs) containing detailed reports or methodology',\n              items: {\n                type: 'union',\n                refs: [\n                  'lex:org.hypercerts.defs#uri',\n                  'lex:org.hypercerts.defs#smallBlob',\n                ],\n              },\n              maxLength: 100,\n            },\n            summary: {\n              type: 'string',\n              description: 'Brief evaluation summary',\n              maxLength: 5000,\n              maxGraphemes: 1000,\n            },\n            location: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'An optional reference for georeferenced evaluations. The record referenced must conform with the lexicon app.certified.location.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimEvidence: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.evidence',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A piece of evidence supporting a hypercert claim',\n        key: 'any',\n        record: {\n          type: 'object',\n          required: ['content', 'title', 'createdAt'],\n          properties: {\n            activity: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the activity this evidence is for. The record referenced must conform with the lexicon org.hypercerts.claim.activity',\n            },\n            content: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'A piece of evidence (URI or blobs) supporting a hypercert claim',\n            },\n            title: {\n              type: 'string',\n              maxLength: 256,\n              description: 'Title to describe the nature of the evidence',\n            },\n            shortDescription: {\n              type: 'string',\n              maxLength: 3000,\n              maxGraphemes: 300,\n              description:\n                'Short description explaining what this evidence demonstrates or proves',\n            },\n            description: {\n              type: 'string',\n              description:\n                'Longer description describing the impact claim evidence.',\n              maxLength: 30000,\n              maxGraphemes: 3000,\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this hypercert claim was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimMeasurement: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.measurement',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'External measurement data supporting a hypercert claim',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['activity', 'measurers', 'metric', 'value', 'createdAt'],\n          properties: {\n            activity: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the activity that this measurement is for. The record referenced must conform with the lexicon org.hypercerts.claim.activity',\n            },\n            measurers: {\n              type: 'array',\n              description:\n                'DIDs of the entity (or entities) that measured this data',\n              items: {\n                type: 'string',\n                format: 'did',\n              },\n              maxLength: 100,\n            },\n            metric: {\n              type: 'string',\n              description: 'The metric being measured',\n              maxLength: 500,\n            },\n            value: {\n              type: 'string',\n              description: 'The measured value',\n              maxLength: 500,\n            },\n            measurementMethodType: {\n              type: 'string',\n              description: 'Short identifier for the measurement methodology',\n              maxLength: 30,\n            },\n            measurementMethodURI: {\n              type: 'string',\n              format: 'uri',\n              description:\n                'URI to methodology documentation, standard protocol, or measurement procedure',\n            },\n            evidenceURI: {\n              type: 'array',\n              description: 'URIs to supporting evidence or data',\n              items: {\n                type: 'string',\n                format: 'uri',\n              },\n              maxLength: 50,\n            },\n            location: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the location where the measurement was taken. The record referenced must conform with the lexicon app.certified.location',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimRights: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.rights',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'Describes the rights that a contributor and/or an owner has, such as whether the hypercert can be sold, transferred, and under what conditions.',\n        key: 'any',\n        record: {\n          type: 'object',\n          required: [\n            'rightsName',\n            'rightsType',\n            'rightsDescription',\n            'createdAt',\n          ],\n          properties: {\n            rightsName: {\n              type: 'string',\n              description: 'Full name of the rights',\n              maxLength: 100,\n            },\n            rightsType: {\n              type: 'string',\n              description: 'Short rights identifier for easier search',\n              maxLength: 10,\n            },\n            rightsDescription: {\n              type: 'string',\n              description: 'Description of the rights of this hypercert',\n            },\n            attachment: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'An attachment to define the rights further, e.g. a legal document.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsDefs: {\n    lexicon: 1,\n    id: 'org.hypercerts.defs',\n    defs: {\n      uri: {\n        type: 'object',\n        required: ['uri'],\n        description: 'Object containing a URI to external data',\n        properties: {\n          uri: {\n            type: 'string',\n            format: 'uri',\n            maxGraphemes: 1024,\n            description: 'URI to external data',\n          },\n        },\n      },\n      smallBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 10485760,\n            description: 'Blob to external data (up to 10MB)',\n          },\n        },\n      },\n      largeBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 104857600,\n            description: 'Blob to external data (up to 100MB)',\n          },\n        },\n      },\n      smallImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a small image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 5242880,\n            description: 'Image (up to 5MB)',\n          },\n        },\n      },\n      largeImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a large image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 10485760,\n            description: 'Image (up to 10MB)',\n          },\n        },\n      },\n    },\n  },\n} as const satisfies Record<string, LexiconDoc>\nexport const schemas = Object.values(schemaDict) satisfies LexiconDoc[]\nexport const lexicons: Lexicons = new Lexicons(schemas)\n\nexport function validate<T extends { $type: string }>(\n  v: unknown,\n  id: string,\n  hash: string,\n  requiredType: true,\n): ValidationResult<T>\nexport function validate<T extends { $type?: string }>(\n  v: unknown,\n  id: string,\n  hash: string,\n  requiredType?: false,\n): ValidationResult<T>\nexport function validate(\n  v: unknown,\n  id: string,\n  hash: string,\n  requiredType?: boolean,\n): ValidationResult {\n  return (requiredType ? is$typed : maybe$typed)(v, id, hash)\n    ? lexicons.validate(`${id}#${hash}`, v)\n    : {\n        success: false,\n        error: new ValidationError(\n          `Must be an object with \"${hash === 'main' ? id : `${id}#${hash}`}\" $type property`,\n        ),\n      }\n}\n\nexport const ids = {\n  AppCertifiedLocation: 'app.certified.location',\n  AppGainforestCommonDefs: 'app.gainforest.common.defs',\n  AppGainforestOrganizationDefaultSite:\n    'app.gainforest.organization.defaultSite',\n  AppGainforestOrganizationDraftEcocert:\n    'app.gainforest.organization.draft.ecocert',\n  AppGainforestOrganizationGetIndexedOrganizations:\n    'app.gainforest.organization.getIndexedOrganizations',\n  AppGainforestOrganizationInfo: 'app.gainforest.organization.info',\n  AppGainforestOrganizationLayer: 'app.gainforest.organization.layer',\n  AppGainforestOrganizationObservationsDendogram:\n    'app.gainforest.organization.observations.dendogram',\n  AppGainforestOrganizationObservationsFauna:\n    'app.gainforest.organization.observations.fauna',\n  AppGainforestOrganizationObservationsFlora:\n    'app.gainforest.organization.observations.flora',\n  AppGainforestOrganizationObservationsMeasuredTreesCluster:\n    'app.gainforest.organization.observations.measuredTreesCluster',\n  AppGainforestOrganizationPredictionsFauna:\n    'app.gainforest.organization.predictions.fauna',\n  AppGainforestOrganizationPredictionsFlora:\n    'app.gainforest.organization.predictions.flora',\n  AppGainforestOrganizationProject: 'app.gainforest.organization.project',\n  AppGainforestOrganizationSite: 'app.gainforest.organization.site',\n  ComAtprotoRepoStrongRef: 'com.atproto.repo.strongRef',\n  OrgHypercertsClaimActivity: 'org.hypercerts.claim.activity',\n  OrgHypercertsClaimCollection: 'org.hypercerts.claim.collection',\n  OrgHypercertsClaimContribution: 'org.hypercerts.claim.contribution',\n  OrgHypercertsClaimEvaluation: 'org.hypercerts.claim.evaluation',\n  OrgHypercertsClaimEvidence: 'org.hypercerts.claim.evidence',\n  OrgHypercertsClaimMeasurement: 'org.hypercerts.claim.measurement',\n  OrgHypercertsClaimRights: 'org.hypercerts.claim.rights',\n  OrgHypercertsDefs: 'org.hypercerts.defs',\n} as const\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../lexicons'\nimport { type $Typed, is$typed as _is$typed, type OmitKey } from '../../../util'\nimport type * as OrgHypercertsDefs from '../../org/hypercerts/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.certified.location'\n\nexport interface Main {\n  $type: 'app.certified.location'\n  /** The version of the Location Protocol */\n  lpVersion: string\n  /** The Spatial Reference System URI (e.g., http://www.opengis.net/def/crs/OGC/1.3/CRS84) that defines the coordinate system. */\n  srs: string\n  /** An identifier for the format of the location data (e.g., coordinate-decimal, geojson-point) */\n  locationType: 'coordinate-decimal' | 'geojson-point' | (string & {})\n  location:\n    | $Typed<OrgHypercertsDefs.Uri>\n    | $Typed<OrgHypercertsDefs.SmallBlob>\n    | { $type: string }\n  /** Optional name for this location */\n  name?: string\n  /** Optional description for this location */\n  description?: string\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.defaultSite'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.defaultSite'\n  /** The reference to the default site record in the PDS */\n  site: string\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\nimport type * as AppGainforestCommonDefs from '../common/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.info'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.info'\n  /** The name of the organization or project */\n  displayName: string\n  /** The description of the organization or project */\n  shortDescription: string\n  /** The long description of the organization or project in markdown */\n  longDescription: string\n  coverImage?: AppGainforestCommonDefs.SmallImage\n  logo?: AppGainforestCommonDefs.SmallImage\n  /** The objectives of the organization or project */\n  objectives: (\n    | 'Conservation'\n    | 'Research'\n    | 'Education'\n    | 'Community'\n    | 'Other'\n  )[]\n  /** The start date of the organization or project */\n  startDate?: string\n  /** The website of the organization or project */\n  website?: string\n  /** The country of the organization or project in two letter code (ISO 3166-1 alpha-2) */\n  country: string\n  /** The visibility of the organization or project in the Green Globe */\n  visibility: 'Public' | 'Hidden'\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.layer'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.layer'\n  /** The name of the site */\n  name: string\n  /** The type of the layer */\n  type:\n    | 'geojson_points'\n    | 'geojson_points_trees'\n    | 'geojson_line'\n    | 'choropleth'\n    | 'choropleth_shannon'\n    | 'raster_tif'\n    | 'tms_tile'\n  /** The URI of the layer */\n  uri: string\n  /** The description of the layer */\n  description?: string\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../../util'\nimport type * as AppGainforestCommonDefs from '../../common/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.observations.measuredTreesCluster'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.observations.measuredTreesCluster'\n  shapefile: AppGainforestCommonDefs.SmallBlob\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.project'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.project'\n  /** The name of the site */\n  name: string\n  /** The description of the project in markdown */\n  description?: string\n  /** The short description of the project */\n  shortDescription: string\n  /** An array of at-uris pointing to the records of the ecocerts related to the project */\n  ecocerts: string[]\n  /** An array of at-uris pointing to the records of the layers related to the project */\n  layers: string[]\n  /** An array of at-uris pointing to the records of the sites related to the project */\n  sites: string[]\n  /** An array of at-uris pointing to the records of the measured trees clusters related to the project */\n  measuredTreesClusters: string[]\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\nimport type * as AppGainforestCommonDefs from '../common/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.site'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.site'\n  /** The name of the site */\n  name: string\n  /** The latitude of the centerpoint of the site */\n  lat: string\n  /** The longitude of the centerpoint of the site */\n  lon: string\n  /** The area of the site in hectares */\n  area: string\n  shapefile: AppGainforestCommonDefs.SmallBlob\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\nimport type * as OrgHypercertsDefs from '../defs.js'\nimport type * as ComAtprotoRepoStrongRef from '../../../com/atproto/repo/strongRef.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'org.hypercerts.claim.activity'\n\nexport interface Main {\n  $type: 'org.hypercerts.claim.activity'\n  /** Title of the hypercert */\n  title: string\n  /** Short blurb of the impact work done. */\n  shortDescription: string\n  /** Optional longer description of the impact work done. */\n  description?: string\n  image?:\n    | $Typed<OrgHypercertsDefs.Uri>\n    | $Typed<OrgHypercertsDefs.SmallImage>\n    | { $type: string }\n  workScope?: WorkScope\n  /** When the work began */\n  startDate: string\n  /** When the work ended */\n  endDate: string\n  /** A strong reference to the contributions done to create the impact in the hypercerts. The record referenced must conform with the lexicon org.hypercerts.claim.contribution */\n  contributions?: ComAtprotoRepoStrongRef.Main[]\n  rights?: ComAtprotoRepoStrongRef.Main\n  location?: ComAtprotoRepoStrongRef.Main\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n\n/** Logical scope of the work using label-based conditions. All labels in `allOf` must apply; at least one label in `anyOf` must apply if provided; no label in `noneOf` may apply. */\nexport interface WorkScope {\n  $type?: 'org.hypercerts.claim.activity#workScope'\n  /** Labels that MUST all hold for the scope to apply. */\n  allOf?: string[]\n  /** Labels of which AT LEAST ONE must hold (optional). If omitted or empty, imposes no additional condition. */\n  anyOf?: string[]\n  /** Labels that MUST NOT hold for the scope to apply. */\n  noneOf?: string[]\n}\n\nconst hashWorkScope = 'workScope'\n\nexport function isWorkScope<V>(v: V) {\n  return is$typed(v, id, hashWorkScope)\n}\n\nexport function validateWorkScope<V>(v: V) {\n  return validate<WorkScope & V>(v, id, hashWorkScope)\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'org.hypercerts.claim.contribution'\n\nexport interface Main {\n  $type: 'org.hypercerts.claim.contribution'\n  /** Role or title of the contributor(s). */\n  role?: string\n  /** List of the contributors (names, pseudonyms, or DIDs). If multiple contributors are stored in the same hypercertContribution, then they would have the exact same role. */\n  contributors: string[]\n  /** What the contribution concretely achieved */\n  description?: string\n  /** When this contribution started. This should be a subset of the hypercert timeframe. */\n  startDate?: string\n  /** When this contribution finished.  This should be a subset of the hypercert timeframe. */\n  endDate?: string\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","import { XRPCError } from \"@atproto/xrpc\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const xrpcErrorToTRPCError = (error: XRPCError): TRPCError => {\n  if (error.error === \"InvalidRequest\") {\n    return new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"This resource does not exist.\",\n    });\n  } else if (error.error === \"RecordNotFound\") {\n    return new TRPCError({\n      code: \"NOT_FOUND\",\n      message: \"The resource you are looking for does not exist.\",\n    });\n  } else {\n    console.error(\"xrpc error could not be classified by trpc. error:\", error);\n    return new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"An unknown error occurred.\",\n    });\n  }\n};\n","import type { ValidationResult } from \"@atproto/lexicon\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const validateRecordOrThrow = <T>(\n  record: unknown,\n  {\n    validateRecord,\n  }: { validateRecord: (record: unknown) => ValidationResult<T> }\n) => {\n  let validationResponse;\n  try {\n    validationResponse = validateRecord(record);\n  } catch (error) {\n    throw new TRPCError({\n      code: \"UNPROCESSABLE_CONTENT\",\n      message: \"Invalid record\",\n      cause: error,\n    });\n  }\n  if (!validationResponse.success) {\n    throw new TRPCError({\n      code: \"UNPROCESSABLE_CONTENT\",\n      message: validationResponse.error.message,\n      cause: validationResponse.error,\n    });\n  }\n  return validationResponse.value;\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { XRPCError } from \"@atproto/xrpc\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { AppGainforestOrganizationInfo } from \"@/../lex-api\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { xrpcErrorToTRPCError } from \"@/_internal/server/utils/classify-xrpc-error\";\nimport { TRPCError } from \"@trpc/server\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const getOrganizationInfoPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n) => {\n  const agent = getReadAgent(pdsDomain);\n  console.log(\"TEMP DEBUG LOG:\", JSON.stringify({ did, pdsDomain }));\n  const getRecordPromise = agent.com.atproto.repo.getRecord({\n    collection: \"app.gainforest.organization.info\",\n    repo: did,\n    rkey: \"self\",\n  });\n  const [response, error] = await tryCatch(getRecordPromise);\n\n  if (error) {\n    if (error instanceof XRPCError) {\n      const trpcError = xrpcErrorToTRPCError(error);\n      throw trpcError;\n    } else {\n      console.error(\"getOrganizationInfo error:\", error);\n      throw new TRPCError({\n        code: \"INTERNAL_SERVER_ERROR\",\n        message: \"An unknown error occurred.\",\n      });\n    }\n  }\n\n  if (response.success !== true) {\n    console.error(\"getOrganizationInfo error: response.success is not true\");\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to get organization info.\",\n    });\n  }\n\n  validateRecordOrThrow(response.data.value, AppGainforestOrganizationInfo);\n\n  return response.data as GetRecordResponse<AppGainforestOrganizationInfo.Record>;\n};\n\nexport const getOrganizationInfoFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(z.object({ did: z.string(), pdsDomain: allowedPDSDomainSchema }))\n    .query(async ({ input }) => {\n      return await getOrganizationInfoPure(input.did, input.pdsDomain);\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationSite } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const getSiteFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        rkey: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const response = await agent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.site\",\n        repo: input.did,\n        rkey: input.rkey,\n      });\n      if (response.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to get the site\",\n        });\n      }\n      validateRecordOrThrow(response.data.value, AppGainforestOrganizationSite);\n      return response.data as GetRecordResponse<AppGainforestOrganizationSite.Record>;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { AppGainforestOrganizationDefaultSite } from \"@/../lex-api\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\n\nexport const getDefaultProjectSiteFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const response = await agent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.defaultSite\",\n        repo: input.did,\n        rkey: \"self\",\n      });\n      if (response.success !== true) {\n        throw new Error(\"Failed to get default project site\");\n      }\n      validateRecordOrThrow(\n        response.data.value,\n        AppGainforestOrganizationDefaultSite\n      );\n      return response.data as GetRecordResponse<AppGainforestOrganizationDefaultSite.Record>;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { AppGainforestOrganizationObservationsMeasuredTreesCluster as MeasuredTreesCluster } from \"@/../lex-api\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const getMeasuredTreesFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const nsid: MeasuredTreesCluster.Record[\"$type\"] =\n        \"app.gainforest.organization.observations.measuredTreesCluster\";\n      const response = await agent.com.atproto.repo.getRecord({\n        collection: nsid,\n        repo: input.did,\n        rkey: \"self\",\n      });\n      if (response.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to get measured trees\",\n        });\n      }\n      validateRecordOrThrow(response.data.value, MeasuredTreesCluster);\n      return response.data as GetRecordResponse<MeasuredTreesCluster.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { Agent } from \"@atproto/api\";\nimport {\n  AppCertifiedLocation,\n  OrgHypercertsClaimActivity,\n  OrgHypercertsClaimContribution,\n} from \"@/../lex-api\";\nimport { toBlobRef, toBlobRefGenerator } from \"@/_internal/zod-schemas/blobref\";\nimport {\n  type FileGenerator,\n  FileGeneratorSchema,\n} from \"@/_internal/zod-schemas/file\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nconst uploadFile = async (fileGenerator: FileGenerator, agent: Agent) => {\n  const file = new File(\n    [Buffer.from(fileGenerator.dataBase64, \"base64\")],\n    fileGenerator.name,\n    { type: fileGenerator.type }\n  );\n  const response = await agent.uploadBlob(file);\n  return toBlobRefGenerator(response.data.blob);\n};\n\nexport const createClaimActivityFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        activity: z.object({\n          title: z.string(),\n          shortDescription: z.string(),\n          description: z.string().optional(),\n          workScopes: z.array(z.string()),\n          startDate: z.string(),\n          endDate: z.string(),\n        }),\n        uploads: z.object({\n          image: FileGeneratorSchema,\n          contributors: z.array(z.string()).refine((v) => v.length > 0, {\n            message: \"At least one contribution is required\",\n          }),\n          siteAtUri: z.string(),\n        }),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      const did = agent.did;\n      if (!did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authorized to perform this action.\",\n        });\n      }\n\n      // Generate record data for validation before writing to the PDS:\n      // Location record\n      const locationNSID = \"app.certified.location\";\n      const location: AppCertifiedLocation.Record = {\n        $type: locationNSID,\n        lpVersion: \"1.0.0\",\n        srs: \"https://epsg.io/3857\",\n        locationType: \"geojson\",\n        location: {\n          $type: \"org.hypercerts.defs#uri\",\n          uri: input.uploads.siteAtUri,\n        },\n        createdAt: new Date().toISOString(),\n      };\n      const validatedLocation = validateRecordOrThrow(\n        location,\n        AppCertifiedLocation\n      );\n\n      // Activity record\n      const activityNSID = \"org.hypercerts.claim.activity\";\n      const activity: OrgHypercertsClaimActivity.Record = {\n        $type: activityNSID,\n        title: input.activity.title,\n        shortDescription: input.activity.shortDescription,\n        description: input.activity.description,\n        // These will be set after the records are created:\n        image: undefined,\n        location: undefined,\n        contributions: undefined,\n        // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        workScope: {\n          $type: \"org.hypercerts.claim.activity#workScope\",\n          anyOf: input.activity.workScopes,\n        },\n        startDate: input.activity.startDate,\n        endDate: input.activity.endDate,\n        createdAt: new Date().toISOString(),\n      };\n      const validatedActivity = validateRecordOrThrow(\n        activity,\n        OrgHypercertsClaimActivity\n      );\n\n      // Contribution record\n      const contributionNSID = \"org.hypercerts.claim.contribution\";\n      const contribution: OrgHypercertsClaimContribution.Record = {\n        $type: \"org.hypercerts.claim.contribution\",\n        // Use dummy hypercert reference for now because the activity record is not yet created:\n        hypercert: {\n          $type: \"com.atproto.repo.strongRef\",\n          uri: `at://${did}/org.hypercerts.claim.activity/0`,\n          cid: \"bafkreifj2t4px2uizj25ml53axem47yfhpgsx72ekjrm2qyymcn5ifz744\",\n        },\n        // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        role: \"Contributor\",\n        contributors: input.uploads.contributors,\n        createdAt: new Date().toISOString(),\n      };\n      const validatedContribution = validateRecordOrThrow(\n        contribution,\n        OrgHypercertsClaimContribution\n      );\n\n      // Write records to the PDS\n      // 1. Write location to the PDS\n      const locationWriteResponse = await agent.com.atproto.repo.createRecord({\n        repo: did,\n        collection: locationNSID,\n        record: validatedLocation,\n      });\n      if (locationWriteResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to write location record\",\n        });\n      }\n      // 2. Upload image to the PDS\n      const imageBlobRef = await uploadFile(input.uploads.image, agent);\n      // 3. Write activity to the PDS\n      const activityResponse = await agent.com.atproto.repo.createRecord({\n        repo: did,\n        collection: activityNSID,\n        record: {\n          ...validatedActivity,\n          image: {\n            $type: \"org.hypercerts.defs#smallImage\",\n            image: toBlobRef(imageBlobRef),\n          },\n          location: {\n            $type: \"com.atproto.repo.strongRef\",\n            uri: locationWriteResponse.data.uri,\n            cid: locationWriteResponse.data.cid,\n          },\n        } satisfies OrgHypercertsClaimActivity.Record,\n      });\n      if (activityResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to write activity record\",\n        });\n      }\n      // 4. Write contribution to the PDS\n      const contributionWriteResponse =\n        await agent.com.atproto.repo.createRecord({\n          repo: did,\n          collection: contributionNSID,\n          record: {\n            ...validatedContribution,\n            hypercert: {\n              $type: \"com.atproto.repo.strongRef\",\n              uri: activityResponse.data.uri,\n              cid: activityResponse.data.cid,\n            },\n          } satisfies OrgHypercertsClaimContribution.Record,\n        });\n      if (contributionWriteResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to write contribution record\",\n        });\n      }\n\n      return activityResponse;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\nimport { AppGainforestOrganizationInfo } from \"@/../lex-api\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport { FileGeneratorSchema } from \"@/_internal/zod-schemas/file\";\nimport {\n  BlobRefGeneratorSchema,\n  toBlobRef,\n} from \"@/_internal/zod-schemas/blobref\";\nimport { uploadFileAsBlobPure } from \"../../../common/uploadFileAsBlob\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const createOrUpdateOrganizationInfoFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        info: z.object({\n          displayName: z.string(),\n          shortDescription: z.string(),\n          longDescription: z.string(),\n          website: z.string().optional(),\n          logo: BlobRefGeneratorSchema.optional(),\n          coverImage: BlobRefGeneratorSchema.optional(),\n          objectives: z.array(\n            z.enum([\n              \"Conservation\",\n              \"Research\",\n              \"Education\",\n              \"Community\",\n              \"Other\",\n            ])\n          ),\n          startDate: z.string().optional(),\n          country: z.string(),\n          visibility: z.enum([\"Public\", \"Hidden\"]),\n        }),\n        uploads: z\n          .object({\n            logo: FileGeneratorSchema.optional(),\n            coverImage: FileGeneratorSchema.optional(),\n          })\n          .optional(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      const logoBlob =\n        input.uploads?.logo ?\n          (await uploadFileAsBlobPure(input.uploads.logo, agent)).blob\n        : input.info.logo ? toBlobRef(input.info.logo)\n        : undefined;\n      const coverImageBlob =\n        input.uploads?.coverImage ?\n          (await uploadFileAsBlobPure(input.uploads.coverImage, agent)).blob\n        : input.info.coverImage ? toBlobRef(input.info.coverImage)\n        : undefined;\n\n      const info: AppGainforestOrganizationInfo.Record = {\n        $type: \"app.gainforest.organization.info\",\n        displayName: input.info.displayName,\n        shortDescription: input.info.shortDescription,\n        longDescription: input.info.longDescription,\n        website: input.info.website ? input.info.website : undefined,\n        logo:\n          logoBlob ?\n            {\n              $type: \"app.gainforest.common.defs#smallImage\",\n              image: logoBlob,\n            }\n          : undefined,\n        coverImage:\n          coverImageBlob ?\n            {\n              $type: \"app.gainforest.common.defs#smallImage\",\n              image: coverImageBlob,\n            }\n          : undefined,\n        objectives: input.info.objectives,\n        startDate: input.info.startDate ? input.info.startDate : undefined,\n        country: input.info.country,\n        visibility: input.info.visibility,\n        createdAt: new Date().toISOString(),\n      };\n\n      validateRecordOrThrow(info, AppGainforestOrganizationInfo);\n\n      const response = await agent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.info\",\n        record: info,\n        rkey: \"self\",\n      });\n\n      if (response.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to update organization info\",\n        });\n      }\n\n      return {\n        ...response.data,\n        value: info,\n      } as PutRecordResponse<AppGainforestOrganizationInfo.Record>;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport {\n  AppGainforestOrganizationDefaultSite,\n  AppGainforestOrganizationSite,\n} from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { XRPCError } from \"@atproto/xrpc\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { xrpcErrorToTRPCError } from \"@/_internal/server/utils/classify-xrpc-error\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nexport const getAllSitesFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(z.object({ did: z.string(), pdsDomain: allowedPDSDomainSchema }))\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const listSitesTryCatchPromise = tryCatch(\n        agent.com.atproto.repo.listRecords({\n          collection: \"app.gainforest.organization.site\",\n          repo: input.did,\n        })\n      );\n      const getDefaultSiteTryCatchPromise = tryCatch(\n        agent.com.atproto.repo.getRecord({\n          collection: \"app.gainforest.organization.defaultSite\",\n          repo: input.did,\n          rkey: \"self\",\n        })\n      );\n\n      const [\n        [listSitesResponse, errorListSites],\n        [getDefaultSiteResponse, errorGetDefaultSite],\n      ] = await Promise.all([\n        listSitesTryCatchPromise,\n        getDefaultSiteTryCatchPromise,\n      ]);\n\n      if (errorListSites) {\n        if (errorListSites instanceof XRPCError) {\n          const trpcError = xrpcErrorToTRPCError(errorListSites);\n          throw trpcError;\n        }\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"An unknown error occurred.\",\n        });\n      } else if (listSitesResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"An unknown error occurred.\",\n        });\n      }\n\n      const validRecords = listSitesResponse.data.records\n        .map((record) => {\n          try {\n            validateRecordOrThrow(record.value, AppGainforestOrganizationSite);\n            return record;\n          } catch {\n            return null;\n          }\n        })\n        .filter(\n          (record) => record !== null\n        ) as GetRecordResponse<AppGainforestOrganizationSite.Record>[];\n\n      let defaultSite = null;\n      if (getDefaultSiteResponse) {\n        defaultSite =\n          getDefaultSiteResponse.data as GetRecordResponse<AppGainforestOrganizationDefaultSite.Record>;\n        try {\n          validateRecordOrThrow(\n            defaultSite.value,\n            AppGainforestOrganizationDefaultSite\n          );\n        } catch {\n          defaultSite = null;\n        }\n      }\n\n      return {\n        sites: validRecords,\n        defaultSite,\n      };\n    });\n};\n","import type { GeoJsonObject } from \"geojson\";\n\n/**\n * Validates if an unknown object is a valid GeoJSON object.\n * @param value - The value to validate\n * @returns The validated GeoJSON object\n * @throws Error if the value is not a valid GeoJSON object\n */\nexport function validateGeojsonOrThrow(value: unknown): GeoJsonObject {\n  if (value === null || typeof value !== \"object\") {\n    throw new Error(\"GeoJSON must be an object\");\n  }\n\n  const obj = value as Record<string, unknown>;\n\n  if (!(\"type\" in obj) || typeof obj.type !== \"string\") {\n    throw new Error(\"GeoJSON must have a 'type' property of type string\");\n  }\n\n  const type = obj.type;\n\n  // Validate FeatureCollection\n  if (type === \"FeatureCollection\") {\n    if (!(\"features\" in obj) || !Array.isArray(obj.features)) {\n      throw new Error(\n        \"FeatureCollection must have a 'features' property of type array\"\n      );\n    }\n\n    // Validate each feature in the collection\n    for (let i = 0; i < obj.features.length; i++) {\n      try {\n        validateGeojsonOrThrow(obj.features[i]);\n      } catch (error) {\n        throw new Error(\n          `FeatureCollection.features[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n        );\n      }\n    }\n\n    return obj as unknown as GeoJsonObject;\n  }\n\n  // Validate Feature\n  if (type === \"Feature\") {\n    if (!(\"geometry\" in obj)) {\n      throw new Error(\"Feature must have a 'geometry' property\");\n    }\n\n    if (obj.geometry !== null) {\n      try {\n        validateGeometry(obj.geometry);\n      } catch (error) {\n        throw new Error(\n          `Feature.geometry is invalid: ${error instanceof Error ? error.message : String(error)}`\n        );\n      }\n    }\n\n    if (!(\"properties\" in obj)) {\n      throw new Error(\"Feature must have a 'properties' property\");\n    }\n\n    if (obj.properties !== null && typeof obj.properties !== \"object\") {\n      throw new Error(\"Feature.properties must be an object or null\");\n    }\n\n    return obj as unknown as GeoJsonObject;\n  }\n\n  // Validate Geometry types\n  try {\n    validateGeometry(obj);\n    return obj as unknown as GeoJsonObject;\n  } catch (error) {\n    throw new Error(\n      `Invalid GeoJSON type '${type}': ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n}\n\n/**\n * Validates a GeoJSON geometry object\n */\nfunction validateGeometry(value: unknown): void {\n  if (value === null || typeof value !== \"object\") {\n    throw new Error(\"Geometry must be an object\");\n  }\n\n  const geometry = value as Record<string, unknown>;\n\n  if (!(\"type\" in geometry) || typeof geometry.type !== \"string\") {\n    throw new Error(\"Geometry must have a 'type' property of type string\");\n  }\n\n  const type = geometry.type;\n\n  // Validate GeometryCollection\n  if (type === \"GeometryCollection\") {\n    if (!(\"geometries\" in geometry) || !Array.isArray(geometry.geometries)) {\n      throw new Error(\n        \"GeometryCollection must have a 'geometries' property of type array\"\n      );\n    }\n\n    for (let i = 0; i < geometry.geometries.length; i++) {\n      try {\n        validateGeometry(geometry.geometries[i]);\n      } catch (error) {\n        throw new Error(\n          `GeometryCollection.geometries[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n        );\n      }\n    }\n\n    return;\n  }\n\n  // Validate coordinates-based geometries\n  const coordinateGeometries = [\n    \"Point\",\n    \"LineString\",\n    \"Polygon\",\n    \"MultiPoint\",\n    \"MultiLineString\",\n    \"MultiPolygon\",\n  ];\n\n  if (coordinateGeometries.includes(type)) {\n    if (!(\"coordinates\" in geometry)) {\n      throw new Error(`${type} must have a 'coordinates' property`);\n    }\n\n    validateCoordinates(geometry.coordinates, type);\n    return;\n  }\n\n  throw new Error(`Unknown geometry type: ${type}`);\n}\n\n/**\n * Validates coordinates based on geometry type\n */\nfunction validateCoordinates(coordinates: unknown, type: string): void {\n  if (!Array.isArray(coordinates)) {\n    throw new Error(\"Coordinates must be an array\");\n  }\n\n  switch (type) {\n    case \"Point\":\n      validatePosition(coordinates);\n      break;\n    case \"LineString\":\n      validateLineString(coordinates);\n      break;\n    case \"Polygon\":\n      validatePolygon(coordinates);\n      break;\n    case \"MultiPoint\":\n      validateMultiPoint(coordinates);\n      break;\n    case \"MultiLineString\":\n      validateMultiLineString(coordinates);\n      break;\n    case \"MultiPolygon\":\n      validateMultiPolygon(coordinates);\n      break;\n  }\n}\n\n/**\n * Validates a Position (longitude, latitude, optional elevation)\n */\nfunction validatePosition(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"Position must be an array\");\n  }\n\n  if (value.length < 2) {\n    throw new Error(\n      \"Position must have at least 2 elements (longitude, latitude)\"\n    );\n  }\n\n  if (typeof value[0] !== \"number\" || typeof value[1] !== \"number\") {\n    throw new Error(\"Position must have numbers for longitude and latitude\");\n  }\n\n  // Validate optional elevation\n  if (value.length > 2 && typeof value[2] !== \"number\") {\n    throw new Error(\n      \"Position elevation (3rd element) must be a number if present\"\n    );\n  }\n\n  // Validate longitude range\n  if (value[0] < -180 || value[0] > 180) {\n    throw new Error(\"Longitude must be between -180 and 180\");\n  }\n\n  // Validate latitude range\n  if (value[1] < -90 || value[1] > 90) {\n    throw new Error(\"Latitude must be between -90 and 90\");\n  }\n}\n\n/**\n * Validates a LineString (array of Positions)\n */\nfunction validateLineString(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"LineString must be an array\");\n  }\n\n  if (value.length < 2) {\n    throw new Error(\"LineString must have at least 2 positions\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePosition(value[i]);\n    } catch (error) {\n      throw new Error(\n        `LineString[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a Polygon (array of LinearRings, where first is exterior and rest are holes)\n */\nfunction validatePolygon(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"Polygon must be an array\");\n  }\n\n  if (value.length === 0) {\n    throw new Error(\"Polygon must have at least one LinearRing\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validateLinearRing(value[i]);\n    } catch (error) {\n      throw new Error(\n        `Polygon[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a LinearRing (closed LineString with at least 4 positions)\n */\nfunction validateLinearRing(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"LinearRing must be an array\");\n  }\n\n  if (value.length < 4) {\n    throw new Error(\"LinearRing must have at least 4 positions\");\n  }\n\n  // Validate all positions\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePosition(value[i]);\n    } catch (error) {\n      throw new Error(\n        `LinearRing[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n\n  // Check if ring is closed (first and last positions are the same)\n  const first = value[0] as number[];\n  const last = value[value.length - 1] as number[];\n  if (\n    first[0] !== last[0] ||\n    first[1] !== last[1] ||\n    (first.length > 2 && first[2] !== last[2])\n  ) {\n    throw new Error(\n      \"LinearRing must be closed (first and last positions must be equal)\"\n    );\n  }\n}\n\n/**\n * Validates a MultiPoint (array of Positions)\n */\nfunction validateMultiPoint(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"MultiPoint must be an array\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePosition(value[i]);\n    } catch (error) {\n      throw new Error(\n        `MultiPoint[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a MultiLineString (array of LineStrings)\n */\nfunction validateMultiLineString(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"MultiLineString must be an array\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validateLineString(value[i]);\n    } catch (error) {\n      throw new Error(\n        `MultiLineString[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a MultiPolygon (array of Polygons)\n */\nfunction validateMultiPolygon(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"MultiPolygon must be an array\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePolygon(value[i]);\n    } catch (error) {\n      throw new Error(\n        `MultiPolygon[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n","import type {\n  Feature,\n  FeatureCollection,\n  GeoJsonObject,\n  Geometry,\n  GeometryCollection,\n  MultiPolygon,\n  Polygon,\n  Position,\n} from \"geojson\";\nimport {\n  area as turfArea,\n  bbox as turfBbox,\n  centerOfMass,\n  centroid as turfCentroid,\n  featureCollection,\n} from \"@turf/turf\";\n\nexport type Coordinates = {\n  lat: number;\n  lon: number;\n};\n\nexport type PolygonMetrics = {\n  areaSqMeters: number | null;\n  areaHectares: number | null;\n  centroid: Coordinates | null;\n  bbox: [number, number, number, number] | null;\n};\n\nexport const HECTARES_PER_SQUARE_METER = 0.0001;\n\nconst isFeatureCollection = (\n  value: GeoJsonObject\n): value is FeatureCollection => value.type === \"FeatureCollection\";\n\nconst isFeature = (value: GeoJsonObject): value is Feature =>\n  value.type === \"Feature\";\n\nconst isGeometryCollection = (value: Geometry): value is GeometryCollection =>\n  value.type === \"GeometryCollection\";\n\nconst isPolygon = (value: Geometry): value is Polygon =>\n  value.type === \"Polygon\";\n\nconst isMultiPolygon = (value: Geometry): value is MultiPolygon =>\n  value.type === \"MultiPolygon\";\n\nconst toFeature = (geometry: Geometry): Feature<Geometry> => ({\n  type: \"Feature\",\n  geometry,\n  properties: {},\n});\n\nconst extractPolygonFeatures = (\n  input: GeoJsonObject\n): Feature<Polygon | MultiPolygon>[] => {\n  if (isFeatureCollection(input)) {\n    return input.features.flatMap((feature) => extractPolygonFeatures(feature));\n  }\n\n  if (isFeature(input)) {\n    const geometry = input.geometry;\n    if (!geometry) return [];\n\n    if (isGeometryCollection(geometry)) {\n      return geometry.geometries.flatMap((subGeometry) =>\n        extractPolygonFeatures(toFeature(subGeometry))\n      );\n    }\n\n    if (isPolygon(geometry) || isMultiPolygon(geometry)) {\n      return [input as Feature<Polygon | MultiPolygon>];\n    }\n\n    return [];\n  }\n\n  const geometry = input as Geometry;\n\n  if (isGeometryCollection(geometry)) {\n    return geometry.geometries.flatMap((subGeometry) =>\n      extractPolygonFeatures(toFeature(subGeometry))\n    );\n  }\n\n  if (isPolygon(geometry) || isMultiPolygon(geometry)) {\n    return [toFeature(geometry) as Feature<Polygon | MultiPolygon>];\n  }\n\n  return [];\n};\n\nconst computeCentroid = (\n  features: Feature<Polygon | MultiPolygon>[]\n): Position | null => {\n  if (features.length === 0) return null;\n\n  const collection = featureCollection(features);\n\n  try {\n    const { geometry } = centerOfMass(collection);\n    return geometry.coordinates;\n  } catch {\n    try {\n      const { geometry } = turfCentroid(collection);\n      return geometry.coordinates;\n    } catch {\n      return null;\n    }\n  }\n};\n\nexport const computePolygonMetrics = (\n  geoJson: GeoJsonObject\n): PolygonMetrics => {\n  const polygonFeatures = extractPolygonFeatures(geoJson);\n\n  if (polygonFeatures.length === 0) {\n    return {\n      areaSqMeters: null,\n      areaHectares: null,\n      centroid: null,\n      bbox: null,\n    };\n  }\n\n  const areaSqMeters = polygonFeatures.reduce(\n    (acc, feature) => acc + turfArea(feature),\n    0\n  );\n\n  const centroidPosition = computeCentroid(polygonFeatures);\n  const bbox = turfBbox(featureCollection(polygonFeatures)) as [\n    number,\n    number,\n    number,\n    number,\n  ];\n\n  let centroid: Coordinates | null = null;\n\n  if (\n    centroidPosition &&\n    centroidPosition[0] !== undefined &&\n    centroidPosition[1] !== undefined\n  ) {\n    const [lon, lat] = centroidPosition;\n    centroid = { lat, lon };\n  }\n\n  return {\n    areaSqMeters,\n    areaHectares: areaSqMeters * HECTARES_PER_SQUARE_METER,\n    centroid,\n    bbox,\n  };\n};\n\nexport const toFeatureCollection = (\n  geoJson: GeoJsonObject\n): FeatureCollection => {\n  if (isFeatureCollection(geoJson)) return geoJson;\n\n  if (isFeature(geoJson)) {\n    return featureCollection([geoJson]);\n  }\n\n  return featureCollection([toFeature(geoJson as Geometry)]);\n};\n","import type { GeoJsonObject } from \"geojson\";\nimport { TRPCError } from \"@trpc/server\";\nimport { validateGeojsonOrThrow } from \"@/_internal/lib/geojson/validate\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { computePolygonMetrics } from \"@/_internal/lib/geojson/computations\";\n\nexport async function fetchGeojsonFromUrl(url: string) {\n  const response = await fetch(url);\n  if (!response.ok) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to fetch site\",\n    });\n  }\n  const blob = await response.blob();\n  if (blob.type !== \"application/geo+json\") {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Site must be a GeoJSON file\",\n    });\n  }\n  const file = new File([blob], \"site.geojson\", {\n    type: blob.type,\n  });\n  return file;\n}\n\nexport async function computeGeojsonFile(file: File) {\n  if (file.type !== \"application/geo+json\") {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Site must be a GeoJSON file\",\n    });\n  }\n\n  const geojsonText = await file.text();\n  const geojson = JSON.parse(geojsonText);\n  const [validatedGeojsonObject, geojsonValidationError] = await tryCatch(\n    new Promise<GeoJsonObject>((r) => r(validateGeojsonOrThrow(geojson)))\n  );\n\n  if (geojsonValidationError) {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Invalid GeoJSON file: \" + geojsonValidationError.message,\n    });\n  }\n\n  const polygonMetrics = computePolygonMetrics(validatedGeojsonObject);\n  const lat = polygonMetrics.centroid?.lat;\n  const lon = polygonMetrics.centroid?.lon;\n  const area = polygonMetrics.areaHectares;\n  if (!lat || !lon || !area) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to process the geojson data.\",\n    });\n  }\n\n  return {\n    lat: lat.toFixed(6),\n    lon: lon.toFixed(6),\n    area: area.toFixed(2),\n  };\n}\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationSite } from \"@/../lex-api\";\nimport { FileGeneratorSchema, toFile } from \"@/_internal/zod-schemas/file\";\nimport { TRPCError } from \"@trpc/server\";\nimport { computeGeojsonFile, fetchGeojsonFromUrl } from \"./utils\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\n\nexport const createSiteFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        rkey: z.string().optional(),\n        site: z.object({\n          name: z.string().min(1),\n        }),\n        uploads: z.object({\n          shapefile: z.union([z.url(), FileGeneratorSchema]),\n        }),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      if (!agent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // If the site is a string, it is a URI, so fetch the file from the URI\n      const file =\n        typeof input.uploads.shapefile === \"string\" ?\n          await fetchGeojsonFromUrl(input.uploads.shapefile)\n        : await toFile(input.uploads.shapefile);\n\n      const { lat, lon, area } = await computeGeojsonFile(file);\n\n      const geojsonUploadResponse = await agent.uploadBlob(file);\n      const geojsonBlobRef = geojsonUploadResponse.data.blob;\n\n      const nsid: AppGainforestOrganizationSite.Record[\"$type\"] =\n        \"app.gainforest.organization.site\";\n      const site: AppGainforestOrganizationSite.Record = {\n        $type: nsid,\n        name: input.site.name,\n        lat: lat,\n        lon: lon,\n        area: area,\n        shapefile: {\n          $type: \"app.gainforest.common.defs#smallBlob\",\n          blob: geojsonBlobRef,\n        },\n        createdAt: new Date().toISOString(),\n      };\n\n      validateRecordOrThrow(site, AppGainforestOrganizationSite);\n\n      const creationResponse = await agent.com.atproto.repo.createRecord({\n        collection: nsid,\n        repo: agent.did,\n        record: site,\n        rkey: input.rkey,\n      });\n\n      if (creationResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to add new site\",\n        });\n      }\n\n      return creationResponse.data;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationSite } from \"@/../lex-api\";\nimport {\n  BlobRefGeneratorSchema,\n  toBlobRef,\n} from \"@/_internal/zod-schemas/blobref\";\nimport { FileGeneratorSchema, toFile } from \"@/_internal/zod-schemas/file\";\nimport { TRPCError } from \"@trpc/server\";\nimport { computeGeojsonFile, fetchGeojsonFromUrl } from \"./utils\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport {\n  type SmallBlob,\n  type Uri,\n} from \"@/../lex-api/types/app/gainforest/common/defs\";\nimport type { $Typed } from \"@/../lex-api/util\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\n\nexport const updateSiteFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        rkey: z.string(),\n        site: z.object({\n          name: z.string().min(1),\n          shapefile: z\n            .object({\n              $type: z.literal(\"app.gainforest.common.defs#smallBlob\"),\n              blob: BlobRefGeneratorSchema,\n            })\n            .optional(),\n          lat: z.string(),\n          lon: z.string(),\n          area: z.string(),\n        }),\n        uploads: z\n          .object({\n            shapefile: FileGeneratorSchema.optional(),\n          })\n          .optional(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      if (!agent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      let file: File | null = null;\n      // Upload the shapefile if provided\n      if (input.uploads) {\n        if (input.uploads.shapefile === undefined) {\n          file = null;\n        } else {\n          file = await toFile(input.uploads.shapefile);\n        }\n      }\n\n      // Compute the lat, lon, and area from the shapefile\n      let lat: string;\n      let lon: string;\n      let area: string;\n      let shapefile: SmallBlob;\n      if (file !== null) {\n        const computed = await computeGeojsonFile(file);\n        const geojsonUploadResponse = await agent.uploadBlob(file);\n        shapefile = {\n          $type: \"app.gainforest.common.defs#smallBlob\",\n          blob: geojsonUploadResponse.data.blob,\n        };\n        lat = computed.lat;\n        lon = computed.lon;\n        area = computed.area;\n      } else if (input.site.shapefile) {\n        shapefile = {\n          $type: \"app.gainforest.common.defs#smallBlob\",\n          blob: toBlobRef(input.site.shapefile.blob),\n        };\n        lat = input.site.lat;\n        lon = input.site.lon;\n        area = input.site.area;\n      } else {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message: \"No shapefile provided\",\n        });\n      }\n\n      const nsid: AppGainforestOrganizationSite.Record[\"$type\"] =\n        \"app.gainforest.organization.site\";\n      const site: AppGainforestOrganizationSite.Record = {\n        $type: nsid,\n        name: input.site.name,\n        lat: lat,\n        lon: lon,\n        area: area,\n        shapefile,\n        createdAt: new Date().toISOString(),\n      };\n\n      validateRecordOrThrow(site, AppGainforestOrganizationSite);\n\n      const updateResponse = await agent.com.atproto.repo.putRecord({\n        collection: nsid,\n        repo: agent.did,\n        record: site,\n        rkey: input.rkey,\n      });\n\n      if (updateResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to update site\",\n        });\n      }\n\n      return updateResponse.data;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\nimport {\n  AppGainforestOrganizationDefaultSite,\n  AppGainforestOrganizationSite,\n} from \"@/../lex-api\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport { TRPCError } from \"@trpc/server\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const setDefaultSiteFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        siteAtUri: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      if (!agent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      const siteUri = input.siteAtUri;\n      const siteNSID: AppGainforestOrganizationSite.Record[\"$type\"] =\n        \"app.gainforest.organization.site\";\n      if (!(siteUri.startsWith(`at://`) && siteUri.includes(siteNSID))) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message: \"Invalid site URI\",\n        });\n      }\n\n      const site = await agent.com.atproto.repo.getRecord({\n        collection: siteNSID,\n        repo: agent.did,\n        rkey: parseAtUri(siteUri).rkey,\n      });\n      if (site.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to get site\",\n        });\n      }\n\n      const defaultSiteNSID: AppGainforestOrganizationDefaultSite.Record[\"$type\"] =\n        \"app.gainforest.organization.defaultSite\";\n      const defaultSite: AppGainforestOrganizationDefaultSite.Record = {\n        $type: defaultSiteNSID,\n        site: siteUri,\n        createdAt: new Date().toISOString(),\n      };\n      validateRecordOrThrow(defaultSite, AppGainforestOrganizationDefaultSite);\n      const updateDefaultSiteResponse = await agent.com.atproto.repo.putRecord({\n        collection: defaultSiteNSID,\n        repo: agent.did,\n        rkey: \"self\",\n        record: defaultSite,\n      });\n\n      if (updateDefaultSiteResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to update default site\",\n        });\n      }\n\n      return updateDefaultSiteResponse.data;\n    });\n};\n","import { AppGainforestOrganizationDefaultSite } from \"@/../lex-api\";\nimport { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { getWriteAgent } from \"@/_internal/server/utils/agent\";\nimport { TRPCError } from \"@trpc/server\";\nimport z from \"zod\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\n\nexport const deleteSiteFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({ siteAtUri: z.string(), pdsDomain: allowedPDSDomainSchema })\n    )\n    .mutation(async ({ input }) => {\n      const agent = await getWriteAgent(input.pdsDomain);\n      if (!agent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      try {\n        // Check if the site is the default site\n        const defaultSiteNSID: AppGainforestOrganizationDefaultSite.Record[\"$type\"] =\n          \"app.gainforest.organization.defaultSite\";\n        const defaultSiteResponse = await agent.com.atproto.repo.getRecord({\n          collection: defaultSiteNSID,\n          repo: agent.did,\n          rkey: \"self\",\n        });\n        if (defaultSiteResponse.success !== true)\n          throw Error(\"Failed to get default site\");\n        validateRecordOrThrow(\n          defaultSiteResponse.data.value,\n          AppGainforestOrganizationDefaultSite\n        );\n        const defaultSite = defaultSiteResponse.data\n          .value as AppGainforestOrganizationDefaultSite.Record;\n        if (defaultSite.site === input.siteAtUri) throw new Error(\"Equal\");\n      } catch (error) {\n        // Only take action if the default site is determined and equals the site to be deleted\n        if (error instanceof Error && error.message === \"Equal\") {\n          throw new TRPCError({\n            code: \"BAD_REQUEST\",\n            message: \"Cannot delete default site\",\n          });\n        }\n      }\n\n      const deletionResponse = await agent.com.atproto.repo.deleteRecord({\n        collection: \"app.gainforest.organization.site\",\n        repo: agent.did,\n        rkey: parseAtUri(input.siteAtUri).rkey,\n      });\n      if (deletionResponse.success !== true)\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to delete site\",\n        });\n\n      return deletionResponse.data;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { OrgHypercertsClaimActivity } from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { XRPCError } from \"@atproto/xrpc\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { xrpcErrorToTRPCError } from \"@/_internal/server/utils/classify-xrpc-error\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const getAllClaimActivitiesPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n) => {\n  const activityNSID: OrgHypercertsClaimActivity.Record[\"$type\"] =\n    \"org.hypercerts.claim.activity\";\n  const agent = getReadAgent(pdsDomain);\n  const [listClaimActivitiesResponse, errorListClaimActivities] =\n    await tryCatch(\n      agent.com.atproto.repo.listRecords({\n        collection: activityNSID,\n        repo: did,\n      })\n    );\n\n  if (errorListClaimActivities) {\n    if (errorListClaimActivities instanceof XRPCError) {\n      const trpcError = xrpcErrorToTRPCError(errorListClaimActivities);\n      throw trpcError;\n    }\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"An unknown error occurred.\",\n    });\n  } else if (listClaimActivitiesResponse.success !== true) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"An unknown error occurred.\",\n    });\n  }\n\n  const validRecords = listClaimActivitiesResponse.data.records\n    .map((record) => {\n      try {\n        validateRecordOrThrow(record.value, OrgHypercertsClaimActivity);\n        return record;\n      } catch {\n        return null;\n      }\n    })\n    .filter(\n      (record) => record !== null\n    ) as GetRecordResponse<OrgHypercertsClaimActivity.Record>[];\n\n  return {\n    activities: validRecords,\n  };\n};\n\nexport const getAllClaimActivitiesFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      return await getAllClaimActivitiesPure(input.did, input.pdsDomain);\n    });\n};\n","import { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { z } from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { getOrganizationInfoPure } from \"../../../gainforest/organization/info/get\";\nimport { getAllClaimActivitiesPure } from \"./getAll\";\nimport { type Repo } from \"@atproto/api/dist/client/types/com/atproto/sync/listRepos\";\nimport {\n  AppGainforestOrganizationInfo,\n  OrgHypercertsClaimActivity,\n} from \"@/../lex-api\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport type OrganizationWithActivities = {\n  repo: Repo;\n  organizationInfo: AppGainforestOrganizationInfo.Record;\n  activities: GetRecordResponse<OrgHypercertsClaimActivity.Record>[];\n};\n\nexport const getAllClaimActivitiesAcrossOrganizationsFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(z.object({ pdsDomain: allowedPDSDomainSchema }))\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n\n      // Get all the repositories\n      const [repositoriesListResponse, repositoriesListFetchError] =\n        await tryCatch(\n          agent.com.atproto.sync.listRepos({\n            limit: 100,\n          })\n        );\n      if (\n        repositoriesListFetchError ||\n        repositoriesListResponse.success !== true\n      ) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to fetch repositories list\",\n        });\n      }\n      const repositoriesList = repositoriesListResponse.data.repos;\n\n      // Filter the repositories that are organizations\n      const [organizationRepositories, organizationsFetchError] =\n        await tryCatch(\n          Promise.all(\n            repositoriesList.map(async (repo) => {\n              const [organizationInfoResponse, organizationInfoFetchError] =\n                await tryCatch(\n                  getOrganizationInfoPure(repo.did, input.pdsDomain)\n                );\n              if (organizationInfoFetchError) {\n                return null;\n              }\n              return {\n                repo: repo,\n                organizationInfo: organizationInfoResponse.value,\n              };\n            })\n          )\n        );\n      if (organizationsFetchError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to fetch organizations list\",\n        });\n      }\n      const validOrganizationRepositories = organizationRepositories.filter(\n        (org): org is NonNullable<typeof org> => org !== null\n      );\n\n      // Get all the claim activities for the organizations\n      const [activities, activitiesFetchError] = await tryCatch(\n        Promise.all(\n          validOrganizationRepositories.map(async (organization) => {\n            const [activitiesResponse, activitiesFetchError] = await tryCatch(\n              getAllClaimActivitiesPure(organization.repo.did, input.pdsDomain)\n            );\n            if (activitiesFetchError) {\n              return null;\n            }\n            return {\n              repo: organization.repo,\n              activities: activitiesResponse.activities,\n              organizationInfo: organization.organizationInfo,\n            };\n          })\n        )\n      );\n      if (activitiesFetchError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to fetch activities list\",\n        });\n      }\n\n      const validActivities = activities.filter(\n        (activity): activity is NonNullable<typeof activity> =>\n          activity !== null\n      );\n      return validActivities satisfies OrganizationWithActivities[];\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { XRPCError } from \"@atproto/xrpc\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { OrgHypercertsClaimActivity } from \"@/../lex-api\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { xrpcErrorToTRPCError } from \"@/_internal/server/utils/classify-xrpc-error\";\nimport { TRPCError } from \"@trpc/server\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const getClaimActivityPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  rkey: string,\n  pdsDomain: T\n) => {\n  const agent = getReadAgent(pdsDomain);\n  const nsid: OrgHypercertsClaimActivity.Record[\"$type\"] =\n    \"org.hypercerts.claim.activity\";\n  const getRecordPromise = agent.com.atproto.repo.getRecord({\n    collection: nsid,\n    repo: did,\n    rkey: rkey,\n  });\n  const [response, error] = await tryCatch(getRecordPromise);\n\n  if (error) {\n    if (error instanceof XRPCError) {\n      const trpcError = xrpcErrorToTRPCError(error);\n      throw trpcError;\n    } else {\n      throw new TRPCError({\n        code: \"INTERNAL_SERVER_ERROR\",\n        message: \"An unknown error occurred.\",\n      });\n    }\n  }\n\n  if (response.success !== true) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to get organization info.\",\n    });\n  }\n\n  validateRecordOrThrow(response.data.value, OrgHypercertsClaimActivity);\n\n  return response.data as GetRecordResponse<OrgHypercertsClaimActivity.Record>;\n};\n\nexport const getCliamActivityFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        rkey: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      return await getClaimActivityPure(input.did, input.rkey, input.pdsDomain);\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { XRPCError } from \"@atproto/xrpc\";\nimport { type GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { AppCertifiedLocation } from \"@/../lex-api\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { xrpcErrorToTRPCError } from \"@/_internal/server/utils/classify-xrpc-error\";\nimport { TRPCError } from \"@trpc/server\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const getCertifiedLocationPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  rkey: string,\n  pdsDomain: T\n) => {\n  const agent = getReadAgent(pdsDomain);\n  const getRecordPromise = agent.com.atproto.repo.getRecord({\n    collection: \"app.certified.location\",\n    repo: did,\n    rkey: rkey,\n  });\n  const [response, error] = await tryCatch(getRecordPromise);\n\n  if (error) {\n    if (error instanceof XRPCError) {\n      const trpcError = xrpcErrorToTRPCError(error);\n      throw trpcError;\n    } else {\n      throw new TRPCError({\n        code: \"INTERNAL_SERVER_ERROR\",\n        message: \"An unknown error occurred.\",\n      });\n    }\n  }\n\n  if (response.success !== true) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to get organization info.\",\n    });\n  }\n\n  validateRecordOrThrow(response.data.value, AppCertifiedLocation);\n\n  return response.data as GetRecordResponse<AppCertifiedLocation.Record>;\n};\n\nexport const getCertifiedLocationFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        rkey: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      return await getCertifiedLocationPure(\n        input.did,\n        input.rkey,\n        input.pdsDomain\n      );\n    });\n};\n","import { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const checkOwnershipByAtUri = (atUri: string, userDid: string) => {\n  const { did } = parseAtUri(atUri);\n  if (did !== userDid) {\n    return false;\n  }\n  return true;\n};\n","import { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { AppGainforestOrganizationProject } from \"lex-api\";\n\nexport const filterProjectByOwnership = (\n  project: AppGainforestOrganizationProject.Record,\n  userDid: string\n): AppGainforestOrganizationProject.Record => {\n  return {\n    ...project,\n    sites: project.sites.filter((site) => checkOwnershipByAtUri(site, userDid)),\n    measuredTreesClusters: project.measuredTreesClusters.filter(\n      (measuredTreesCluster) =>\n        checkOwnershipByAtUri(measuredTreesCluster, userDid)\n    ),\n    layers: project.layers.filter((layer) =>\n      checkOwnershipByAtUri(layer, userDid)\n    ),\n    ecocerts: project.ecocerts.filter((ecocert) =>\n      checkOwnershipByAtUri(ecocert, userDid)\n    ),\n  };\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"../project/utils\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\n\nexport const addSitesToProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        siteUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Check if the sites are owned by the user\n      const ownedSiteUris = input.siteUris.filter((uri) =>\n        checkOwnershipByAtUri(uri, input.did)\n      );\n      if (ownedSiteUris.length !== input.siteUris.length) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            ownedSiteUris.length === 1 ?\n              \"The site you are trying to add is not owned by you\"\n            : \"The sites you are trying to add are not owned by you\",\n        });\n      }\n\n      // Check if the sites exist\n      const siteExistencePromise = Promise.all(\n        input.siteUris.map(async (uri) => {\n          const { did, collection, rkey } = parseAtUri(uri);\n          const response = await readAgent.com.atproto.repo.getRecord({\n            collection: collection,\n            repo: did,\n            rkey: rkey,\n          });\n          return response.success === true;\n        })\n      );\n      const [siteExistence, siteExistenceCheckError] =\n        await tryCatch(siteExistencePromise);\n      if (siteExistenceCheckError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to check the existence of the sites\",\n        });\n      }\n\n      if (!siteExistence.every(Boolean)) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            siteExistence.length === 1 ?\n              \"The site you are trying to add does not exist\"\n            : \"The sites you are trying to add do not exist\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          getResponse.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      // Add new site URIs, avoiding duplicates\n      const existingSites = new Set(validatedProject.sites);\n      const newSites = input.siteUris.filter((uri) => !existingSites.has(uri));\n      const updatedSites = [...validatedProject.sites, ...newSites];\n\n      // Create updated project record\n      const updatedProject: AppGainforestOrganizationProject.Record = {\n        ...validatedProject,\n        sites: updatedSites,\n      };\n\n      const ownershipCheckedProject = filterProjectByOwnership(\n        updatedProject,\n        input.did\n      );\n\n      validateRecordOrThrow(\n        ownershipCheckedProject,\n        AppGainforestOrganizationProject\n      );\n\n      // Update the project\n      const putResponse = await writeAgent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.project\",\n        record: ownershipCheckedProject,\n        rkey: input.projectRkey,\n      });\n\n      if (putResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to add sites to project\",\n        });\n      }\n\n      return {\n        uri: putResponse.data.uri,\n        cid: putResponse.data.cid,\n        validationStatus: putResponse.data.validationStatus,\n        value: ownershipCheckedProject,\n      } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"../project/utils\";\n\nexport const removeSitesFromProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        siteUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          getResponse.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      // Remove site URIs\n      const sitesToRemove = new Set(input.siteUris);\n      const updatedSites = validatedProject.sites.filter(\n        (uri) => !sitesToRemove.has(uri)\n      );\n\n      // Create updated project record\n      const updatedProject: AppGainforestOrganizationProject.Record = {\n        ...validatedProject,\n        sites: updatedSites,\n      };\n\n      const ownershipCheckedProject = filterProjectByOwnership(\n        updatedProject,\n        input.did\n      );\n\n      validateRecordOrThrow(\n        ownershipCheckedProject,\n        AppGainforestOrganizationProject\n      );\n\n      // Update the project\n      const putResponse = await writeAgent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.project\",\n        record: ownershipCheckedProject,\n        rkey: input.projectRkey,\n      });\n\n      if (putResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to remove sites from project\",\n        });\n      }\n\n      return {\n        uri: putResponse.data.uri,\n        cid: putResponse.data.cid,\n        validationStatus: putResponse.data.validationStatus,\n        value: ownershipCheckedProject,\n      } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"../../project/utils\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\n\nexport const addMeasuredTreesClusterToProjectFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        measuredTreesClusterUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Check if the measured trees clusters are owned by the user\n      const ownedClusterUris = input.measuredTreesClusterUris.filter((uri) =>\n        checkOwnershipByAtUri(uri, input.did)\n      );\n      if (ownedClusterUris.length !== input.measuredTreesClusterUris.length) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            ownedClusterUris.length === 1 ?\n              \"The measured trees cluster you are trying to add is not owned by you\"\n            : \"The measured trees clusters you are trying to add are not owned by you\",\n        });\n      }\n\n      // Check if the measured trees clusters exist\n      const clusterExistencePromise = Promise.all(\n        input.measuredTreesClusterUris.map(async (uri) => {\n          const { did, collection, rkey } = parseAtUri(uri);\n          const response = await readAgent.com.atproto.repo.getRecord({\n            collection: collection,\n            repo: did,\n            rkey: rkey,\n          });\n          return response.success === true;\n        })\n      );\n      const [clusterExistence, clusterExistenceCheckError] = await tryCatch(\n        clusterExistencePromise\n      );\n      if (clusterExistenceCheckError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message:\n            \"Failed to check the existence of the measured trees clusters\",\n        });\n      }\n\n      if (!clusterExistence.every(Boolean)) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            clusterExistence.length === 1 ?\n              \"The measured trees cluster you are trying to add does not exist\"\n            : \"The measured trees clusters you are trying to add do not exist\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          getResponse.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      // Add new measuredTreesCluster URIs, avoiding duplicates\n      const existingClusters = new Set(validatedProject.measuredTreesClusters);\n      const newClusters = input.measuredTreesClusterUris.filter(\n        (uri) => !existingClusters.has(uri)\n      );\n      const updatedClusters = [\n        ...validatedProject.measuredTreesClusters,\n        ...newClusters,\n      ];\n\n      // Create updated project record\n      const updatedProject: AppGainforestOrganizationProject.Record = {\n        ...validatedProject,\n        measuredTreesClusters: updatedClusters,\n      };\n\n      const ownershipCheckedProject = filterProjectByOwnership(\n        updatedProject,\n        input.did\n      );\n\n      validateRecordOrThrow(\n        ownershipCheckedProject,\n        AppGainforestOrganizationProject\n      );\n\n      // Update the project\n      const putResponse = await writeAgent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.project\",\n        record: ownershipCheckedProject,\n        rkey: input.projectRkey,\n      });\n\n      if (putResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to add measured trees clusters to project\",\n        });\n      }\n\n      return {\n        uri: putResponse.data.uri,\n        cid: putResponse.data.cid,\n        validationStatus: putResponse.data.validationStatus,\n        value: ownershipCheckedProject,\n      } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"../../project/utils\";\n\nexport const removeMeasuredTreesClusterFromProjectFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        measuredTreesClusterUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          getResponse.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      // Remove measuredTreesCluster URIs\n      const clustersToRemove = new Set(input.measuredTreesClusterUris);\n      const updatedClusters = validatedProject.measuredTreesClusters.filter(\n        (uri) => !clustersToRemove.has(uri)\n      );\n\n      // Create updated project record\n      const updatedProject: AppGainforestOrganizationProject.Record = {\n        ...validatedProject,\n        measuredTreesClusters: updatedClusters,\n      };\n\n      const ownershipCheckedProject = filterProjectByOwnership(\n        updatedProject,\n        input.did\n      );\n\n      validateRecordOrThrow(\n        ownershipCheckedProject,\n        AppGainforestOrganizationProject\n      );\n\n      // Update the project\n      const putResponse = await writeAgent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.project\",\n        record: ownershipCheckedProject,\n        rkey: input.projectRkey,\n      });\n\n      if (putResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to remove measured trees clusters from project\",\n        });\n      }\n\n      return {\n        uri: putResponse.data.uri,\n        cid: putResponse.data.cid,\n        validationStatus: putResponse.data.validationStatus,\n        value: ownershipCheckedProject,\n      } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"../project/utils\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\n\nexport const addLayersToProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        layerUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Check if the layers are owned by the user\n      const ownedLayerUris = input.layerUris.filter((uri) =>\n        checkOwnershipByAtUri(uri, input.did)\n      );\n      if (ownedLayerUris.length !== input.layerUris.length) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            ownedLayerUris.length === 1 ?\n              \"The layer you are trying to add is not owned by you\"\n            : \"The layers you are trying to add are not owned by you\",\n        });\n      }\n\n      // Check if the layers exist\n      const layerExistencePromise = Promise.all(\n        input.layerUris.map(async (uri) => {\n          const { did, collection, rkey } = parseAtUri(uri);\n          const response = await readAgent.com.atproto.repo.getRecord({\n            collection: collection,\n            repo: did,\n            rkey: rkey,\n          });\n          return response.success === true;\n        })\n      );\n      const [layerExistence, layerExistenceCheckError] = await tryCatch(\n        layerExistencePromise\n      );\n      if (layerExistenceCheckError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to check the existence of the layers\",\n        });\n      }\n\n      if (!layerExistence.every(Boolean)) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            layerExistence.length === 1 ?\n              \"The layer you are trying to add does not exist\"\n            : \"The layers you are trying to add do not exist\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          getResponse.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      // Add new layer URIs, avoiding duplicates\n      const existingLayers = new Set(validatedProject.layers);\n      const newLayers = input.layerUris.filter(\n        (uri) => !existingLayers.has(uri)\n      );\n      const updatedLayers = [...validatedProject.layers, ...newLayers];\n\n      // Create updated project record\n      const updatedProject: AppGainforestOrganizationProject.Record = {\n        ...validatedProject,\n        layers: updatedLayers,\n      };\n\n      const ownershipCheckedProject = filterProjectByOwnership(\n        updatedProject,\n        input.did\n      );\n\n      validateRecordOrThrow(\n        ownershipCheckedProject,\n        AppGainforestOrganizationProject\n      );\n\n      // Update the project\n      const putResponse = await writeAgent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.project\",\n        record: ownershipCheckedProject,\n        rkey: input.projectRkey,\n      });\n\n      if (putResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to add layers to project\",\n        });\n      }\n\n      return {\n        uri: putResponse.data.uri,\n        cid: putResponse.data.cid,\n        validationStatus: putResponse.data.validationStatus,\n        value: ownershipCheckedProject,\n      } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"../project/utils\";\n\nexport const removeLayersFromProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        layerUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          getResponse.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      // Remove layer URIs\n      const layersToRemove = new Set(input.layerUris);\n      const updatedLayers = validatedProject.layers.filter(\n        (uri) => !layersToRemove.has(uri)\n      );\n\n      // Create updated project record\n      const updatedProject: AppGainforestOrganizationProject.Record = {\n        ...validatedProject,\n        layers: updatedLayers,\n      };\n\n      const ownershipCheckedProject = filterProjectByOwnership(\n        updatedProject,\n        input.did\n      );\n\n      validateRecordOrThrow(\n        ownershipCheckedProject,\n        AppGainforestOrganizationProject\n      );\n\n      // Update the project\n      const putResponse = await writeAgent.com.atproto.repo.putRecord({\n        repo: input.did,\n        collection: \"app.gainforest.organization.project\",\n        record: ownershipCheckedProject,\n        rkey: input.projectRkey,\n      });\n\n      if (putResponse.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to remove layers from project\",\n        });\n      }\n\n      return {\n        uri: putResponse.data.uri,\n        cid: putResponse.data.cid,\n        validationStatus: putResponse.data.validationStatus,\n        value: ownershipCheckedProject,\n      } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationLayer } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const getLayerFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        rkey: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const nsid: AppGainforestOrganizationLayer.Record[\"$type\"] =\n        \"app.gainforest.organization.layer\";\n      const response = await agent.com.atproto.repo.getRecord({\n        collection: nsid,\n        repo: input.did,\n        rkey: input.rkey,\n      });\n      if (response.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to get the layer\",\n        });\n      }\n      const validatedRecord =\n        validateRecordOrThrow<AppGainforestOrganizationLayer.Record>(\n          response.data.value,\n          AppGainforestOrganizationLayer\n        );\n\n      return {\n        uri: response.data.uri,\n        cid: response.data.cid,\n        value: validatedRecord,\n      } satisfies GetRecordResponse<AppGainforestOrganizationLayer.Record>;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"./utils\";\n\nexport const getProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        rkey: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const nsid: AppGainforestOrganizationProject.Record[\"$type\"] =\n        \"app.gainforest.organization.project\";\n      const response = await agent.com.atproto.repo.getRecord({\n        collection: nsid,\n        repo: input.did,\n        rkey: input.rkey,\n      });\n      if (response.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to get the project\",\n        });\n      }\n      const validatedRecord =\n        validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n          response.data.value,\n          AppGainforestOrganizationProject\n        );\n\n      const ownershipCheckedRecord = filterProjectByOwnership(\n        validatedRecord,\n        input.did\n      );\n\n      response.data = {\n        ...response.data,\n        value: ownershipCheckedRecord,\n      };\n\n      return response.data as GetRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import { publicProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { TRPCError } from \"@trpc/server\";\nimport { filterProjectByOwnership } from \"./utils\";\n\nexport const getAllProjectsFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      const agent = getReadAgent(input.pdsDomain);\n      const nsid: AppGainforestOrganizationProject.Record[\"$type\"] =\n        \"app.gainforest.organization.project\";\n      const response = await agent.com.atproto.repo.listRecords({\n        collection: nsid,\n        repo: input.did,\n      });\n      if (response.success !== true) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to get the projects\",\n        });\n      }\n\n      const ownershipCheckedRecords = response.data.records\n        .map((record) => {\n          let validatedRecord;\n          try {\n            validatedRecord =\n              validateRecordOrThrow<AppGainforestOrganizationProject.Record>(\n                record.value,\n                AppGainforestOrganizationProject\n              );\n          } catch (error) {\n            return null;\n          }\n          return {\n            uri: record.uri,\n            cid: record.cid,\n            value: filterProjectByOwnership(validatedRecord, input.did),\n          };\n        })\n        .filter((record) => record !== null);\n\n      return ownershipCheckedRecords satisfies GetRecordResponse<AppGainforestOrganizationProject.Record>[];\n    });\n};\n","import { createContext, createTRPCRouter, publicProcedure } from \"../trpc\";\nimport { uploadFileAsBlobFactory } from \"./atproto/common/uploadFileAsBlob\";\nimport { loginFactory } from \"./atproto/auth/login\";\nimport { resumeFactory } from \"./atproto/auth/resume\";\nimport { logoutFactory } from \"./atproto/auth/logout\";\nimport { getOrganizationInfoFactory } from \"./atproto/gainforest/organization/info/get\";\nimport { getSiteFactory } from \"./atproto/gainforest/organization/site/get\";\nimport { getDefaultProjectSiteFactory } from \"./atproto/gainforest/organization/site/getDefault\";\nimport { getMeasuredTreesFactory } from \"./atproto/gainforest/organization/observations/measuredTreesCluster/get\";\nimport { createClaimActivityFactory } from \"./atproto/hypercerts/claim/activity/create\";\nimport { createOrUpdateOrganizationInfoFactory } from \"./atproto/gainforest/organization/info/createOrUpdate\";\nimport { getAllSitesFactory } from \"./atproto/gainforest/organization/site/getAll\";\nimport { createSiteFactory } from \"./atproto/gainforest/organization/site/create\";\nimport { updateSiteFactory } from \"./atproto/gainforest/organization/site/update\";\nimport { setDefaultSiteFactory } from \"./atproto/gainforest/organization/site/setDefault\";\nimport { deleteSiteFactory } from \"./atproto/gainforest/organization/site/delete\";\nimport { getAllClaimActivitiesAcrossOrganizationsFactory } from \"./atproto/hypercerts/claim/activity/getAllAcrossOrgs\";\nimport { getCliamActivityFactory } from \"./atproto/hypercerts/claim/activity/get\";\nimport { getCertifiedLocationFactory } from \"./atproto/hypercerts/location/get\";\nimport { addSitesToProjectFactory } from \"./atproto/gainforest/organization/site/addToProject\";\nimport { removeSitesFromProjectFactory } from \"./atproto/gainforest/organization/site/removeFromProject\";\nimport { addMeasuredTreesClusterToProjectFactory } from \"./atproto/gainforest/organization/observations/measuredTreesCluster/addToProject\";\nimport { removeMeasuredTreesClusterFromProjectFactory } from \"./atproto/gainforest/organization/observations/measuredTreesCluster/removeFromProject\";\nimport { addLayersToProjectFactory } from \"./atproto/gainforest/organization/layer/addToProject\";\nimport { removeLayersFromProjectFactory } from \"./atproto/gainforest/organization/layer/removeFromProject\";\nimport { getLayerFactory } from \"./atproto/gainforest/organization/layer/get\";\nimport { getProjectFactory } from \"./atproto/gainforest/organization/project/get\";\nimport { getAllProjectsFactory } from \"./atproto/gainforest/organization/project/getAll\";\n\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport z from \"zod\";\nexport class AppRouterFactory<T extends SupportedPDSDomain> {\n  public allowedPDSDomains;\n  public allowedPDSDomainSchema;\n  public appRouter;\n\n  constructor(_allowedPDSDomains: T[]) {\n    this.allowedPDSDomains = _allowedPDSDomains;\n    this.allowedPDSDomainSchema = z.enum(this.allowedPDSDomains);\n\n    this.appRouter = createTRPCRouter({\n      health: publicProcedure.query(() => ({ status: \"ok\" })),\n      common: {\n        uploadFileAsBlob: uploadFileAsBlobFactory(this.allowedPDSDomainSchema),\n      },\n      auth: {\n        login: loginFactory(this.allowedPDSDomainSchema),\n        resume: resumeFactory(this.allowedPDSDomainSchema),\n        logout: logoutFactory(this.allowedPDSDomainSchema),\n      },\n      gainforest: {\n        organization: {\n          info: {\n            get: getOrganizationInfoFactory(this.allowedPDSDomainSchema),\n            createOrUpdate: createOrUpdateOrganizationInfoFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n          project: {\n            get: getProjectFactory(this.allowedPDSDomainSchema),\n            getAll: getAllProjectsFactory(this.allowedPDSDomainSchema),\n            createOrUpdate: createOrUpdateOrganizationInfoFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n          site: {\n            get: getSiteFactory(this.allowedPDSDomainSchema),\n            getAll: getAllSitesFactory(this.allowedPDSDomainSchema),\n            create: createSiteFactory(this.allowedPDSDomainSchema),\n            update: updateSiteFactory(this.allowedPDSDomainSchema),\n            delete: deleteSiteFactory(this.allowedPDSDomainSchema),\n            getDefault: getDefaultProjectSiteFactory(\n              this.allowedPDSDomainSchema\n            ),\n            setDefault: setDefaultSiteFactory(this.allowedPDSDomainSchema),\n            addToProject: addSitesToProjectFactory(this.allowedPDSDomainSchema),\n            removeFromProject: removeSitesFromProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n          measuredTreesCluster: {\n            get: getMeasuredTreesFactory(this.allowedPDSDomainSchema),\n            addToProject: addMeasuredTreesClusterToProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n            removeFromProject: removeMeasuredTreesClusterFromProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n          layers: {\n            get: getLayerFactory(this.allowedPDSDomainSchema),\n            addToProject: addLayersToProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n            removeFromProject: removeLayersFromProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n        },\n      },\n      hypercerts: {\n        claim: {\n          activity: {\n            create: createClaimActivityFactory(this.allowedPDSDomainSchema),\n            getAllAcrossOrgs: getAllClaimActivitiesAcrossOrganizationsFactory(\n              this.allowedPDSDomainSchema\n            ),\n            get: getCliamActivityFactory(this.allowedPDSDomainSchema),\n          },\n        },\n        location: {\n          get: getCertifiedLocationFactory(this.allowedPDSDomainSchema),\n        },\n      },\n    });\n  }\n\n  getServerCaller = () => {\n    return this.appRouter.createCaller(\n      async () =>\n        await createContext({ allowedPDSDomains: this.allowedPDSDomains })\n    );\n  };\n}\n\nexport type AppRouter<T extends SupportedPDSDomain> =\n  AppRouterFactory<T>[\"appRouter\"];\n","import { z } from \"zod\";\nimport { getBlobUrl, parseAtUri } from \"./utilities/atproto\";\nimport { AppRouterFactory, type AppRouter } from \"./server/routers/_app\";\n\nconst supportedDomains = [\"climateai.org\", \"hypercerts.org\"] as const;\nexport const supportedPDSDomainSchema = z.enum(supportedDomains);\nconst supportedPDSDomainsSchema = z.array(supportedPDSDomainSchema);\nexport type SupportedPDSDomain = (typeof supportedDomains)[number];\n\nexport class ClimateAiSDK<T extends SupportedPDSDomain> {\n  public allowedPDSDomains;\n  public appRouter;\n  public getServerCaller;\n  public utilities;\n\n  constructor(_allowedPDSDomains: T[]) {\n    if (!Array.isArray(_allowedPDSDomains)) {\n      throw new Error(\"Allowed domains must be an array\");\n    } else if (_allowedPDSDomains.length === 0) {\n      throw new Error(\"There should be at least one allowed domain\");\n    }\n    if (!supportedPDSDomainsSchema.safeParse(_allowedPDSDomains).success) {\n      throw new Error(\n        \"One of the domains is not supported. Supported domains are: \" +\n          supportedDomains.join(\", \") +\n          \". Received domains: \" +\n          JSON.stringify(_allowedPDSDomains, null, 2)\n      );\n    }\n    this.allowedPDSDomains = _allowedPDSDomains;\n    const appRouterFactory = new AppRouterFactory<T>(this.allowedPDSDomains);\n    this.appRouter = appRouterFactory.appRouter;\n    this.getServerCaller = appRouterFactory.getServerCaller;\n    this.utilities = {\n      getBlobUrl: getBlobUrl<T>,\n      parseAtUri,\n    };\n  }\n}\n\nexport type { AppRouter };\nexport { createContext } from \"./server/trpc\";\n","export * from \"../_internal\";\n\nimport { ClimateAiSDK as SDKInternal } from \"../_internal\";\n\nconst sdkInternal = new SDKInternal([\"climateai.org\", \"hypercerts.org\"]);\nconst serverCallerInternal = sdkInternal.getServerCaller();\n"]}