{"version":3,"sources":["../src/_internal/utilities/atproto/getBlobUrl.ts","../src/_internal/utilities/atproto/parseAtUri.ts","../src/_internal/lib/tryCatch.ts","../src/_internal/server/routers/atproto/auth/resume.ts","../src/_internal/server/session.ts","../src/_internal/zod-schemas/blobref.ts","../src/_internal/lib/isObject.ts","../src/_internal/utilities/transform/index.ts","../src/_internal/server/trpc.ts","../src/_internal/server/utils/agent.ts","../src/_internal/server/utils/procedure-factories.ts","../src/_internal/zod-schemas/file.ts","../src/_internal/server/routers/atproto/common/uploadFileAsBlob.ts","../src/_internal/server/routers/atproto/auth/login.ts","../src/_internal/server/routers/atproto/auth/logout.ts","../lex-api/util.ts","../lex-api/lexicons.ts","../lex-api/types/app/certified/location.ts","../lex-api/types/app/gainforest/organization/defaultSite.ts","../lex-api/types/app/gainforest/organization/info.ts","../lex-api/types/app/gainforest/organization/layer.ts","../lex-api/types/app/gainforest/organization/observations/measuredTreesCluster.ts","../lex-api/types/org/hypercerts/claim/activity.ts","../lex-api/types/org/hypercerts/claim/contribution.ts","../lex-api/types/org/hypercerts/claim/project.ts","../src/_internal/server/utils/atproto-crud.ts","../src/_internal/server/routers/atproto/gainforest/organization/info/get.ts","../src/_internal/server/routers/atproto/hypercerts/location/get.ts","../src/_internal/server/routers/atproto/hypercerts/location/getDefault.ts","../src/_internal/server/routers/atproto/gainforest/organization/observations/measuredTreesCluster/get.ts","../src/_internal/zod-schemas/strongref.ts","../src/_internal/server/utils/ownership.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/create.ts","../src/_internal/server/routers/atproto/gainforest/organization/info/createOrUpdate.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/createOrUpdate.ts","../src/_internal/server/routers/atproto/hypercerts/location/getAll.ts","../src/_internal/lib/geojson/validate.ts","../src/_internal/lib/geojson/computations.ts","../src/_internal/server/routers/atproto/hypercerts/location/utils.ts","../src/_internal/server/routers/atproto/hypercerts/location/create.ts","../src/_internal/server/routers/atproto/hypercerts/location/update.ts","../src/_internal/server/routers/atproto/hypercerts/location/setDefault.ts","../src/_internal/server/routers/atproto/hypercerts/location/delete.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/getAll.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/getAllAcrossOrgs.ts","../src/_internal/server/routers/atproto/hypercerts/claim/activity/get.ts","../src/_internal/server/routers/atproto/gainforest/organization/observations/measuredTreesCluster/_addToProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/observations/measuredTreesCluster/_removeFromProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/_addToProject.ts","../src/_internal/server/utils/validate-record-or-throw.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/_removeFromProject.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/get.ts","../src/_internal/server/routers/atproto/hypercerts/claim/project/get.ts","../src/_internal/server/routers/atproto/hypercerts/claim/project/getAll.ts","../src/_internal/server/routers/atproto/gainforest/organization/layer/getAll.ts","../src/_internal/server/routers/_app.ts","../src/_internal/index.ts","../src/_public/index.ts"],"names":["BlobRef","TRPCError","CredentialSession","z","SignJWT","jwtVerify","cookies","CID","superjson","initTRPC","Agent","isObject","id","Lexicons","ValidationError","is$typed","validate","isMain","validateMain","hashMain","XRPCError","COLLECTION","RESOURCE_NAME","geometry","featureCollection","centerOfMass","turfCentroid","centroidPosition","bbox","turfBbox","centroid","turfLength","areaSqMeters","turfArea","LOCATION_COLLECTION","DEFAULT_SITE_COLLECTION","validateRecord"],"mappings":"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","file":"index.cjs","sourcesContent":["import {\n  type LargeBlob,\n  type LargeImage,\n  type SmallBlob,\n  type SmallImage,\n  type Uri,\n} from \"@/../lex-api/types/app/gainforest/common/defs\";\nimport type { $Typed } from \"@/../lex-api/util\";\nimport type { BlobRefGenerator } from \"@/_internal/zod-schemas/blobref\";\nimport { BlobRef } from \"@atproto/api\";\nimport { SupportedPDSDomain } from \"../..\";\n\nconst getBlobUrl = <T extends SupportedPDSDomain>(\n  did: string,\n  imageData:\n    | string\n    | BlobRef\n    | BlobRefGenerator\n    | $Typed<Uri | SmallImage | LargeImage | SmallBlob | LargeBlob>\n    | Uri\n    | SmallImage\n    | LargeImage\n    | SmallBlob\n    | LargeBlob,\n  pdsDomain: T\n) => {\n  if (typeof imageData === \"string\") {\n    const imageUrl = new URL(imageData);\n    return imageUrl.toString();\n  }\n\n  const isBlobRef =\n    imageData instanceof BlobRef ||\n    (\"ref\" in imageData && \"mimeType\" in imageData && \"size\" in imageData);\n  if (isBlobRef) {\n    const ref = imageData.ref as unknown as { $link?: string } | string;\n    const cid = typeof ref === \"string\" ? ref : (ref?.$link ?? String(ref));\n    const encodedCid = encodeURIComponent(cid);\n    return `https://${pdsDomain}/xrpc/com.atproto.sync.getBlob?did=${did}&cid=${encodedCid}`;\n  }\n\n  // Handle $Typed cases\n  if (imageData.$type === \"app.gainforest.common.defs#uri\") {\n    const uri = imageData.uri;\n    // TODO: handle other URI types\n    // if (uri.startsWith(\"at://\")) {\n    //   const { did: uriDid, rkey: uriRkey } = parseAtUri(uri);\n    //   return `${PDS_URL}/xrpc/com.atproto.repo.getRecord?did=${uriDid}&rkey=${uriRkey}`;\n    // }\n    return uri;\n  }\n\n  if (\n    imageData.$type === \"app.gainforest.common.defs#smallBlob\" ||\n    imageData.$type === \"app.gainforest.common.defs#largeBlob\"\n  ) {\n    const blob = imageData.blob;\n    return getBlobUrl(did, blob, pdsDomain);\n  }\n\n  if (\n    imageData.$type === \"app.gainforest.common.defs#smallImage\" ||\n    imageData.$type === \"app.gainforest.common.defs#largeImage\"\n  ) {\n    const image = imageData.image;\n    return getBlobUrl(did, image, pdsDomain);\n  }\n\n  if (\"blob\" in imageData) {\n    const blob = imageData.blob;\n    return getBlobUrl(did, blob, pdsDomain);\n  }\n\n  if (\"image\" in imageData) {\n    const image = imageData.image;\n    return getBlobUrl(did, image, pdsDomain);\n  }\n\n  if (\"uri\" in imageData) {\n    const uri = imageData.uri;\n    return uri;\n  }\n\n  // Line for compile time check that all cases are handled. THIS SHOULD NEVER BE REACHED.\n  const imageDataTypeCheck = imageData satisfies never;\n  return imageDataTypeCheck;\n};\n\nexport { getBlobUrl };\n","const parseAtUri = (atUri: string) => {\n  let cleanedAtUri = atUri.replace(\"at://\", \"\");\n\n  const splitUri = cleanedAtUri.split(\"/\");\n\n  const did = splitUri.at(0) ?? \"\";\n  const collection = splitUri.at(1) ?? \"\";\n  const rkey = splitUri.at(2) ?? \"self\";\n\n  return { did, collection, rkey };\n};\n\nexport { parseAtUri };\n","export const tryCatch = async <T>(\n  promise: Promise<T>\n): Promise<[T, null] | [null, Error]> => {\n  try {\n    const result = await promise;\n    return [result, null];\n  } catch (error) {\n    return [null, error as Error];\n  }\n};\n","import { type SupportedPDSDomain } from \"@/_internal/index\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport {\n  getSessionFromRequest,\n  StoredSession,\n} from \"@/_internal/server/session\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport { CredentialSession } from \"@atproto/api\";\nimport { TRPCError } from \"@trpc/server\";\nimport z from \"zod\";\n\n/**\n * Result of a successful session resume\n */\nexport type ResumeResult = {\n  did: string;\n  handle: string;\n  service: SupportedPDSDomain;\n};\n\n/**\n * Helper to create a credential session from stored session data.\n */\nexport const resumeCredentialSession = (\n  service: SupportedPDSDomain,\n  sessionData: StoredSession\n) => {\n  const credentialSession = new CredentialSession(\n    new URL(`https://${service}`)\n  );\n\n  return credentialSession.resumeSession({\n    accessJwt: sessionData.accessJwt,\n    refreshJwt: sessionData.refreshJwt,\n    handle: sessionData.handle,\n    did: sessionData.did,\n    active: true,\n  });\n};\n\n/**\n * Pure function to resume a session.\n * Can be reused outside of tRPC context.\n */\nexport const resumePure = async <T extends SupportedPDSDomain>(\n  service: T\n): Promise<ResumeResult> => {\n  const session = await getSessionFromRequest(service);\n\n  if (!session) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"No active session found. Please log in.\",\n    });\n  }\n\n  const credentialSession = new CredentialSession(\n    new URL(`https://${service}`)\n  );\n\n  const [resumeSessionResult, resumeSessionError] = await tryCatch(\n    credentialSession.resumeSession({\n      accessJwt: session.accessJwt,\n      refreshJwt: session.refreshJwt,\n      handle: session.handle,\n      did: session.did,\n      active: true,\n    })\n  );\n\n  if (resumeSessionError !== null) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"Failed to resume session. Please log in again.\",\n      cause: resumeSessionError,\n    });\n  }\n\n  if (resumeSessionResult === null || !resumeSessionResult.success) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"Failed to resume session. Please log in again.\",\n    });\n  }\n\n  return {\n    did: resumeSessionResult.data.did,\n    handle: resumeSessionResult.data.handle,\n    service: service,\n  };\n};\n\n/**\n * Factory to create the tRPC procedure for resuming a session.\n */\nexport const resumeFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        service: allowedPDSDomainSchema,\n      })\n    )\n    .query(async ({ input }) => {\n      return resumePure(input.service);\n    });\n};\n","import { cookies } from \"next/headers\";\nimport { SignJWT, jwtVerify } from \"jose\";\nimport type { JwtPayload } from \"@atproto/oauth-client-node\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport { resumeCredentialSession } from \"./routers/atproto/auth/resume\";\n\nexport interface StoredSession extends JwtPayload {\n  accessJwt: string;\n  refreshJwt: string;\n  did: string;\n  handle: string;\n}\n\nconst SECRET_KEY = new TextEncoder().encode(\n  process.env.COOKIE_SECRET || \"your-secret-key-min-32-chars-long\"\n);\n\nasync function encrypt(payload: StoredSession): Promise<string> {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"30d\")\n    .sign(SECRET_KEY);\n}\n\nasync function decrypt(token: string): Promise<StoredSession | null> {\n  try {\n    const { payload } = await jwtVerify(token, SECRET_KEY);\n    return payload as StoredSession;\n  } catch {\n    return null;\n  }\n}\n\nexport async function getSessionFromRequest(\n  service: SupportedPDSDomain = \"climateai.org\"\n): Promise<StoredSession | null> {\n  const cookieStore = await cookies();\n  const encryptedSession = cookieStore.get(`${service}_session`);\n\n  if (!encryptedSession) {\n    return null;\n  }\n\n  return await decrypt(encryptedSession.value);\n}\n\nexport { resumeCredentialSession } from \"./../server/routers/atproto/auth/resume\";\n\nexport async function saveSession(\n  session: StoredSession,\n  service: SupportedPDSDomain = \"climateai.org\"\n) {\n  const cookieStore = await cookies();\n  const encrypted = await encrypt(session);\n\n  cookieStore.set(`${service}_session`, encrypted, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 60 * 60 * 24 * 30,\n    path: \"/\",\n  });\n\n  return encrypted;\n}\n\nexport async function clearSession(\n  service: SupportedPDSDomain = \"climateai.org\"\n) {\n  const cookieStore = await cookies();\n  cookieStore.delete(`${service}_session`);\n}\n","import z from \"zod\";\nimport { CID } from \"multiformats/cid\";\nimport type { Version } from \"multiformats/cid\";\nimport { BlobRef } from \"@atproto/api\";\n\nconst BlobRefGeneratorSchema = z.object({\n  $type: z.literal(\"blob-ref-generator\"),\n  ref: z.object({\n    $link: z.string(),\n  }),\n  mimeType: z.string(),\n  size: z.number(),\n});\n\ntype BlobRefGenerator = z.infer<typeof BlobRefGeneratorSchema>;\n\nconst toBlobRef = (input: BlobRefGenerator) => {\n  const validCID: CID<unknown, number, number, Version> = CID.parse(\n    input.ref.$link\n  );\n  return BlobRef.fromJsonRef({\n    $type: \"blob\",\n    ref: validCID,\n    mimeType: input.mimeType,\n    size: input.size,\n  });\n};\n\nconst toBlobRefGenerator = (blobRef: BlobRef): BlobRefGenerator => {\n  const json = blobRef.toJSON() as Omit<BlobRefGenerator, \"$type\"> & {\n    $type: \"blob\";\n  };\n  return {\n    $type: \"blob-ref-generator\",\n    ref: json.ref,\n    mimeType: json.mimeType,\n    size: json.size,\n  };\n};\n\nexport {\n  BlobRefGeneratorSchema,\n  toBlobRef,\n  toBlobRefGenerator,\n  type BlobRefGenerator,\n  BlobRef,\n};\n","export const isObject = (value: unknown): value is object => {\n  return (\n    typeof value === \"object\" &&\n    value !== null &&\n    !Array.isArray(value) &&\n    !(value instanceof RegExp) &&\n    !(value instanceof Date) &&\n    !(value instanceof Set) &&\n    !(value instanceof Map)\n  );\n};\n","// utils/transformer.ts\nimport type { DataTransformer } from \"@trpc/server\";\nimport superjson, { type SuperJSONResult } from \"superjson\";\nimport {\n  type BlobRefGenerator,\n  toBlobRef,\n} from \"@/_internal/zod-schemas/blobref\";\nimport { BlobRef } from \"@atproto/api\";\nimport { isObject } from \"@/_internal/lib/isObject\";\n\ntype ReplaceType<T, U, V> =\n  // If T directly extends U, substitute to V\n  T extends U ? V\n  : // If T is an array, recursively apply ReplaceType on the element type\n  T extends (infer Item)[] ? ReplaceType<Item, U, V>[]\n  : // If T is an object, recursively apply ReplaceType on all properties\n  T extends object ? { [K in keyof T]: ReplaceType<T[K], U, V> }\n  : // Otherwise, keep original type\n    T;\n\ntype Serialize<T> = ReplaceType<T, BlobRef, BlobRefGenerator>;\n\nconst _serialize = <T>(data: T): Serialize<T> => {\n  return JSON.parse(JSON.stringify(data)) as Serialize<T>;\n};\n\nconst _deserialize = <T>(data: Serialize<T>): T => {\n  const isObj = isObject(data);\n  if (!isObj) {\n    if (Array.isArray(data)) {\n      return data.map(_deserialize) as T;\n    }\n    return data as T;\n  }\n  if (\"$type\" in data && data.$type === \"blob\" && \"ref\" in data) {\n    try {\n      return toBlobRef(data as unknown as BlobRefGenerator) as T;\n    } catch {\n      return data as T;\n    }\n  }\n\n  const obj = data as Record<string, unknown>;\n  return Object.fromEntries(\n    Object.entries(obj).map(([key, value]) => [key, _deserialize(value)])\n  ) as T;\n};\n\nexport const customTransformer: DataTransformer = {\n  serialize: (object) => {\n    // typeof object = object\n    // This logic runs for transforming the query or mutation parameters before they are sent to the server.\n    // Conversion of object to string is automatically handled by TRPC.\n    const atprotoSerialized = _serialize(object);\n    const serializedObject = superjson.serialize(atprotoSerialized);\n    return serializedObject;\n  },\n  deserialize: <T>(object: SuperJSONResult): T => {\n    // typeof object = { json: object }\n    // This logic runs for transforming the query or mutation response before it is received by the client.\n    // The received response is automatically converted from stringified JSON to object by TRPC.\n    const superjsonDeserialized = superjson.deserialize(object) as Serialize<T>;\n    const deserializedObject = _deserialize(superjsonDeserialized);\n    // console.log(\"deserialized object\", deserializedObject);\n    return deserializedObject as T;\n  },\n};\n\nexport type SerializedSuperjson<T> = Omit<SuperJSONResult, \"json\"> & {\n  json: Serialize<T>;\n};\n\nexport const serialize = <T>(data: T) => {\n  const result = customTransformer.serialize(data);\n  return result as SerializedSuperjson<T>;\n};\n\nexport const deserialize = <T>(object: SerializedSuperjson<T>): T => {\n  return customTransformer.deserialize(object);\n};\n","import { initTRPC, TRPCError } from \"@trpc/server\";\nimport { getSessionFromRequest } from \"./session\";\nimport { customTransformer } from \"../utilities/transform\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport async function createContext<T extends SupportedPDSDomain>(opts?: {\n  req?: Request;\n  allowedPDSDomains: T[];\n}) {\n  // Extract session from cookies/headers\n  const session =\n    opts?.req ? await getSessionFromRequest(opts.allowedPDSDomains[0]) : null;\n\n  return {\n    session,\n  };\n}\n\nexport type TrpcContext = Awaited<ReturnType<typeof createContext>>;\n\nconst t = initTRPC.context<TrpcContext>().create({\n  transformer: customTransformer,\n});\n\nexport const createTRPCRouter = t.router;\nexport const publicProcedure = t.procedure;\n\nexport const protectedProcedure = t.procedure.use(({ ctx, next }) => {\n  if (!ctx.session) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You must be logged in\",\n    });\n  }\n  return next({ ctx });\n});\n","import { Agent, CredentialSession } from \"@atproto/api\";\nimport { getSessionFromRequest } from \"../session\";\nimport { TRPCError } from \"@trpc/server\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\nexport const getReadAgent = <T extends SupportedPDSDomain>(pdsDomain: T) => {\n  return new Agent({\n    service: new URL(`https://${pdsDomain}`),\n  });\n};\n\nexport const getWriteAgent = async <T extends SupportedPDSDomain>(\n  pdsDomain: T\n) => {\n  const session = await getSessionFromRequest(pdsDomain);\n  if (!session)\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized.\",\n    });\n  const credentialSession = new CredentialSession(\n    new URL(`https://${pdsDomain}`)\n  );\n  const result = await credentialSession.resumeSession({\n    accessJwt: session.accessJwt,\n    refreshJwt: session.refreshJwt,\n    handle: session.handle,\n    did: session.did,\n    active: true,\n  });\n  if (!result.success)\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"Failed to resume session.\",\n    });\n  return new Agent(credentialSession);\n};\n","import { publicProcedure, protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { Agent } from \"@atproto/api\";\nimport { getWriteAgent } from \"./agent\";\n\n// ============================================================================\n// Query Factories\n// ============================================================================\n\n/**\n * Creates a public query factory for GET endpoints that only need did + pdsDomain.\n *\n * @example\n * export const getOrganizationInfoFactory = createDidQueryFactory(getOrganizationInfoPure);\n */\nexport function createDidQueryFactory<TResult>(\n  handler: <T extends SupportedPDSDomain>(did: string, pdsDomain: T) => Promise<TResult>\n) {\n  return <T extends SupportedPDSDomain>(\n    allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n  ) =>\n    publicProcedure\n      .input(\n        z.object({\n          did: z.string(),\n          pdsDomain: allowedPDSDomainSchema,\n        })\n      )\n      .query(({ input }) => handler(input.did, input.pdsDomain));\n}\n\n/**\n * Creates a public query factory for GET endpoints that need did + rkey + pdsDomain.\n *\n * @example\n * export const getLayerFactory = createDidRkeyQueryFactory(getLayerPure);\n */\nexport function createDidRkeyQueryFactory<TResult>(\n  handler: <T extends SupportedPDSDomain>(\n    did: string,\n    rkey: string,\n    pdsDomain: T\n  ) => Promise<TResult>\n) {\n  return <T extends SupportedPDSDomain>(\n    allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n  ) =>\n    publicProcedure\n      .input(\n        z.object({\n          did: z.string(),\n          rkey: z.string(),\n          pdsDomain: allowedPDSDomainSchema,\n        })\n      )\n      .query(({ input }) => handler(input.did, input.rkey, input.pdsDomain));\n}\n\n// ============================================================================\n// Mutation Factories\n// ============================================================================\n\n/**\n * Creates a protected mutation factory with custom additional input.\n *\n * @param additionalInput - Schema for additional input fields beyond did/pdsDomain\n * @param handler - Function that receives agent and full input, returns result\n *\n * @example\n * export const createOrUpdateLayerFactory = createMutationFactory(\n *   {\n *     layer: LayerInputSchema,\n *     uploads: LayerUploadsSchema.optional(),\n *     rkey: z.string().optional(),\n *   },\n *   (agent, input) => createOrUpdateLayerPure(agent, input.did, input.layer, input.uploads, input.rkey)\n * );\n */\nexport function createMutationFactory<\n  TAdditional extends z.ZodRawShape,\n  TResult,\n>(\n  additionalInput: TAdditional,\n  handler: (\n    agent: Agent,\n    input: { did: string; pdsDomain: SupportedPDSDomain } & z.infer<\n      z.ZodObject<TAdditional>\n    >\n  ) => Promise<TResult>\n) {\n  return <T extends SupportedPDSDomain>(\n    allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n  ) =>\n    protectedProcedure\n      .input(\n        z.object({\n          did: z.string(),\n          pdsDomain: allowedPDSDomainSchema,\n          ...additionalInput,\n        })\n      )\n      .mutation(async ({ input }) => {\n        const typedInput = input as { did: string; pdsDomain: SupportedPDSDomain } & z.infer<z.ZodObject<TAdditional>>;\n        const agent = await getWriteAgent(typedInput.pdsDomain);\n        return handler(agent, typedInput);\n      });\n}\n\n/**\n * Creates a protected mutation factory for delete operations.\n *\n * @example\n * export const deleteLayerFactory = createDeleteMutationFactory(deleteLayerPure);\n */\nexport function createDeleteMutationFactory(\n  handler: (agent: Agent, did: string, rkey: string) => Promise<{ success: true }>\n) {\n  return <T extends SupportedPDSDomain>(\n    allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n  ) =>\n    protectedProcedure\n      .input(\n        z.object({\n          did: z.string(),\n          rkey: z.string(),\n          pdsDomain: allowedPDSDomainSchema,\n        })\n      )\n      .mutation(async ({ input }) => {\n        const typedInput = input as { did: string; rkey: string; pdsDomain: T };\n        const agent = await getWriteAgent(typedInput.pdsDomain);\n        return handler(agent, typedInput.did, typedInput.rkey);\n      });\n}\n","import z from \"zod\";\n\nexport const FileGeneratorSchema = z.object({\n  name: z.string(),\n  type: z.string(),\n  dataBase64: z.string(),\n});\n\nexport type FileGenerator = z.infer<typeof FileGeneratorSchema>;\n\nexport const toFile = async (fileGenerator: FileGenerator) => {\n  const file = new File(\n    [Buffer.from(fileGenerator.dataBase64, \"base64\")],\n    fileGenerator.name,\n    { type: fileGenerator.type }\n  );\n  return file;\n};\n\nexport const toFileGenerator = async (file: File) => {\n  return {\n    name: file.name,\n    type: file.type,\n    dataBase64: await file\n      .arrayBuffer()\n      .then((buffer) => Buffer.from(buffer).toString(\"base64\")),\n  };\n};\n","import z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport {\n  FileGeneratorSchema,\n  toFile,\n  type FileGenerator,\n} from \"@/_internal/zod-schemas/file\";\nimport type { Agent } from \"@atproto/api\";\n\n/**\n * Pure function to upload a file as a blob.\n * Can be reused outside of tRPC context.\n */\nexport const uploadFileAsBlobPure = async (\n  file: File | FileGenerator,\n  agent: Agent\n) => {\n  let fileToUpload: File;\n  if (file instanceof File) {\n    fileToUpload = file;\n  } else {\n    fileToUpload = await toFile(file);\n  }\n\n  const [response, error] = await tryCatch(agent.uploadBlob(fileToUpload));\n\n  if (error !== null) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to upload file.\",\n      cause: error,\n    });\n  }\n\n  if (response === null || response.success !== true) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to upload file.\",\n    });\n  }\n\n  return response.data;\n};\n\n/**\n * Factory to create the tRPC procedure for uploading a file as blob.\n */\nexport const uploadFileAsBlobFactory = createMutationFactory(\n  {\n    file: FileGeneratorSchema,\n  },\n  (agent, input) => uploadFileAsBlobPure(input.file, agent)\n);\n","import { type SupportedPDSDomain } from \"@/_internal/index\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { saveSession, type StoredSession } from \"@/_internal/server/session\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport { CredentialSession } from \"@atproto/api\";\nimport { TRPCError } from \"@trpc/server\";\nimport z from \"zod\";\n\n/**\n * Result of a successful login\n */\nexport type LoginResult = {\n  did: string;\n  handle: string;\n  service: SupportedPDSDomain;\n};\n\n/**\n * Pure function to perform login.\n * Can be reused outside of tRPC context.\n */\nexport const loginPure = async <T extends SupportedPDSDomain>(\n  handlePrefix: string,\n  password: string,\n  service: T\n): Promise<LoginResult> => {\n  const session = new CredentialSession(new URL(`https://${service}`));\n\n  const [result, error] = await tryCatch(\n    session.login({\n      identifier: `${handlePrefix}.${service}`,\n      password: password,\n    })\n  );\n\n  if (error !== null) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"Login failed. Please check your credentials.\",\n      cause: error,\n    });\n  }\n\n  if (result === null || !result.success) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"Login failed. Please check your credentials.\",\n    });\n  }\n\n  const context: StoredSession = {\n    accessJwt: result.data.accessJwt,\n    refreshJwt: result.data.refreshJwt,\n    did: result.data.did,\n    handle: result.data.handle,\n  };\n\n  await saveSession(context, service);\n\n  return {\n    did: context.did,\n    handle: context.handle,\n    service: service,\n  };\n};\n\n/**\n * Factory to create the tRPC procedure for login.\n */\nexport const loginFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        handlePrefix: z.string().regex(/^[a-zA-Z0-9-]+$/), // alphanumerics and hyphens only\n        service: allowedPDSDomainSchema,\n        password: z.string(),\n      })\n    )\n    .mutation(async ({ input }) => {\n      return loginPure(input.handlePrefix, input.password, input.service);\n    });\n};\n","import { type SupportedPDSDomain } from \"@/_internal/index\";\nimport { clearSession } from \"@/_internal/server/session\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport z from \"zod\";\n\n/**\n * Result of a successful logout\n */\nexport type LogoutResult = {\n  success: true;\n};\n\n/**\n * Pure function to perform logout.\n * Can be reused outside of tRPC context.\n */\nexport const logoutPure = async <T extends SupportedPDSDomain>(\n  service: T\n): Promise<LogoutResult> => {\n  await clearSession(service);\n  return { success: true };\n};\n\n/**\n * Factory to create the tRPC procedure for logout.\n */\nexport const logoutFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(\n      z.object({\n        service: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      return logoutPure(input.service);\n    });\n};\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\n\nimport { type ValidationResult } from '@atproto/lexicon'\n\nexport type OmitKey<T, K extends keyof T> = {\n  [K2 in keyof T as K2 extends K ? never : K2]: T[K2]\n}\n\nexport type $Typed<V, T extends string = string> = V & { $type: T }\nexport type Un$Typed<V extends { $type?: string }> = OmitKey<V, '$type'>\n\nexport type $Type<Id extends string, Hash extends string> = Hash extends 'main'\n  ? Id\n  : `${Id}#${Hash}`\n\nfunction isObject<V>(v: V): v is V & object {\n  return v != null && typeof v === 'object'\n}\n\nfunction is$type<Id extends string, Hash extends string>(\n  $type: unknown,\n  id: Id,\n  hash: Hash,\n): $type is $Type<Id, Hash> {\n  return hash === 'main'\n    ? $type === id\n    : // $type === `${id}#${hash}`\n      typeof $type === 'string' &&\n        $type.length === id.length + 1 + hash.length &&\n        $type.charCodeAt(id.length) === 35 /* '#' */ &&\n        $type.startsWith(id) &&\n        $type.endsWith(hash)\n}\n\nexport type $TypedObject<\n  V,\n  Id extends string,\n  Hash extends string,\n> = V extends {\n  $type: $Type<Id, Hash>\n}\n  ? V\n  : V extends { $type?: string }\n    ? V extends { $type?: infer T extends $Type<Id, Hash> }\n      ? V & { $type: T }\n      : never\n    : V & { $type: $Type<Id, Hash> }\n\nexport function is$typed<V, Id extends string, Hash extends string>(\n  v: V,\n  id: Id,\n  hash: Hash,\n): v is $TypedObject<V, Id, Hash> {\n  return isObject(v) && '$type' in v && is$type(v.$type, id, hash)\n}\n\nexport function maybe$typed<V, Id extends string, Hash extends string>(\n  v: V,\n  id: Id,\n  hash: Hash,\n): v is V & object & { $type?: $Type<Id, Hash> } {\n  return (\n    isObject(v) &&\n    ('$type' in v ? v.$type === undefined || is$type(v.$type, id, hash) : true)\n  )\n}\n\nexport type Validator<R = unknown> = (v: unknown) => ValidationResult<R>\nexport type ValidatorParam<V extends Validator> =\n  V extends Validator<infer R> ? R : never\n\n/**\n * Utility function that allows to convert a \"validate*\" utility function into a\n * type predicate.\n */\nexport function asPredicate<V extends Validator>(validate: V) {\n  return function <T>(v: T): v is T & ValidatorParam<V> {\n    return validate(v).success\n  }\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport {\n  type LexiconDoc,\n  Lexicons,\n  ValidationError,\n  type ValidationResult,\n} from '@atproto/lexicon'\nimport { type $Typed, is$typed, maybe$typed } from './util.js'\n\nexport const schemaDict = {\n  AppCertifiedBadgeAward: {\n    lexicon: 1,\n    id: 'app.certified.badge.award',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'Records a badge award to a user, project, or activity claim.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['badge', 'subject', 'createdAt'],\n          properties: {\n            badge: {\n              type: 'ref',\n              ref: 'lex:app.certified.badge.definition',\n              description: 'Reference to the badge definition for this award.',\n            },\n            subject: {\n              type: 'union',\n              description:\n                'Entity the badge award is for (either an account DID or any specific AT Protocol record), e.g. a user, a project, or a specific activity claim.',\n              refs: [\n                'lex:app.certified.defs#did',\n                'lex:com.atproto.repo.strongRef',\n              ],\n            },\n            note: {\n              type: 'string',\n              description:\n                'Optional statement explaining the reason for this badge award.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppCertifiedBadgeDefinition: {\n    lexicon: 1,\n    id: 'app.certified.badge.definition',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'Defines a badge that can be awarded via badge award records to users, projects, or activity claims.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['title', 'badgeType', 'icon', 'createdAt'],\n          properties: {\n            badgeType: {\n              type: 'string',\n              description:\n                'Category of the badge (e.g. endorsement, participation, affiliation).',\n            },\n            title: {\n              type: 'string',\n              description: 'Human-readable title of the badge.',\n            },\n            icon: {\n              type: 'blob',\n              description:\n                'Icon representing the badge, stored as a blob for compact visual display.',\n              accept: [\n                'image/png',\n                'image/jpeg',\n                'image/webp',\n                'image/svg+xml',\n              ],\n              maxSize: 1048576,\n            },\n            description: {\n              type: 'string',\n              description:\n                'Optional short statement describing what the badge represents.',\n            },\n            allowedIssuers: {\n              type: 'array',\n              description:\n                'Optional allowlist of DIDs allowed to issue this badge. If omitted, anyone may issue it.',\n              items: {\n                type: 'ref',\n                ref: 'lex:app.certified.defs#did',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppCertifiedBadgeResponse: {\n    lexicon: 1,\n    id: 'app.certified.badge.response',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'Recipient response to a badge award.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['badgeAward', 'response', 'createdAt'],\n          properties: {\n            badgeAward: {\n              type: 'ref',\n              ref: 'lex:app.certified.badge.award',\n              description: 'Reference to the badge award.',\n            },\n            response: {\n              type: 'string',\n              enum: ['accepted', 'rejected'],\n              description:\n                'The recipients response for the badge (accepted or rejected).',\n            },\n            weight: {\n              type: 'string',\n              description:\n                'Optional relative weight for accepted badges, assigned by the recipient.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppCertifiedDefs: {\n    lexicon: 1,\n    id: 'app.certified.defs',\n    description: 'Common type definitions used across certified protocols.',\n    defs: {\n      did: {\n        type: 'string',\n        format: 'did',\n        description: 'A Decentralized Identifier (DID) string.',\n      },\n    },\n  },\n  AppCertifiedLocation: {\n    lexicon: 1,\n    id: 'app.certified.location',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A location reference',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: [\n            'lpVersion',\n            'srs',\n            'locationType',\n            'location',\n            'createdAt',\n          ],\n          properties: {\n            lpVersion: {\n              type: 'string',\n              description: 'The version of the Location Protocol',\n              maxLength: 10,\n            },\n            srs: {\n              type: 'string',\n              format: 'uri',\n              description:\n                'The Spatial Reference System URI (e.g., http://www.opengis.net/def/crs/OGC/1.3/CRS84) that defines the coordinate system.',\n              maxLength: 100,\n            },\n            locationType: {\n              type: 'string',\n              description:\n                'An identifier for the format of the location data (e.g., coordinate-decimal, geojson-point)',\n              knownValues: ['coordinate-decimal', 'geojson-point'],\n              maxLength: 20,\n            },\n            location: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'The location of where the work was performed as a URI or blob.',\n            },\n            name: {\n              type: 'string',\n              description: 'Optional name for this location',\n              maxLength: 1000,\n              maxGraphemes: 100,\n            },\n            description: {\n              type: 'string',\n              description: 'Optional description for this location',\n              maxLength: 2000,\n              maxGraphemes: 500,\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestCommonDefs: {\n    lexicon: 1,\n    id: 'app.gainforest.common.defs',\n    defs: {\n      uri: {\n        type: 'object',\n        required: ['uri'],\n        description: 'Object containing a URI to external data',\n        properties: {\n          uri: {\n            type: 'string',\n            format: 'uri',\n            maxGraphemes: 1024,\n            description: 'URI to external data',\n          },\n        },\n      },\n      smallBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 10485760,\n            description: 'Blob to external data (up to 10MB)',\n          },\n        },\n      },\n      largeBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 104857600,\n            description: 'Blob to external data (up to 100MB)',\n          },\n        },\n      },\n      smallImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a small image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 5242880,\n            description: 'Image (up to 5MB)',\n          },\n        },\n      },\n      largeImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a large image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 10485760,\n            description: 'Image (up to 10MB)',\n          },\n        },\n      },\n      indexedOrganization: {\n        type: 'object',\n        required: ['id', 'name'],\n        properties: {\n          id: {\n            type: 'string',\n            format: 'uri',\n            description: 'The URI of the organization',\n          },\n          name: {\n            type: 'string',\n            description: 'The name of the organization',\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationDefaultSite: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.defaultSite',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of the default site for an organization',\n        key: 'literal:self',\n        record: {\n          type: 'object',\n          required: ['site', 'createdAt'],\n          properties: {\n            site: {\n              type: 'string',\n              format: 'at-uri',\n              description:\n                'The reference to the default site record in the PDS',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationGetIndexedOrganizations: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.getIndexedOrganizations',\n    defs: {\n      main: {\n        type: 'query',\n        description: 'Get all organizations to view initially on map',\n        parameters: {\n          type: 'params',\n          properties: {},\n        },\n        output: {\n          encoding: 'application/json',\n          schema: {\n            type: 'object',\n            required: ['organizations'],\n            properties: {\n              organizations: {\n                type: 'array',\n                items: {\n                  type: 'ref',\n                  ref: 'lex:app.gainforest.common.defs#indexedOrganization',\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationInfo: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.info',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of an organization or project',\n        key: 'literal:self',\n        record: {\n          type: 'object',\n          required: [\n            'displayName',\n            'shortDescription',\n            'longDescription',\n            'objectives',\n            'country',\n            'visibility',\n            'createdAt',\n          ],\n          properties: {\n            displayName: {\n              type: 'string',\n              description: 'The name of the organization or project',\n              minLength: 8,\n              maxLength: 255,\n            },\n            shortDescription: {\n              type: 'string',\n              description: 'The description of the organization or project',\n              minLength: 50,\n              maxLength: 2000,\n            },\n            longDescription: {\n              type: 'string',\n              description:\n                'The long description of the organization or project in richtext',\n              minLength: 50,\n              maxLength: 5000,\n            },\n            coverImage: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallImage',\n              description: 'Cover image for the organization',\n            },\n            logo: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallImage',\n              description: 'Logo for the organization',\n            },\n            objectives: {\n              type: 'array',\n              description: 'The objectives of the organization or project',\n              items: {\n                type: 'string',\n                enum: [\n                  'Conservation',\n                  'Research',\n                  'Education',\n                  'Community',\n                  'Other',\n                ],\n              },\n            },\n            startDate: {\n              type: 'string',\n              description: 'The start date of the organization or project',\n              format: 'datetime',\n            },\n            website: {\n              type: 'string',\n              description: 'The website of the organization or project',\n              format: 'uri',\n            },\n            country: {\n              type: 'string',\n              description:\n                'The country of the organization or project in two letter code (ISO 3166-1 alpha-2)',\n            },\n            visibility: {\n              type: 'string',\n              description:\n                'The visibility of the organization or project in the Green Globe',\n              enum: ['Public', 'Hidden'],\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationLayer: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.layer',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a layer for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['name', 'type', 'uri', 'createdAt'],\n          properties: {\n            name: {\n              type: 'string',\n              description: 'The name of the site',\n            },\n            type: {\n              type: 'string',\n              description: 'The type of the layer',\n              enum: [\n                'geojson_points',\n                'geojson_points_trees',\n                'geojson_line',\n                'choropleth',\n                'choropleth_shannon',\n                'raster_tif',\n                'tms_tile',\n              ],\n            },\n            uri: {\n              type: 'string',\n              format: 'uri',\n              description: 'The URI of the layer',\n            },\n            description: {\n              type: 'string',\n              description: 'The description of the layer',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsDendogram: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.dendogram',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A declaration of a dendogram observation for an organization',\n        key: 'literal:self',\n        record: {\n          type: 'object',\n          required: ['dendogram', 'createdAt'],\n          properties: {\n            dendogram: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallBlob',\n              description: 'An SVG of the dendogram uploaded as blob',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsFauna: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.fauna',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a fauna observation for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each fauna observation',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the fauna observation',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsFlora: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.flora',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a flora observation for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each flora observation',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the flora observation',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationObservationsMeasuredTreesCluster: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.observations.measuredTreesCluster',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A declaration of a measured trees cluster for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['shapefile', 'createdAt'],\n          properties: {\n            shapefile: {\n              type: 'ref',\n              ref: 'lex:app.gainforest.common.defs#smallBlob',\n              description:\n                'A blob pointing to a shapefile of the measured trees cluster',\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationPredictionsFauna: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.predictions.fauna',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a fauna prediction for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each fauna prediction',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the fauna prediction',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  AppGainforestOrganizationPredictionsFlora: {\n    lexicon: 1,\n    id: 'app.gainforest.organization.predictions.flora',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A declaration of a flora prediction for an organization',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['gbifTaxonKeys', 'createdAt'],\n          properties: {\n            gbifTaxonKeys: {\n              type: 'array',\n              description:\n                'An array of GBIF taxon keys for each flora prediction',\n              items: {\n                type: 'string',\n                description: 'The GBIF taxon key of the flora prediction',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              description: 'The date and time of the creation of the record',\n              format: 'datetime',\n            },\n          },\n        },\n      },\n    },\n  },\n  ComAtprotoRepoStrongRef: {\n    lexicon: 1,\n    id: 'com.atproto.repo.strongRef',\n    description: 'A URI with a content-hash fingerprint.',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['uri', 'cid'],\n        properties: {\n          uri: {\n            type: 'string',\n            format: 'at-uri',\n          },\n          cid: {\n            type: 'string',\n            format: 'cid',\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimActivity: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.activity',\n    defs: {\n      main: {\n        type: 'record',\n        description: 'A hypercert record tracking impact work.',\n        key: 'any',\n        record: {\n          type: 'object',\n          required: [\n            'title',\n            'shortDescription',\n            'createdAt',\n            'startDate',\n            'endDate',\n          ],\n          properties: {\n            title: {\n              type: 'string',\n              description: 'Title of the hypercert.',\n              maxLength: 256,\n            },\n            shortDescription: {\n              type: 'string',\n              description: 'Short blurb of the impact work done.',\n              maxLength: 3000,\n              maxGraphemes: 300,\n            },\n            description: {\n              type: 'string',\n              description:\n                'Optional longer description of the impact work done.',\n              maxLength: 30000,\n              maxGraphemes: 3000,\n            },\n            image: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallImage',\n              ],\n              description:\n                'The hypercert visual representation as a URI or image blob.',\n            },\n            workScope: {\n              type: 'ref',\n              ref: 'lex:org.hypercerts.claim.activity#workScope',\n            },\n            startDate: {\n              type: 'string',\n              format: 'datetime',\n              description: 'When the work began',\n            },\n            endDate: {\n              type: 'string',\n              format: 'datetime',\n              description: 'When the work ended',\n            },\n            contributions: {\n              type: 'array',\n              description:\n                'A strong reference to the contributions done to create the impact in the hypercerts. The record referenced must conform with the lexicon org.hypercerts.claim.contribution.',\n              items: {\n                type: 'ref',\n                ref: 'lex:com.atproto.repo.strongRef',\n              },\n            },\n            rights: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the rights that this hypercert has. The record referenced must conform with the lexicon org.hypercerts.claim.rights.',\n            },\n            locations: {\n              type: 'array',\n              description:\n                'An array of strong references to the location where activity was performed. The record referenced must conform with the lexicon app.certified.location.',\n              items: {\n                type: 'ref',\n                ref: 'lex:com.atproto.repo.strongRef',\n              },\n            },\n            project: {\n              type: 'string',\n              format: 'at-uri',\n              description:\n                'A reference (AT-URI) to the project record that this activity is part of. The record referenced must conform with the lexicon org.hypercerts.claim.project. This activity must also be referenced by the project, establishing a bidirectional link.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n      workScope: {\n        type: 'object',\n        description:\n          'Logical scope of the work using label-based conditions. All labels in `withinAllOf` must apply; at least one label in `withinAnyOf` must apply if provided; no label in `withinNoneOf` may apply.',\n        properties: {\n          withinAllOf: {\n            type: 'array',\n            description: 'Labels that MUST all hold for the scope to apply.',\n            items: {\n              type: 'string',\n            },\n            maxLength: 100,\n          },\n          withinAnyOf: {\n            type: 'array',\n            description:\n              'Labels of which AT LEAST ONE must hold (optional). If omitted or empty, imposes no additional condition.',\n            items: {\n              type: 'string',\n            },\n            maxLength: 100,\n          },\n          withinNoneOf: {\n            type: 'array',\n            description: 'Labels that MUST NOT hold for the scope to apply.',\n            items: {\n              type: 'string',\n            },\n            maxLength: 100,\n          },\n        },\n      },\n      activityWeight: {\n        type: 'object',\n        required: ['activity', 'weight'],\n        properties: {\n          activity: {\n            type: 'ref',\n            ref: 'lex:com.atproto.repo.strongRef',\n            description:\n              'A strong reference to a hypercert activity record. This activity must conform to the lexicon org.hypercerts.claim.activity',\n          },\n          weight: {\n            type: 'string',\n            description:\n              'The relative weight/importance of this hypercert activity (stored as a string to avoid float precision issues). Weights can be any positive numeric values and do not need to sum to a specific total; normalization can be performed by the consuming application as needed.',\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimCollection: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.collection',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A collection/group of hypercerts that have a specific property.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['title', 'activities', 'createdAt'],\n          properties: {\n            title: {\n              type: 'string',\n              description: 'The title of this collection',\n              maxLength: 800,\n              maxGraphemes: 80,\n            },\n            shortDescription: {\n              type: 'string',\n              maxLength: 3000,\n              maxGraphemes: 300,\n              description: 'A short description of this collection',\n            },\n            avatar: {\n              type: 'blob',\n              description:\n                'Primary avatar image representing this collection across apps and views; typically a square image.',\n              accept: ['image/png', 'image/jpeg'],\n              maxSize: 1000000,\n            },\n            coverPhoto: {\n              type: 'blob',\n              description: 'The cover photo of this collection.',\n              accept: ['image/png', 'image/jpeg'],\n              maxSize: 1000000,\n            },\n            activities: {\n              type: 'array',\n              description:\n                'Array of activities with their associated weights in this collection',\n              items: {\n                type: 'ref',\n                ref: 'lex:org.hypercerts.claim.activity#activityWeight',\n              },\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimContribution: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.contribution',\n    defs: {\n      main: {\n        type: 'record',\n        description: \"A contribution made toward a hypercert's impact.\",\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['contributors', 'createdAt'],\n          properties: {\n            role: {\n              type: 'string',\n              description: 'Role or title of the contributor(s).',\n              maxLength: 100,\n            },\n            contributors: {\n              type: 'array',\n              description:\n                'List of the contributors (names, pseudonyms, or DIDs). If multiple contributors are stored in the same hypercertContribution, then they would have the exact same role.',\n              items: {\n                type: 'string',\n              },\n            },\n            description: {\n              type: 'string',\n              description: 'What the contribution concretely achieved',\n              maxLength: 2000,\n              maxGraphemes: 500,\n            },\n            startDate: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'When this contribution started. This should be a subset of the hypercert timeframe.',\n            },\n            endDate: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'When this contribution finished.  This should be a subset of the hypercert timeframe.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimEvaluation: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.evaluation',\n    defs: {\n      score: {\n        type: 'object',\n        description: 'Overall score for an evaluation on a numeric scale.',\n        required: ['min', 'max', 'value'],\n        properties: {\n          min: {\n            type: 'integer',\n            description: 'Minimum value of the scale, e.g. 0 or 1.',\n          },\n          max: {\n            type: 'integer',\n            description: 'Maximum value of the scale, e.g. 5 or 10.',\n          },\n          value: {\n            type: 'integer',\n            description: 'Score within the inclusive range [min, max].',\n          },\n        },\n      },\n      main: {\n        type: 'record',\n        description:\n          'An evaluation of a hypercert record (e.g. an activity and its impact).',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['evaluators', 'summary', 'createdAt'],\n          properties: {\n            subject: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to what is being evaluated. (e.g activity, measurement, contribution, etc.)',\n            },\n            evaluators: {\n              type: 'array',\n              description: 'DIDs of the evaluators',\n              items: {\n                type: 'ref',\n                ref: 'lex:app.certified.defs#did',\n              },\n              maxLength: 1000,\n            },\n            content: {\n              type: 'array',\n              description:\n                'Evaluation data (URIs or blobs) containing detailed reports or methodology',\n              items: {\n                type: 'union',\n                refs: [\n                  'lex:org.hypercerts.defs#uri',\n                  'lex:org.hypercerts.defs#smallBlob',\n                ],\n              },\n              maxLength: 100,\n            },\n            measurements: {\n              type: 'array',\n              description:\n                'Optional references to the measurements that contributed to this evaluation. The record(s) referenced must conform with the lexicon org.hypercerts.claim.measurement ',\n              items: {\n                type: 'ref',\n                ref: 'lex:com.atproto.repo.strongRef',\n              },\n              maxLength: 100,\n            },\n            summary: {\n              type: 'string',\n              description: 'Brief evaluation summary',\n              maxLength: 5000,\n              maxGraphemes: 1000,\n            },\n            score: {\n              type: 'ref',\n              ref: 'lex:org.hypercerts.claim.evaluation#score',\n              description:\n                'Optional overall score for this evaluation on a numeric scale.',\n            },\n            location: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'An optional reference for georeferenced evaluations. The record referenced must conform with the lexicon app.certified.location.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimEvidence: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.evidence',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A piece of evidence related to a hypercert record (e.g. an activity, project, claim, or evaluation). Evidence may support, clarify, or challenge the referenced subject.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['content', 'title', 'createdAt'],\n          properties: {\n            subject: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the record this evidence relates to (e.g. an activity, project, claim, or evaluation).',\n            },\n            content: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'A piece of evidence (URI or blob) related to the subject record; it may support, clarify, or challenge a hypercert claim.',\n            },\n            title: {\n              type: 'string',\n              maxLength: 256,\n              description: 'Title to describe the nature of the evidence.',\n            },\n            shortDescription: {\n              type: 'string',\n              maxLength: 3000,\n              maxGraphemes: 300,\n              description:\n                'Short description explaining what this evidence shows.',\n            },\n            description: {\n              type: 'string',\n              description:\n                'Longer description describing the evidence in more detail.',\n              maxLength: 30000,\n              maxGraphemes: 3000,\n            },\n            relationType: {\n              type: 'string',\n              description: 'How this evidence relates to the subject.',\n              knownValues: ['supports', 'challenges', 'clarifies'],\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimMeasurement: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.measurement',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'Measurement data related to a hypercert record (e.g. an activity and its impact).',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['measurers', 'metric', 'value', 'createdAt'],\n          properties: {\n            subject: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the record this measurement refers to (e.g. an activity, project, or claim).',\n            },\n            measurers: {\n              type: 'array',\n              description:\n                'DIDs of the entity (or entities) that measured this data',\n              items: {\n                type: 'ref',\n                ref: 'lex:app.certified.defs#did',\n              },\n              maxLength: 100,\n            },\n            metric: {\n              type: 'string',\n              description: 'The metric being measured',\n              maxLength: 500,\n            },\n            value: {\n              type: 'string',\n              description: 'The measured value',\n              maxLength: 500,\n            },\n            methodType: {\n              type: 'string',\n              description: 'Short identifier for the measurement methodology',\n              maxLength: 30,\n            },\n            methodURI: {\n              type: 'string',\n              format: 'uri',\n              description:\n                'URI to methodology documentation, standard protocol, or measurement procedure',\n            },\n            evidenceURI: {\n              type: 'array',\n              description:\n                'URIs to related evidence or underlying data (e.g. org.hypercerts.claim.evidence records or raw datasets)',\n              items: {\n                type: 'string',\n                format: 'uri',\n              },\n              maxLength: 50,\n            },\n            location: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to the location where the measurement was taken. The record referenced must conform with the lexicon app.certified.location',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimProject: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.project',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'A project that can include multiple activities, each of which may be linked to at most one project.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['title', 'shortDescription', 'createdAt'],\n          properties: {\n            title: {\n              type: 'string',\n              description: 'Title of this project',\n              maxLength: 800,\n              maxGraphemes: 80,\n            },\n            shortDescription: {\n              type: 'string',\n              maxLength: 3000,\n              maxGraphemes: 300,\n              description:\n                'Short summary of this project, suitable for previews and list views.',\n            },\n            description: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.pages.linearDocument#main',\n              description:\n                'Rich-text description of this project, represented as a Leaflet linear document.',\n            },\n            avatar: {\n              type: 'blob',\n              description:\n                'Primary avatar image representing this project across apps and views; typically a square logo or project identity image.',\n              accept: ['image/png', 'image/jpeg'],\n              maxSize: 1000000,\n            },\n            coverPhoto: {\n              type: 'blob',\n              description: 'The cover photo of this project.',\n              accept: ['image/png', 'image/jpeg'],\n              maxSize: 1000000,\n            },\n            activities: {\n              type: 'array',\n              description:\n                'Array of activities with their associated weights in this project',\n              items: {\n                type: 'ref',\n                ref: 'lex:org.hypercerts.claim.activity#activityWeight',\n              },\n            },\n            location: {\n              type: 'ref',\n              ref: 'lex:com.atproto.repo.strongRef',\n              description:\n                'A strong reference to a location record describing where the work for this project took place. The referenced record must conform to the app.certified.location lexicon.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsClaimRights: {\n    lexicon: 1,\n    id: 'org.hypercerts.claim.rights',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'Describes the rights that a contributor and/or an owner has, such as whether the hypercert can be sold, transferred, and under what conditions.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: [\n            'rightsName',\n            'rightsType',\n            'rightsDescription',\n            'createdAt',\n          ],\n          properties: {\n            rightsName: {\n              type: 'string',\n              description: 'Full name of the rights',\n              maxLength: 100,\n            },\n            rightsType: {\n              type: 'string',\n              description: 'Short rights identifier for easier search',\n              maxLength: 10,\n            },\n            rightsDescription: {\n              type: 'string',\n              description: 'Description of the rights of this hypercert',\n            },\n            attachment: {\n              type: 'union',\n              refs: [\n                'lex:org.hypercerts.defs#uri',\n                'lex:org.hypercerts.defs#smallBlob',\n              ],\n              description:\n                'An attachment to define the rights further, e.g. a legal document.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this record was originally created',\n            },\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsDefs: {\n    lexicon: 1,\n    id: 'org.hypercerts.defs',\n    defs: {\n      uri: {\n        type: 'object',\n        required: ['uri'],\n        description: 'Object containing a URI to external data',\n        properties: {\n          uri: {\n            type: 'string',\n            format: 'uri',\n            maxGraphemes: 1024,\n            description: 'URI to external data',\n          },\n        },\n      },\n      smallBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 10485760,\n            description: 'Blob to external data (up to 10MB)',\n          },\n        },\n      },\n      largeBlob: {\n        type: 'object',\n        required: ['blob'],\n        description: 'Object containing a blob to external data',\n        properties: {\n          blob: {\n            type: 'blob',\n            accept: ['*/*'],\n            maxSize: 104857600,\n            description: 'Blob to external data (up to 100MB)',\n          },\n        },\n      },\n      smallImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a small image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 5242880,\n            description: 'Image (up to 5MB)',\n          },\n        },\n      },\n      largeImage: {\n        type: 'object',\n        required: ['image'],\n        description: 'Object containing a large image',\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'],\n            maxSize: 10485760,\n            description: 'Image (up to 10MB)',\n          },\n        },\n      },\n    },\n  },\n  OrgHypercertsFundingReceipt: {\n    lexicon: 1,\n    id: 'org.hypercerts.funding.receipt',\n    defs: {\n      main: {\n        type: 'record',\n        description:\n          'Records a funding receipt for a payment from one user to another user. It may be recorded by the recipient, by the sender, or by a third party. The sender may remain anonymous.',\n        key: 'tid',\n        record: {\n          type: 'object',\n          required: ['from', 'to', 'amount', 'currency', 'createdAt'],\n          properties: {\n            from: {\n              type: 'ref',\n              ref: 'lex:app.certified.defs#did',\n              description:\n                'DID of the sender who transferred the funds. Leave empty if sender wants to stay anonymous.',\n            },\n            to: {\n              type: 'string',\n              description:\n                'The recipient of the funds. Can be identified by DID or a clear-text name.',\n            },\n            amount: {\n              type: 'string',\n              description: 'Amount of funding received.',\n            },\n            currency: {\n              type: 'string',\n              description: 'Currency of the payment (e.g. EUR, USD, ETH).',\n            },\n            paymentRail: {\n              type: 'string',\n              description:\n                'How the funds were transferred (e.g. bank_transfer, credit_card, onchain, cash, check, payment_processor).',\n            },\n            paymentNetwork: {\n              type: 'string',\n              description:\n                'Optional network within the payment rail (e.g. arbitrum, ethereum, sepa, visa, paypal).',\n            },\n            transactionId: {\n              type: 'string',\n              description:\n                'Identifier of the underlying payment transaction (e.g. bank reference, onchain transaction hash, or processor-specific ID). Use paymentNetwork to specify the network where applicable.',\n            },\n            for: {\n              type: 'string',\n              format: 'at-uri',\n              description:\n                'Optional reference to the activity, project, or organization this funding relates to.',\n            },\n            notes: {\n              type: 'string',\n              description:\n                'Optional notes or additional context for this funding receipt.',\n              maxLength: 500,\n            },\n            occurredAt: {\n              type: 'string',\n              format: 'datetime',\n              description: 'Timestamp when the payment occurred.',\n            },\n            createdAt: {\n              type: 'string',\n              format: 'datetime',\n              description:\n                'Client-declared timestamp when this receipt record was created.',\n            },\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksBlockquote: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.blockquote',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['plaintext'],\n        properties: {\n          plaintext: {\n            type: 'string',\n          },\n          facets: {\n            type: 'array',\n            items: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.richtext.facet',\n            },\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksBskyPost: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.bskyPost',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['postRef'],\n        properties: {\n          postRef: {\n            type: 'ref',\n            ref: 'lex:com.atproto.repo.strongRef',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksButton: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.button',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['text', 'url'],\n        properties: {\n          text: {\n            type: 'string',\n          },\n          url: {\n            type: 'string',\n            format: 'uri',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksCode: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.code',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['plaintext'],\n        properties: {\n          plaintext: {\n            type: 'string',\n          },\n          language: {\n            type: 'string',\n          },\n          syntaxHighlightingTheme: {\n            type: 'string',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksHeader: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.header',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['plaintext'],\n        properties: {\n          level: {\n            type: 'integer',\n            minimum: 1,\n            maximum: 6,\n          },\n          plaintext: {\n            type: 'string',\n          },\n          facets: {\n            type: 'array',\n            items: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.richtext.facet',\n            },\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksHorizontalRule: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.horizontalRule',\n    defs: {\n      main: {\n        type: 'object',\n        required: [],\n        properties: {},\n      },\n    },\n  },\n  PubLeafletBlocksIframe: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.iframe',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['url'],\n        properties: {\n          url: {\n            type: 'string',\n            format: 'uri',\n          },\n          height: {\n            type: 'integer',\n            minimum: 16,\n            maximum: 1600,\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksImage: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.image',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['image', 'aspectRatio'],\n        properties: {\n          image: {\n            type: 'blob',\n            accept: ['image/*'],\n            maxSize: 1000000,\n          },\n          alt: {\n            type: 'string',\n            description:\n              'Alt text description of the image, for accessibility.',\n          },\n          aspectRatio: {\n            type: 'ref',\n            ref: 'lex:pub.leaflet.blocks.image#aspectRatio',\n          },\n        },\n      },\n      aspectRatio: {\n        type: 'object',\n        required: ['width', 'height'],\n        properties: {\n          width: {\n            type: 'integer',\n          },\n          height: {\n            type: 'integer',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksMath: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.math',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['tex'],\n        properties: {\n          tex: {\n            type: 'string',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksPage: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.page',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['id'],\n        properties: {\n          id: {\n            type: 'string',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksPoll: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.poll',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['pollRef'],\n        properties: {\n          pollRef: {\n            type: 'ref',\n            ref: 'lex:com.atproto.repo.strongRef',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksText: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.text',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['plaintext'],\n        properties: {\n          plaintext: {\n            type: 'string',\n          },\n          textSize: {\n            type: 'string',\n            enum: ['default', 'small', 'large'],\n          },\n          facets: {\n            type: 'array',\n            items: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.richtext.facet',\n            },\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksUnorderedList: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.unorderedList',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['children'],\n        properties: {\n          children: {\n            type: 'array',\n            items: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.blocks.unorderedList#listItem',\n            },\n          },\n        },\n      },\n      listItem: {\n        type: 'object',\n        required: ['content'],\n        properties: {\n          content: {\n            type: 'union',\n            refs: [\n              'lex:pub.leaflet.blocks.text',\n              'lex:pub.leaflet.blocks.header',\n              'lex:pub.leaflet.blocks.image',\n            ],\n          },\n          children: {\n            type: 'array',\n            items: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.blocks.unorderedList#listItem',\n            },\n          },\n        },\n      },\n    },\n  },\n  PubLeafletBlocksWebsite: {\n    lexicon: 1,\n    id: 'pub.leaflet.blocks.website',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['src'],\n        properties: {\n          previewImage: {\n            type: 'blob',\n            accept: ['image/*'],\n            maxSize: 1000000,\n          },\n          title: {\n            type: 'string',\n          },\n          description: {\n            type: 'string',\n          },\n          src: {\n            type: 'string',\n            format: 'uri',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletPagesLinearDocument: {\n    lexicon: 1,\n    id: 'pub.leaflet.pages.linearDocument',\n    defs: {\n      main: {\n        type: 'object',\n        required: ['blocks'],\n        properties: {\n          id: {\n            type: 'string',\n          },\n          blocks: {\n            type: 'array',\n            items: {\n              type: 'ref',\n              ref: 'lex:pub.leaflet.pages.linearDocument#block',\n            },\n          },\n        },\n      },\n      block: {\n        type: 'object',\n        required: ['block'],\n        properties: {\n          block: {\n            type: 'union',\n            refs: [\n              'lex:pub.leaflet.blocks.iframe',\n              'lex:pub.leaflet.blocks.text',\n              'lex:pub.leaflet.blocks.blockquote',\n              'lex:pub.leaflet.blocks.header',\n              'lex:pub.leaflet.blocks.image',\n              'lex:pub.leaflet.blocks.unorderedList',\n              'lex:pub.leaflet.blocks.website',\n              'lex:pub.leaflet.blocks.math',\n              'lex:pub.leaflet.blocks.code',\n              'lex:pub.leaflet.blocks.horizontalRule',\n              'lex:pub.leaflet.blocks.bskyPost',\n              'lex:pub.leaflet.blocks.page',\n              'lex:pub.leaflet.blocks.poll',\n              'lex:pub.leaflet.blocks.button',\n            ],\n          },\n          alignment: {\n            type: 'string',\n            knownValues: [\n              'lex:pub.leaflet.pages.linearDocument#textAlignLeft',\n              'lex:pub.leaflet.pages.linearDocument#textAlignCenter',\n              'lex:pub.leaflet.pages.linearDocument#textAlignRight',\n              'lex:pub.leaflet.pages.linearDocument#textAlignJustify',\n            ],\n          },\n        },\n      },\n      textAlignLeft: {\n        type: 'token',\n      },\n      textAlignCenter: {\n        type: 'token',\n      },\n      textAlignRight: {\n        type: 'token',\n      },\n      textAlignJustify: {\n        type: 'token',\n      },\n      quote: {\n        type: 'object',\n        required: ['start', 'end'],\n        properties: {\n          start: {\n            type: 'ref',\n            ref: 'lex:pub.leaflet.pages.linearDocument#position',\n          },\n          end: {\n            type: 'ref',\n            ref: 'lex:pub.leaflet.pages.linearDocument#position',\n          },\n        },\n      },\n      position: {\n        type: 'object',\n        required: ['block', 'offset'],\n        properties: {\n          block: {\n            type: 'array',\n            items: {\n              type: 'integer',\n            },\n          },\n          offset: {\n            type: 'integer',\n          },\n        },\n      },\n    },\n  },\n  PubLeafletRichtextFacet: {\n    lexicon: 1,\n    id: 'pub.leaflet.richtext.facet',\n    defs: {\n      main: {\n        type: 'object',\n        description: 'Annotation of a sub-string within rich text.',\n        required: ['index', 'features'],\n        properties: {\n          index: {\n            type: 'ref',\n            ref: 'lex:pub.leaflet.richtext.facet#byteSlice',\n          },\n          features: {\n            type: 'array',\n            items: {\n              type: 'union',\n              refs: [\n                'lex:pub.leaflet.richtext.facet#link',\n                'lex:pub.leaflet.richtext.facet#didMention',\n                'lex:pub.leaflet.richtext.facet#atMention',\n                'lex:pub.leaflet.richtext.facet#code',\n                'lex:pub.leaflet.richtext.facet#highlight',\n                'lex:pub.leaflet.richtext.facet#underline',\n                'lex:pub.leaflet.richtext.facet#strikethrough',\n                'lex:pub.leaflet.richtext.facet#id',\n                'lex:pub.leaflet.richtext.facet#bold',\n                'lex:pub.leaflet.richtext.facet#italic',\n              ],\n            },\n          },\n        },\n      },\n      byteSlice: {\n        type: 'object',\n        description:\n          'Specifies the sub-string range a facet feature applies to. Start index is inclusive, end index is exclusive. Indices are zero-indexed, counting bytes of the UTF-8 encoded text. NOTE: some languages, like Javascript, use UTF-16 or Unicode codepoints for string slice indexing; in these languages, convert to byte arrays before working with facets.',\n        required: ['byteStart', 'byteEnd'],\n        properties: {\n          byteStart: {\n            type: 'integer',\n            minimum: 0,\n          },\n          byteEnd: {\n            type: 'integer',\n            minimum: 0,\n          },\n        },\n      },\n      link: {\n        type: 'object',\n        description:\n          'Facet feature for a URL. The text URL may have been simplified or truncated, but the facet reference should be a complete URL.',\n        required: ['uri'],\n        properties: {\n          uri: {\n            type: 'string',\n          },\n        },\n      },\n      didMention: {\n        type: 'object',\n        description: 'Facet feature for mentioning a did.',\n        required: ['did'],\n        properties: {\n          did: {\n            type: 'string',\n            format: 'did',\n          },\n        },\n      },\n      atMention: {\n        type: 'object',\n        description: 'Facet feature for mentioning an AT URI.',\n        required: ['atURI'],\n        properties: {\n          atURI: {\n            type: 'string',\n            format: 'uri',\n          },\n        },\n      },\n      code: {\n        type: 'object',\n        description: 'Facet feature for inline code.',\n        required: [],\n        properties: {},\n      },\n      highlight: {\n        type: 'object',\n        description: 'Facet feature for highlighted text.',\n        required: [],\n        properties: {},\n      },\n      underline: {\n        type: 'object',\n        description: 'Facet feature for underline markup',\n        required: [],\n        properties: {},\n      },\n      strikethrough: {\n        type: 'object',\n        description: 'Facet feature for strikethrough markup',\n        required: [],\n        properties: {},\n      },\n      id: {\n        type: 'object',\n        description:\n          'Facet feature for an identifier. Used for linking to a segment',\n        required: [],\n        properties: {\n          id: {\n            type: 'string',\n          },\n        },\n      },\n      bold: {\n        type: 'object',\n        description: 'Facet feature for bold text',\n        required: [],\n        properties: {},\n      },\n      italic: {\n        type: 'object',\n        description: 'Facet feature for italic text',\n        required: [],\n        properties: {},\n      },\n    },\n  },\n} as const satisfies Record<string, LexiconDoc>\nexport const schemas = Object.values(schemaDict) satisfies LexiconDoc[]\nexport const lexicons: Lexicons = new Lexicons(schemas)\n\nexport function validate<T extends { $type: string }>(\n  v: unknown,\n  id: string,\n  hash: string,\n  requiredType: true,\n): ValidationResult<T>\nexport function validate<T extends { $type?: string }>(\n  v: unknown,\n  id: string,\n  hash: string,\n  requiredType?: false,\n): ValidationResult<T>\nexport function validate(\n  v: unknown,\n  id: string,\n  hash: string,\n  requiredType?: boolean,\n): ValidationResult {\n  return (requiredType ? is$typed : maybe$typed)(v, id, hash)\n    ? lexicons.validate(`${id}#${hash}`, v)\n    : {\n        success: false,\n        error: new ValidationError(\n          `Must be an object with \"${hash === 'main' ? id : `${id}#${hash}`}\" $type property`,\n        ),\n      }\n}\n\nexport const ids = {\n  AppCertifiedBadgeAward: 'app.certified.badge.award',\n  AppCertifiedBadgeDefinition: 'app.certified.badge.definition',\n  AppCertifiedBadgeResponse: 'app.certified.badge.response',\n  AppCertifiedDefs: 'app.certified.defs',\n  AppCertifiedLocation: 'app.certified.location',\n  AppGainforestCommonDefs: 'app.gainforest.common.defs',\n  AppGainforestOrganizationDefaultSite:\n    'app.gainforest.organization.defaultSite',\n  AppGainforestOrganizationGetIndexedOrganizations:\n    'app.gainforest.organization.getIndexedOrganizations',\n  AppGainforestOrganizationInfo: 'app.gainforest.organization.info',\n  AppGainforestOrganizationLayer: 'app.gainforest.organization.layer',\n  AppGainforestOrganizationObservationsDendogram:\n    'app.gainforest.organization.observations.dendogram',\n  AppGainforestOrganizationObservationsFauna:\n    'app.gainforest.organization.observations.fauna',\n  AppGainforestOrganizationObservationsFlora:\n    'app.gainforest.organization.observations.flora',\n  AppGainforestOrganizationObservationsMeasuredTreesCluster:\n    'app.gainforest.organization.observations.measuredTreesCluster',\n  AppGainforestOrganizationPredictionsFauna:\n    'app.gainforest.organization.predictions.fauna',\n  AppGainforestOrganizationPredictionsFlora:\n    'app.gainforest.organization.predictions.flora',\n  ComAtprotoRepoStrongRef: 'com.atproto.repo.strongRef',\n  OrgHypercertsClaimActivity: 'org.hypercerts.claim.activity',\n  OrgHypercertsClaimCollection: 'org.hypercerts.claim.collection',\n  OrgHypercertsClaimContribution: 'org.hypercerts.claim.contribution',\n  OrgHypercertsClaimEvaluation: 'org.hypercerts.claim.evaluation',\n  OrgHypercertsClaimEvidence: 'org.hypercerts.claim.evidence',\n  OrgHypercertsClaimMeasurement: 'org.hypercerts.claim.measurement',\n  OrgHypercertsClaimProject: 'org.hypercerts.claim.project',\n  OrgHypercertsClaimRights: 'org.hypercerts.claim.rights',\n  OrgHypercertsDefs: 'org.hypercerts.defs',\n  OrgHypercertsFundingReceipt: 'org.hypercerts.funding.receipt',\n  PubLeafletBlocksBlockquote: 'pub.leaflet.blocks.blockquote',\n  PubLeafletBlocksBskyPost: 'pub.leaflet.blocks.bskyPost',\n  PubLeafletBlocksButton: 'pub.leaflet.blocks.button',\n  PubLeafletBlocksCode: 'pub.leaflet.blocks.code',\n  PubLeafletBlocksHeader: 'pub.leaflet.blocks.header',\n  PubLeafletBlocksHorizontalRule: 'pub.leaflet.blocks.horizontalRule',\n  PubLeafletBlocksIframe: 'pub.leaflet.blocks.iframe',\n  PubLeafletBlocksImage: 'pub.leaflet.blocks.image',\n  PubLeafletBlocksMath: 'pub.leaflet.blocks.math',\n  PubLeafletBlocksPage: 'pub.leaflet.blocks.page',\n  PubLeafletBlocksPoll: 'pub.leaflet.blocks.poll',\n  PubLeafletBlocksText: 'pub.leaflet.blocks.text',\n  PubLeafletBlocksUnorderedList: 'pub.leaflet.blocks.unorderedList',\n  PubLeafletBlocksWebsite: 'pub.leaflet.blocks.website',\n  PubLeafletPagesLinearDocument: 'pub.leaflet.pages.linearDocument',\n  PubLeafletRichtextFacet: 'pub.leaflet.richtext.facet',\n} as const\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../lexicons'\nimport { type $Typed, is$typed as _is$typed, type OmitKey } from '../../../util'\nimport type * as OrgHypercertsDefs from '../../org/hypercerts/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.certified.location'\n\nexport interface Main {\n  $type: 'app.certified.location'\n  /** The version of the Location Protocol */\n  lpVersion: string\n  /** The Spatial Reference System URI (e.g., http://www.opengis.net/def/crs/OGC/1.3/CRS84) that defines the coordinate system. */\n  srs: string\n  /** An identifier for the format of the location data (e.g., coordinate-decimal, geojson-point) */\n  locationType: 'coordinate-decimal' | 'geojson-point' | (string & {})\n  location:\n    | $Typed<OrgHypercertsDefs.Uri>\n    | $Typed<OrgHypercertsDefs.SmallBlob>\n    | { $type: string }\n  /** Optional name for this location */\n  name?: string\n  /** Optional description for this location */\n  description?: string\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.defaultSite'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.defaultSite'\n  /** The reference to the default site record in the PDS */\n  site: string\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\nimport type * as AppGainforestCommonDefs from '../common/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.info'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.info'\n  /** The name of the organization or project */\n  displayName: string\n  /** The description of the organization or project */\n  shortDescription: string\n  /** The long description of the organization or project in richtext */\n  longDescription: string\n  coverImage?: AppGainforestCommonDefs.SmallImage\n  logo?: AppGainforestCommonDefs.SmallImage\n  /** The objectives of the organization or project */\n  objectives: (\n    | 'Conservation'\n    | 'Research'\n    | 'Education'\n    | 'Community'\n    | 'Other'\n  )[]\n  /** The start date of the organization or project */\n  startDate?: string\n  /** The website of the organization or project */\n  website?: string\n  /** The country of the organization or project in two letter code (ISO 3166-1 alpha-2) */\n  country: string\n  /** The visibility of the organization or project in the Green Globe */\n  visibility: 'Public' | 'Hidden'\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.layer'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.layer'\n  /** The name of the site */\n  name: string\n  /** The type of the layer */\n  type:\n    | 'geojson_points'\n    | 'geojson_points_trees'\n    | 'geojson_line'\n    | 'choropleth'\n    | 'choropleth_shannon'\n    | 'raster_tif'\n    | 'tms_tile'\n  /** The URI of the layer */\n  uri: string\n  /** The description of the layer */\n  description?: string\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../../util'\nimport type * as AppGainforestCommonDefs from '../../common/defs.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'app.gainforest.organization.observations.measuredTreesCluster'\n\nexport interface Main {\n  $type: 'app.gainforest.organization.observations.measuredTreesCluster'\n  shapefile: AppGainforestCommonDefs.SmallBlob\n  /** The date and time of the creation of the record */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\nimport type * as OrgHypercertsDefs from '../defs.js'\nimport type * as ComAtprotoRepoStrongRef from '../../../com/atproto/repo/strongRef.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'org.hypercerts.claim.activity'\n\nexport interface Main {\n  $type: 'org.hypercerts.claim.activity'\n  /** Title of the hypercert. */\n  title: string\n  /** Short blurb of the impact work done. */\n  shortDescription: string\n  /** Optional longer description of the impact work done. */\n  description?: string\n  image?:\n    | $Typed<OrgHypercertsDefs.Uri>\n    | $Typed<OrgHypercertsDefs.SmallImage>\n    | { $type: string }\n  workScope?: WorkScope\n  /** When the work began */\n  startDate: string\n  /** When the work ended */\n  endDate: string\n  /** A strong reference to the contributions done to create the impact in the hypercerts. The record referenced must conform with the lexicon org.hypercerts.claim.contribution. */\n  contributions?: ComAtprotoRepoStrongRef.Main[]\n  rights?: ComAtprotoRepoStrongRef.Main\n  /** An array of strong references to the location where activity was performed. The record referenced must conform with the lexicon app.certified.location. */\n  locations?: ComAtprotoRepoStrongRef.Main[]\n  /** A reference (AT-URI) to the project record that this activity is part of. The record referenced must conform with the lexicon org.hypercerts.claim.project. This activity must also be referenced by the project, establishing a bidirectional link. */\n  project?: string\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n\n/** Logical scope of the work using label-based conditions. All labels in `withinAllOf` must apply; at least one label in `withinAnyOf` must apply if provided; no label in `withinNoneOf` may apply. */\nexport interface WorkScope {\n  $type?: 'org.hypercerts.claim.activity#workScope'\n  /** Labels that MUST all hold for the scope to apply. */\n  withinAllOf?: string[]\n  /** Labels of which AT LEAST ONE must hold (optional). If omitted or empty, imposes no additional condition. */\n  withinAnyOf?: string[]\n  /** Labels that MUST NOT hold for the scope to apply. */\n  withinNoneOf?: string[]\n}\n\nconst hashWorkScope = 'workScope'\n\nexport function isWorkScope<V>(v: V) {\n  return is$typed(v, id, hashWorkScope)\n}\n\nexport function validateWorkScope<V>(v: V) {\n  return validate<WorkScope & V>(v, id, hashWorkScope)\n}\n\nexport interface ActivityWeight {\n  $type?: 'org.hypercerts.claim.activity#activityWeight'\n  activity: ComAtprotoRepoStrongRef.Main\n  /** The relative weight/importance of this hypercert activity (stored as a string to avoid float precision issues). Weights can be any positive numeric values and do not need to sum to a specific total; normalization can be performed by the consuming application as needed. */\n  weight: string\n}\n\nconst hashActivityWeight = 'activityWeight'\n\nexport function isActivityWeight<V>(v: V) {\n  return is$typed(v, id, hashActivityWeight)\n}\n\nexport function validateActivityWeight<V>(v: V) {\n  return validate<ActivityWeight & V>(v, id, hashActivityWeight)\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'org.hypercerts.claim.contribution'\n\nexport interface Main {\n  $type: 'org.hypercerts.claim.contribution'\n  /** Role or title of the contributor(s). */\n  role?: string\n  /** List of the contributors (names, pseudonyms, or DIDs). If multiple contributors are stored in the same hypercertContribution, then they would have the exact same role. */\n  contributors: string[]\n  /** What the contribution concretely achieved */\n  description?: string\n  /** When this contribution started. This should be a subset of the hypercert timeframe. */\n  startDate?: string\n  /** When this contribution finished.  This should be a subset of the hypercert timeframe. */\n  endDate?: string\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","/**\n * GENERATED CODE - DO NOT MODIFY\n */\nimport { type ValidationResult, BlobRef } from '@atproto/lexicon'\nimport { CID } from 'multiformats/cid'\nimport { validate as _validate } from '../../../../lexicons'\nimport {\n  type $Typed,\n  is$typed as _is$typed,\n  type OmitKey,\n} from '../../../../util'\nimport type * as PubLeafletPagesLinearDocument from '../../../pub/leaflet/pages/linearDocument.js'\nimport type * as OrgHypercertsClaimActivity from './activity.js'\nimport type * as ComAtprotoRepoStrongRef from '../../../com/atproto/repo/strongRef.js'\n\nconst is$typed = _is$typed,\n  validate = _validate\nconst id = 'org.hypercerts.claim.project'\n\nexport interface Main {\n  $type: 'org.hypercerts.claim.project'\n  /** Title of this project */\n  title: string\n  /** Short summary of this project, suitable for previews and list views. */\n  shortDescription: string\n  description?: PubLeafletPagesLinearDocument.Main\n  /** Primary avatar image representing this project across apps and views; typically a square logo or project identity image. */\n  avatar?: BlobRef\n  /** The cover photo of this project. */\n  coverPhoto?: BlobRef\n  /** Array of activities with their associated weights in this project */\n  activities?: OrgHypercertsClaimActivity.ActivityWeight[]\n  location?: ComAtprotoRepoStrongRef.Main\n  /** Client-declared timestamp when this record was originally created */\n  createdAt: string\n  [k: string]: unknown\n}\n\nconst hashMain = 'main'\n\nexport function isMain<V>(v: V) {\n  return is$typed(v, id, hashMain)\n}\n\nexport function validateMain<V>(v: V) {\n  return validate<Main & V>(v, id, hashMain, true)\n}\n\nexport {\n  type Main as Record,\n  isMain as isRecord,\n  validateMain as validateRecord,\n}\n","import type { Agent } from \"@atproto/api\";\nimport type { ValidationResult } from \"@atproto/lexicon\";\nimport { XRPCError } from \"@atproto/xrpc\";\nimport { TRPCError } from \"@trpc/server\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport type { GetRecordResponse, PutRecordResponse } from \"./response-types\";\n\n/**\n * Base type constraint for ATProto records\n */\ntype RecordType = Record<string, unknown>;\n\n/**\n * Lexicon validator interface - all lexicon types from lex-api expose this\n */\nexport type LexiconValidator<T> = {\n  validateRecord: (record: unknown) => ValidationResult<T>;\n};\n\n/**\n * Error messages with context for user-friendly feedback\n */\nconst createErrorMessage = {\n  fetchFailed: (resource: string) => `Failed to fetch ${resource}.`,\n  listFailed: (resource: string) => `Failed to list ${resource}.`,\n  createFailed: (resource: string) => `Failed to create ${resource}.`,\n  updateFailed: (resource: string) => `Failed to update ${resource}.`,\n  deleteFailed: (resource: string) => `Failed to delete ${resource}.`,\n  notFound: (resource: string) => `The ${resource} was not found.`,\n  invalidData: (resource: string) =>\n    `The ${resource} data is invalid or malformed.`,\n  unauthorized: () => \"You are not authorized to perform this action.\",\n  unknown: () => \"An unexpected error occurred. Please try again.\",\n};\n\n/**\n * Converts XRPC errors to user-friendly TRPC errors\n */\nconst handleXrpcError = (error: XRPCError, resource: string): never => {\n  if (error.error === \"InvalidRequest\") {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: createErrorMessage.invalidData(resource),\n      cause: error,\n    });\n  }\n  if (error.error === \"RecordNotFound\") {\n    throw new TRPCError({\n      code: \"NOT_FOUND\",\n      message: createErrorMessage.notFound(resource),\n      cause: error,\n    });\n  }\n  if (error.error === \"AuthRequired\" || error.error === \"InvalidToken\") {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: createErrorMessage.unauthorized(),\n      cause: error,\n    });\n  }\n  throw new TRPCError({\n    code: \"INTERNAL_SERVER_ERROR\",\n    message: createErrorMessage.unknown(),\n    cause: error,\n  });\n};\n\n/**\n * Validates a record against a lexicon schema\n */\nconst validateRecord = <T>(\n  record: unknown,\n  validator: LexiconValidator<T>,\n  resource: string\n): T => {\n  let validationResponse: ValidationResult<T>;\n  try {\n    validationResponse = validator.validateRecord(record);\n  } catch (error) {\n    throw new TRPCError({\n      code: \"UNPROCESSABLE_CONTENT\",\n      message: createErrorMessage.invalidData(resource),\n      cause: error,\n    });\n  }\n  if (!validationResponse.success) {\n    throw new TRPCError({\n      code: \"UNPROCESSABLE_CONTENT\",\n      message: validationResponse.error.message,\n      cause: validationResponse.error,\n    });\n  }\n  return validationResponse.value;\n};\n\n/**\n * Handles common error scenarios for ATProto operations\n */\nconst handleOperationError = (\n  error: Error,\n  resource: string,\n  operation: \"fetch\" | \"list\" | \"create\" | \"update\" | \"delete\"\n): never => {\n  if (error instanceof XRPCError) {\n    handleXrpcError(error, resource);\n  }\n  if (error instanceof TRPCError) {\n    throw error;\n  }\n  const messageMap = {\n    fetch: createErrorMessage.fetchFailed,\n    list: createErrorMessage.listFailed,\n    create: createErrorMessage.createFailed,\n    update: createErrorMessage.updateFailed,\n    delete: createErrorMessage.deleteFailed,\n  };\n  throw new TRPCError({\n    code: \"INTERNAL_SERVER_ERROR\",\n    message: messageMap[operation](resource),\n    cause: error,\n  });\n};\n\n// ============================================================================\n// CRUD Operations\n// ============================================================================\n\nexport type GetRecordParams<T> = {\n  agent: Agent;\n  collection: string;\n  repo: string;\n  rkey: string;\n  validator: LexiconValidator<T>;\n  /** Human-readable resource name for error messages (e.g., \"layer\", \"organization info\") */\n  resourceName: string;\n};\n\n/**\n * Fetches a single record from ATProto, validates it, and returns typed result.\n *\n * @example\n * const result = await getRecord({\n *   agent: getReadAgent(pdsDomain),\n *   collection: \"app.gainforest.organization.layer\",\n *   repo: did,\n *   rkey: \"abc123\",\n *   validator: AppGainforestOrganizationLayer,\n *   resourceName: \"layer\",\n * });\n */\nexport const getRecord = async <T>({\n  agent,\n  collection,\n  repo,\n  rkey,\n  validator,\n  resourceName,\n}: GetRecordParams<T>): Promise<GetRecordResponse<T>> => {\n  const [response, error] = await tryCatch(\n    agent.com.atproto.repo.getRecord({ collection, repo, rkey })\n  );\n\n  if (error !== null) {\n    handleOperationError(error, resourceName, \"fetch\");\n  }\n\n  if (response === null || !response.success) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: createErrorMessage.fetchFailed(resourceName),\n    });\n  }\n\n  const validatedValue = validateRecord(response.data.value, validator, resourceName);\n\n  return {\n    uri: response.data.uri,\n    cid: response.data.cid,\n    value: validatedValue,\n  };\n};\n\nexport type ListRecordsParams<T> = {\n  agent: Agent;\n  collection: string;\n  repo: string;\n  validator: LexiconValidator<T>;\n  resourceName: string;\n  /** If true, silently skip invalid records. If false, throw on first invalid record. Default: true */\n  skipInvalid?: boolean;\n  limit?: number;\n  cursor?: string;\n};\n\nexport type ListRecordsResponse<T> = {\n  records: GetRecordResponse<T>[];\n  cursor?: string;\n};\n\n/**\n * Lists records from ATProto, validates each, and returns typed results.\n *\n * @example\n * const result = await listRecords({\n *   agent: getReadAgent(pdsDomain),\n *   collection: \"app.gainforest.organization.layer\",\n *   repo: did,\n *   validator: AppGainforestOrganizationLayer,\n *   resourceName: \"layers\",\n * });\n */\nexport const listRecords = async <T>({\n  agent,\n  collection,\n  repo,\n  validator,\n  resourceName,\n  skipInvalid = true,\n  limit,\n  cursor,\n}: ListRecordsParams<T>): Promise<ListRecordsResponse<T>> => {\n  const [response, error] = await tryCatch(\n    agent.com.atproto.repo.listRecords({ collection, repo, limit, cursor })\n  );\n\n  if (error !== null) {\n    handleOperationError(error, resourceName, \"list\");\n  }\n\n  if (response === null || !response.success) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: createErrorMessage.listFailed(resourceName),\n    });\n  }\n\n  const validatedRecords: GetRecordResponse<T>[] = [];\n\n  for (const record of response.data.records) {\n    try {\n      const validatedValue = validateRecord(record.value, validator, resourceName);\n      validatedRecords.push({\n        uri: record.uri,\n        cid: record.cid,\n        value: validatedValue,\n      });\n    } catch (validationError) {\n      if (!skipInvalid) {\n        throw validationError;\n      }\n      // Skip invalid records silently when skipInvalid is true\n    }\n  }\n\n  return {\n    records: validatedRecords,\n    cursor: response.data.cursor,\n  };\n};\n\nexport type CreateRecordParams<T extends RecordType> = {\n  agent: Agent;\n  collection: string;\n  repo: string;\n  record: T;\n  validator: LexiconValidator<T>;\n  resourceName: string;\n  /** Optional record key. If not provided, ATProto will auto-generate one. */\n  rkey?: string;\n};\n\n/**\n * Creates a new record in ATProto after validation.\n *\n * @example\n * const result = await createRecord({\n *   agent: await getWriteAgent(pdsDomain),\n *   collection: \"app.gainforest.organization.layer\",\n *   repo: did,\n *   record: layerData,\n *   validator: AppGainforestOrganizationLayer,\n *   resourceName: \"layer\",\n * });\n */\nexport const createRecord = async <T extends RecordType>({\n  agent,\n  collection,\n  repo,\n  record,\n  validator,\n  resourceName,\n  rkey,\n}: CreateRecordParams<T>): Promise<PutRecordResponse<T>> => {\n  // Validate before sending to ensure data integrity\n  const validatedRecord = validateRecord(record, validator, resourceName);\n\n  const [response, error] = await tryCatch(\n    agent.com.atproto.repo.createRecord({\n      collection,\n      repo,\n      record: validatedRecord as RecordType,\n      rkey,\n    })\n  );\n\n  if (error !== null) {\n    handleOperationError(error, resourceName, \"create\");\n  }\n\n  if (response === null || !response.success) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: createErrorMessage.createFailed(resourceName),\n    });\n  }\n\n  return {\n    uri: response.data.uri,\n    cid: response.data.cid,\n    validationStatus: response.data.validationStatus,\n    value: validatedRecord,\n  };\n};\n\nexport type PutRecordParams<T extends RecordType> = {\n  agent: Agent;\n  collection: string;\n  repo: string;\n  rkey: string;\n  record: T;\n  validator: LexiconValidator<T>;\n  resourceName: string;\n};\n\n/**\n * Updates (or creates) a record in ATProto using putRecord (upsert).\n *\n * @example\n * const result = await putRecord({\n *   agent: await getWriteAgent(pdsDomain),\n *   collection: \"app.gainforest.organization.layer\",\n *   repo: did,\n *   rkey: \"abc123\",\n *   record: layerData,\n *   validator: AppGainforestOrganizationLayer,\n *   resourceName: \"layer\",\n * });\n */\nexport const putRecord = async <T extends RecordType>({\n  agent,\n  collection,\n  repo,\n  rkey,\n  record,\n  validator,\n  resourceName,\n}: PutRecordParams<T>): Promise<PutRecordResponse<T>> => {\n  // Validate before sending\n  const validatedRecord = validateRecord(record, validator, resourceName);\n\n  const [response, error] = await tryCatch(\n    agent.com.atproto.repo.putRecord({\n      collection,\n      repo,\n      rkey,\n      record: validatedRecord as RecordType,\n    })\n  );\n\n  if (error !== null) {\n    handleOperationError(error, resourceName, \"update\");\n  }\n\n  if (response === null || !response.success) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: createErrorMessage.updateFailed(resourceName),\n    });\n  }\n\n  return {\n    uri: response.data.uri,\n    cid: response.data.cid,\n    validationStatus: response.data.validationStatus,\n    value: validatedRecord,\n  };\n};\n\nexport type DeleteRecordParams = {\n  agent: Agent;\n  collection: string;\n  repo: string;\n  rkey: string;\n  resourceName: string;\n};\n\nexport type DeleteRecordResponse = {\n  success: true;\n};\n\n/**\n * Deletes a record from ATProto.\n *\n * @example\n * await deleteRecord({\n *   agent: await getWriteAgent(pdsDomain),\n *   collection: \"app.gainforest.organization.layer\",\n *   repo: did,\n *   rkey: \"abc123\",\n *   resourceName: \"layer\",\n * });\n */\nexport const deleteRecord = async ({\n  agent,\n  collection,\n  repo,\n  rkey,\n  resourceName,\n}: DeleteRecordParams): Promise<DeleteRecordResponse> => {\n  const [response, error] = await tryCatch(\n    agent.com.atproto.repo.deleteRecord({ collection, repo, rkey })\n  );\n\n  if (error !== null) {\n    handleOperationError(error, resourceName, \"delete\");\n  }\n\n  if (response === null || !response.success) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: createErrorMessage.deleteFailed(resourceName),\n    });\n  }\n\n  return { success: true };\n};\n\n// ============================================================================\n// Convenience: Create or Update (conditional upsert)\n// ============================================================================\n\nexport type CreateOrUpdateRecordParams<T extends RecordType> = {\n  agent: Agent;\n  collection: string;\n  repo: string;\n  record: T;\n  validator: LexiconValidator<T>;\n  resourceName: string;\n  /** If provided, uses putRecord (update). If not, uses createRecord (insert). */\n  rkey?: string;\n};\n\n/**\n * Creates or updates a record based on whether rkey is provided.\n * - With rkey: uses putRecord (upsert)\n * - Without rkey: uses createRecord (insert with auto-generated rkey)\n */\nexport const createOrUpdateRecord = async <T extends RecordType>({\n  agent,\n  collection,\n  repo,\n  record,\n  validator,\n  resourceName,\n  rkey,\n}: CreateOrUpdateRecordParams<T>): Promise<PutRecordResponse<T>> => {\n  if (rkey) {\n    return putRecord({\n      agent,\n      collection,\n      repo,\n      rkey,\n      record,\n      validator,\n      resourceName,\n    });\n  }\n  return createRecord({\n    agent,\n    collection,\n    repo,\n    record,\n    validator,\n    resourceName,\n  });\n};\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationInfo } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.gainforest.organization.info\" as const;\nconst RESOURCE_NAME = \"organization info\" as const;\n\n/**\n * Pure function to get organization info by DID.\n * Can be reused outside of tRPC context.\n */\nexport const getOrganizationInfoPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<AppGainforestOrganizationInfo.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey: \"self\",\n    validator: AppGainforestOrganizationInfo,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting organization info.\n */\nexport const getOrganizationInfoFactory = createDidQueryFactory(getOrganizationInfoPure);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppCertifiedLocation } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidRkeyQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.certified.location\" as const;\nconst RESOURCE_NAME = \"location\" as const;\n\n/**\n * Pure function to get a location by DID and rkey.\n * Can be reused outside of tRPC context.\n */\nexport const getLocationPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  rkey: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<AppCertifiedLocation.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey,\n    validator: AppCertifiedLocation,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting a location.\n */\nexport const getLocationFactory = createDidRkeyQueryFactory(getLocationPure);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationDefaultSite } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.gainforest.organization.defaultSite\" as const;\nconst RESOURCE_NAME = \"default location\" as const;\n\n/**\n * Pure function to get the default location for a DID.\n * Can be reused outside of tRPC context.\n */\nexport const getDefaultLocationPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<AppGainforestOrganizationDefaultSite.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey: \"self\",\n    validator: AppGainforestOrganizationDefaultSite,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting the default location.\n */\nexport const getDefaultLocationFactory = createDidQueryFactory(getDefaultLocationPure);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationObservationsMeasuredTreesCluster as MeasuredTreesCluster } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.gainforest.organization.observations.measuredTreesCluster\" as const;\nconst RESOURCE_NAME = \"measured trees cluster\" as const;\n\n/**\n * Pure function to get measured trees cluster by DID.\n * Can be reused outside of tRPC context.\n */\nexport const getMeasuredTreesClusterPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<MeasuredTreesCluster.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey: \"self\",\n    validator: MeasuredTreesCluster,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting measured trees cluster.\n */\nexport const getMeasuredTreesFactory = createDidQueryFactory(getMeasuredTreesClusterPure);\n","import z from \"zod\";\n\nexport const StrongRefSchema = z.object({\n  $type: z.literal(\"com.atproto.repo.strongRef\").optional(),\n  uri: z.string().regex(/^at:\\/\\//),\n  cid: z.string(),\n});\n\nexport type StrongRef = z.infer<typeof StrongRefSchema>;\n","import { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const checkOwnershipByAtUri = (atUri: string, userDid: string) => {\n  const { did } = parseAtUri(atUri);\n  if (did !== userDid) {\n    return false;\n  }\n  return true;\n};\n","import z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport type { Agent } from \"@atproto/api\";\nimport {\n  OrgHypercertsClaimActivity,\n  OrgHypercertsClaimContribution,\n} from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { createRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport { toBlobRef, toBlobRefGenerator } from \"@/_internal/zod-schemas/blobref\";\nimport {\n  type FileGenerator,\n  FileGeneratorSchema,\n} from \"@/_internal/zod-schemas/file\";\nimport { StrongRefSchema } from \"@/_internal/zod-schemas/strongref\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst ACTIVITY_COLLECTION = \"org.hypercerts.claim.activity\" as const;\nconst CONTRIBUTION_COLLECTION = \"org.hypercerts.claim.contribution\" as const;\n\n/**\n * Input schema for claim activity creation\n */\nexport const ClaimActivityInputSchema = z.object({\n  title: z.string().min(1, \"Title is required\"),\n  shortDescription: z.string().min(1, \"Short description is required\"),\n  description: z.string().optional(),\n  locations: StrongRefSchema.array().min(1, \"At least one location is required\"),\n  project: z.string().optional(),\n  workScopes: z.array(z.string()).min(1, \"At least one work scope is required\"),\n  startDate: z.string(),\n  endDate: z.string(),\n  contributors: z\n    .array(z.string())\n    .min(1, \"At least one contributor is required\"),\n  createdAt: z.string().optional(),\n});\n\nexport type ClaimActivityInput = z.infer<typeof ClaimActivityInputSchema>;\n\n/**\n * Upload schema for claim activity\n */\nexport const ClaimActivityUploadsSchema = z.object({\n  image: FileGeneratorSchema,\n});\n\nexport type ClaimActivityUploads = z.infer<typeof ClaimActivityUploadsSchema>;\n\n/**\n * Helper to upload a file and return a blob ref generator\n */\nconst uploadFile = async (fileGenerator: FileGenerator, agent: Agent) => {\n  const file = new File(\n    [Buffer.from(fileGenerator.dataBase64, \"base64\")],\n    fileGenerator.name,\n    { type: fileGenerator.type }\n  );\n  const response = await agent.uploadBlob(file);\n  return toBlobRefGenerator(response.data.blob);\n};\n\n/**\n * Pure function to create a claim activity with contribution.\n * Can be reused outside of tRPC context.\n */\nexport const createClaimActivityPure = async (\n  agent: Agent,\n  activityInput: ClaimActivityInput,\n  uploads: ClaimActivityUploads\n): Promise<PutRecordResponse<OrgHypercertsClaimActivity.Record>> => {\n  const did = agent.did;\n  if (!did) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized to perform this action.\",\n    });\n  }\n\n  // Validate ownership of referenced records\n  for (const location of activityInput.locations) {\n    if (!checkOwnershipByAtUri(location.uri, did)) {\n      throw new TRPCError({\n        code: \"FORBIDDEN\",\n        message: \"One of the locations being referenced is not owned by you.\",\n      });\n    }\n  }\n\n  if (activityInput.project) {\n    if (!checkOwnershipByAtUri(activityInput.project, did)) {\n      throw new TRPCError({\n        code: \"FORBIDDEN\",\n        message: \"The project being referenced is not owned by you.\",\n      });\n    }\n  }\n\n  // Upload the image\n  const [imageBlobRef, uploadError] = await tryCatch(\n    uploadFile(uploads.image, agent)\n  );\n  if (uploadError !== null || !imageBlobRef) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to upload the activity image.\",\n      cause: uploadError,\n    });\n  }\n\n  // Create the activity record\n  const activity: OrgHypercertsClaimActivity.Record = {\n    $type: ACTIVITY_COLLECTION,\n    title: activityInput.title,\n    shortDescription: activityInput.shortDescription,\n    description: activityInput.description,\n    image: {\n      $type: \"org.hypercerts.defs#smallImage\",\n      image: toBlobRef(imageBlobRef),\n    },\n    location: activityInput.locations,\n    project: activityInput.project,\n    workScope: {\n      $type: \"org.hypercerts.claim.activity#workScope\",\n      withinAnyOf: activityInput.workScopes,\n    },\n    startDate: activityInput.startDate,\n    endDate: activityInput.endDate,\n    createdAt: activityInput.createdAt ?? new Date().toISOString(),\n  };\n\n  const activityResult = await createRecord({\n    agent,\n    collection: ACTIVITY_COLLECTION,\n    repo: did,\n    record: activity,\n    validator: OrgHypercertsClaimActivity,\n    resourceName: \"claim activity\",\n  });\n\n  // Create the contribution record\n  const contribution: OrgHypercertsClaimContribution.Record = {\n    $type: CONTRIBUTION_COLLECTION,\n    hypercert: {\n      $type: \"com.atproto.repo.strongRef\",\n      uri: activityResult.uri,\n      cid: activityResult.cid,\n    },\n    role: \"Contributor\",\n    contributors: activityInput.contributors,\n    createdAt: new Date().toISOString(),\n  };\n\n  const [, contributionError] = await tryCatch(\n    createRecord({\n      agent,\n      collection: CONTRIBUTION_COLLECTION,\n      repo: did,\n      record: contribution,\n      validator: OrgHypercertsClaimContribution,\n      resourceName: \"contribution\",\n    })\n  );\n\n  if (contributionError !== null) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to create the contribution record.\",\n      cause: contributionError,\n    });\n  }\n\n  return activityResult;\n};\n\n/**\n * Factory to create the tRPC procedure for creating a claim activity.\n */\nexport const createClaimActivityFactory = createMutationFactory(\n  {\n    activity: ClaimActivityInputSchema,\n    uploads: ClaimActivityUploadsSchema,\n  },\n  (agent, input) => createClaimActivityPure(agent, input.activity, input.uploads)\n);\n","import z from \"zod\";\nimport { AppGainforestOrganizationInfo } from \"@/../lex-api\";\nimport { putRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport { FileGeneratorSchema } from \"@/_internal/zod-schemas/file\";\nimport {\n  BlobRefGeneratorSchema,\n  toBlobRef,\n} from \"@/_internal/zod-schemas/blobref\";\nimport { uploadFileAsBlobPure } from \"../../../common/uploadFileAsBlob\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport type { Agent } from \"@atproto/api\";\n\nconst COLLECTION = \"app.gainforest.organization.info\" as const;\nconst RESOURCE_NAME = \"organization info\" as const;\n\n/**\n * Zod schema for organization objectives\n */\nexport const ObjectivesSchema = z.enum([\n  \"Conservation\",\n  \"Research\",\n  \"Education\",\n  \"Community\",\n  \"Other\",\n]);\n\nexport type Objective = z.infer<typeof ObjectivesSchema>;\n\n/**\n * Zod schema for visibility setting\n */\nexport const VisibilitySchema = z.enum([\"Public\", \"Hidden\"]);\n\nexport type Visibility = z.infer<typeof VisibilitySchema>;\n\n/**\n * Input schema for organization info\n */\nexport const OrganizationInfoInputSchema = z.object({\n  displayName: z.string().min(1, \"Display name is required\"),\n  shortDescription: z.string().min(1, \"Short description is required\"),\n  longDescription: z.string().min(1, \"Long description is required\"),\n  website: z.string().url(\"Website must be a valid URL\").optional(),\n  logo: BlobRefGeneratorSchema.optional(),\n  coverImage: BlobRefGeneratorSchema.optional(),\n  objectives: z.array(ObjectivesSchema).min(1, \"At least one objective is required\"),\n  startDate: z.string().datetime().optional(),\n  country: z.string().min(1, \"Country is required\"),\n  visibility: VisibilitySchema,\n  createdAt: z.string().datetime().optional(),\n});\n\nexport type OrganizationInfoInput = z.infer<typeof OrganizationInfoInputSchema>;\n\n/**\n * Upload schema for optional file uploads\n */\nexport const OrganizationInfoUploadsSchema = z.object({\n  logo: FileGeneratorSchema.optional(),\n  coverImage: FileGeneratorSchema.optional(),\n});\n\nexport type OrganizationInfoUploads = z.infer<typeof OrganizationInfoUploadsSchema>;\n\n/**\n * Pure function to create or update organization info.\n * Can be reused outside of tRPC context.\n */\nexport const createOrUpdateOrganizationInfoPure = async (\n  agent: Agent,\n  did: string,\n  infoInput: OrganizationInfoInput,\n  uploads?: OrganizationInfoUploads\n): Promise<PutRecordResponse<AppGainforestOrganizationInfo.Record>> => {\n  // Handle logo blob\n  const logoBlob =\n    uploads?.logo\n      ? (await uploadFileAsBlobPure(uploads.logo, agent)).blob\n      : infoInput.logo\n        ? toBlobRef(infoInput.logo)\n        : undefined;\n\n  // Handle cover image blob\n  const coverImageBlob =\n    uploads?.coverImage\n      ? (await uploadFileAsBlobPure(uploads.coverImage, agent)).blob\n      : infoInput.coverImage\n        ? toBlobRef(infoInput.coverImage)\n        : undefined;\n\n  const info: AppGainforestOrganizationInfo.Record = {\n    $type: COLLECTION,\n    displayName: infoInput.displayName,\n    shortDescription: infoInput.shortDescription,\n    longDescription: infoInput.longDescription,\n    website: infoInput.website,\n    logo: logoBlob\n      ? { $type: \"app.gainforest.common.defs#smallImage\", image: logoBlob }\n      : undefined,\n    coverImage: coverImageBlob\n      ? { $type: \"app.gainforest.common.defs#smallImage\", image: coverImageBlob }\n      : undefined,\n    objectives: infoInput.objectives,\n    startDate: infoInput.startDate,\n    country: infoInput.country,\n    visibility: infoInput.visibility,\n    createdAt: infoInput.createdAt ?? new Date().toISOString(),\n  };\n\n  return putRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey: \"self\",\n    record: info,\n    validator: AppGainforestOrganizationInfo,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for creating/updating organization info.\n */\nexport const createOrUpdateOrganizationInfoFactory = createMutationFactory(\n  {\n    info: OrganizationInfoInputSchema,\n    uploads: OrganizationInfoUploadsSchema.optional(),\n  },\n  (agent, input) =>\n    createOrUpdateOrganizationInfoPure(agent, input.did, input.info, input.uploads)\n);\n","import z from \"zod\";\nimport { AppGainforestOrganizationLayer } from \"@/../lex-api\";\nimport { createOrUpdateRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport type { Agent } from \"@atproto/api\";\n\nconst COLLECTION = \"app.gainforest.organization.layer\" as const;\nconst RESOURCE_NAME = \"layer\" as const;\n\n/**\n * Zod schema for layer type enum - matches the lexicon definition\n */\nexport const LayerTypeSchema = z.enum([\n  \"geojson_points\",\n  \"geojson_points_trees\",\n  \"geojson_line\",\n  \"choropleth\",\n  \"choropleth_shannon\",\n  \"raster_tif\",\n  \"tms_tile\",\n]);\n\nexport type LayerType = z.infer<typeof LayerTypeSchema>;\n\n/**\n * Input schema for creating/updating a layer\n */\nexport const LayerInputSchema = z.object({\n  name: z.string().min(1, \"Layer name is required\"),\n  type: LayerTypeSchema,\n  uri: z.string().url(\"Layer URI must be a valid URL\"),\n  description: z.string().optional(),\n  createdAt: z.string().datetime().optional(),\n});\n\nexport type LayerInput = z.infer<typeof LayerInputSchema>;\n\n/**\n * Pure function to create or update a layer.\n * Can be reused outside of tRPC context.\n */\nexport const createOrUpdateLayerPure = async (\n  agent: Agent,\n  did: string,\n  layerInput: LayerInput,\n  rkey?: string\n): Promise<PutRecordResponse<AppGainforestOrganizationLayer.Record>> => {\n  const layer: AppGainforestOrganizationLayer.Record = {\n    $type: COLLECTION,\n    name: layerInput.name,\n    type: layerInput.type,\n    uri: layerInput.uri,\n    description: layerInput.description,\n    createdAt: layerInput.createdAt ?? new Date().toISOString(),\n  };\n\n  return createOrUpdateRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    record: layer,\n    validator: AppGainforestOrganizationLayer,\n    resourceName: RESOURCE_NAME,\n    rkey,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for creating/updating a layer.\n */\nexport const createOrUpdateLayerFactory = createMutationFactory(\n  {\n    layer: LayerInputSchema,\n    rkey: z.string().optional(),\n  },\n  (agent, input) => createOrUpdateLayerPure(agent, input.did, input.layer, input.rkey)\n);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport {\n  AppGainforestOrganizationDefaultSite,\n  AppCertifiedLocation,\n} from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { listRecords, getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst LOCATION_COLLECTION = \"app.certified.location\" as const;\nconst DEFAULT_SITE_COLLECTION = \"app.gainforest.organization.defaultSite\" as const;\n\n/**\n * Response type for getAllLocations\n */\nexport type GetAllLocationsResponse = {\n  locations: GetRecordResponse<AppCertifiedLocation.Record>[];\n  defaultLocation: GetRecordResponse<AppGainforestOrganizationDefaultSite.Record> | null;\n};\n\n/**\n * Pure function to get all locations and the default location for a DID.\n * Can be reused outside of tRPC context.\n */\nexport const getAllLocationsPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetAllLocationsResponse> => {\n  const agent = getReadAgent(pdsDomain);\n\n  // Fetch locations and default site in parallel\n  const [locationsResult, defaultSiteResult] = await Promise.all([\n    listRecords({\n      agent,\n      collection: LOCATION_COLLECTION,\n      repo: did,\n      validator: AppCertifiedLocation,\n      resourceName: \"locations\",\n      skipInvalid: true,\n    }),\n    tryCatch(\n      getRecord({\n        agent,\n        collection: DEFAULT_SITE_COLLECTION,\n        repo: did,\n        rkey: \"self\",\n        validator: AppGainforestOrganizationDefaultSite,\n        resourceName: \"default location\",\n      })\n    ),\n  ]);\n\n  // Default site might not exist, so we handle the error gracefully\n  const [defaultSite] = defaultSiteResult;\n\n  return {\n    locations: locationsResult.records,\n    defaultLocation: defaultSite ?? null,\n  };\n};\n\n/**\n * Factory to create the tRPC procedure for getting all locations.\n */\nexport const getAllLocationsFactory = createDidQueryFactory(getAllLocationsPure);\n","import type { GeoJsonObject } from \"geojson\";\n\n/**\n * Validates if an unknown object is a valid GeoJSON object.\n * @param value - The value to validate\n * @returns The validated GeoJSON object\n * @throws Error if the value is not a valid GeoJSON object\n */\nexport function validateGeojsonOrThrow(value: unknown): GeoJsonObject {\n  if (value === null || typeof value !== \"object\") {\n    throw new Error(\"GeoJSON must be an object\");\n  }\n\n  const obj = value as Record<string, unknown>;\n\n  if (!(\"type\" in obj) || typeof obj.type !== \"string\") {\n    throw new Error(\"GeoJSON must have a 'type' property of type string\");\n  }\n\n  const type = obj.type;\n\n  // Validate FeatureCollection\n  if (type === \"FeatureCollection\") {\n    if (!(\"features\" in obj) || !Array.isArray(obj.features)) {\n      throw new Error(\n        \"FeatureCollection must have a 'features' property of type array\"\n      );\n    }\n\n    // Validate each feature in the collection\n    for (let i = 0; i < obj.features.length; i++) {\n      try {\n        validateGeojsonOrThrow(obj.features[i]);\n      } catch (error) {\n        throw new Error(\n          `FeatureCollection.features[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n        );\n      }\n    }\n\n    return obj as unknown as GeoJsonObject;\n  }\n\n  // Validate Feature\n  if (type === \"Feature\") {\n    if (!(\"geometry\" in obj)) {\n      throw new Error(\"Feature must have a 'geometry' property\");\n    }\n\n    if (obj.geometry !== null) {\n      try {\n        validateGeometry(obj.geometry);\n      } catch (error) {\n        throw new Error(\n          `Feature.geometry is invalid: ${error instanceof Error ? error.message : String(error)}`\n        );\n      }\n    }\n\n    if (!(\"properties\" in obj)) {\n      throw new Error(\"Feature must have a 'properties' property\");\n    }\n\n    if (obj.properties !== null && typeof obj.properties !== \"object\") {\n      throw new Error(\"Feature.properties must be an object or null\");\n    }\n\n    return obj as unknown as GeoJsonObject;\n  }\n\n  // Validate Geometry types\n  try {\n    validateGeometry(obj);\n    return obj as unknown as GeoJsonObject;\n  } catch (error) {\n    throw new Error(\n      `Invalid GeoJSON type '${type}': ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n}\n\n/**\n * Validates a GeoJSON geometry object\n */\nfunction validateGeometry(value: unknown): void {\n  if (value === null || typeof value !== \"object\") {\n    throw new Error(\"Geometry must be an object\");\n  }\n\n  const geometry = value as Record<string, unknown>;\n\n  if (!(\"type\" in geometry) || typeof geometry.type !== \"string\") {\n    throw new Error(\"Geometry must have a 'type' property of type string\");\n  }\n\n  const type = geometry.type;\n\n  // Validate GeometryCollection\n  if (type === \"GeometryCollection\") {\n    if (!(\"geometries\" in geometry) || !Array.isArray(geometry.geometries)) {\n      throw new Error(\n        \"GeometryCollection must have a 'geometries' property of type array\"\n      );\n    }\n\n    for (let i = 0; i < geometry.geometries.length; i++) {\n      try {\n        validateGeometry(geometry.geometries[i]);\n      } catch (error) {\n        throw new Error(\n          `GeometryCollection.geometries[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n        );\n      }\n    }\n\n    return;\n  }\n\n  // Validate coordinates-based geometries\n  const coordinateGeometries = [\n    \"Point\",\n    \"LineString\",\n    \"Polygon\",\n    \"MultiPoint\",\n    \"MultiLineString\",\n    \"MultiPolygon\",\n  ];\n\n  if (coordinateGeometries.includes(type)) {\n    if (!(\"coordinates\" in geometry)) {\n      throw new Error(`${type} must have a 'coordinates' property`);\n    }\n\n    validateCoordinates(geometry.coordinates, type);\n    return;\n  }\n\n  throw new Error(`Unknown geometry type: ${type}`);\n}\n\n/**\n * Validates coordinates based on geometry type\n */\nfunction validateCoordinates(coordinates: unknown, type: string): void {\n  if (!Array.isArray(coordinates)) {\n    throw new Error(\"Coordinates must be an array\");\n  }\n\n  switch (type) {\n    case \"Point\":\n      validatePosition(coordinates);\n      break;\n    case \"LineString\":\n      validateLineString(coordinates);\n      break;\n    case \"Polygon\":\n      validatePolygon(coordinates);\n      break;\n    case \"MultiPoint\":\n      validateMultiPoint(coordinates);\n      break;\n    case \"MultiLineString\":\n      validateMultiLineString(coordinates);\n      break;\n    case \"MultiPolygon\":\n      validateMultiPolygon(coordinates);\n      break;\n  }\n}\n\n/**\n * Validates a Position (longitude, latitude, optional elevation)\n */\nfunction validatePosition(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"Position must be an array\");\n  }\n\n  if (value.length < 2) {\n    throw new Error(\n      \"Position must have at least 2 elements (longitude, latitude)\"\n    );\n  }\n\n  if (typeof value[0] !== \"number\" || typeof value[1] !== \"number\") {\n    throw new Error(\"Position must have numbers for longitude and latitude\");\n  }\n\n  // Validate optional elevation\n  if (value.length > 2 && typeof value[2] !== \"number\") {\n    throw new Error(\n      \"Position elevation (3rd element) must be a number if present\"\n    );\n  }\n\n  // Validate longitude range\n  if (value[0] < -180 || value[0] > 180) {\n    throw new Error(\"Longitude must be between -180 and 180\");\n  }\n\n  // Validate latitude range\n  if (value[1] < -90 || value[1] > 90) {\n    throw new Error(\"Latitude must be between -90 and 90\");\n  }\n}\n\n/**\n * Validates a LineString (array of Positions)\n */\nfunction validateLineString(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"LineString must be an array\");\n  }\n\n  if (value.length < 2) {\n    throw new Error(\"LineString must have at least 2 positions\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePosition(value[i]);\n    } catch (error) {\n      throw new Error(\n        `LineString[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a Polygon (array of LinearRings, where first is exterior and rest are holes)\n */\nfunction validatePolygon(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"Polygon must be an array\");\n  }\n\n  if (value.length === 0) {\n    throw new Error(\"Polygon must have at least one LinearRing\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validateLinearRing(value[i]);\n    } catch (error) {\n      throw new Error(\n        `Polygon[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a LinearRing (closed LineString with at least 4 positions)\n */\nfunction validateLinearRing(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"LinearRing must be an array\");\n  }\n\n  if (value.length < 4) {\n    throw new Error(\"LinearRing must have at least 4 positions\");\n  }\n\n  // Validate all positions\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePosition(value[i]);\n    } catch (error) {\n      throw new Error(\n        `LinearRing[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n\n  // Check if ring is closed (first and last positions are the same)\n  const first = value[0] as number[];\n  const last = value[value.length - 1] as number[];\n  if (\n    first[0] !== last[0] ||\n    first[1] !== last[1] ||\n    (first.length > 2 && first[2] !== last[2])\n  ) {\n    throw new Error(\n      \"LinearRing must be closed (first and last positions must be equal)\"\n    );\n  }\n}\n\n/**\n * Validates a MultiPoint (array of Positions)\n */\nfunction validateMultiPoint(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"MultiPoint must be an array\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePosition(value[i]);\n    } catch (error) {\n      throw new Error(\n        `MultiPoint[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a MultiLineString (array of LineStrings)\n */\nfunction validateMultiLineString(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"MultiLineString must be an array\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validateLineString(value[i]);\n    } catch (error) {\n      throw new Error(\n        `MultiLineString[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n\n/**\n * Validates a MultiPolygon (array of Polygons)\n */\nfunction validateMultiPolygon(value: unknown): void {\n  if (!Array.isArray(value)) {\n    throw new Error(\"MultiPolygon must be an array\");\n  }\n\n  for (let i = 0; i < value.length; i++) {\n    try {\n      validatePolygon(value[i]);\n    } catch (error) {\n      throw new Error(\n        `MultiPolygon[${i}] is invalid: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n}\n","import type {\n  Feature,\n  FeatureCollection,\n  GeoJsonObject,\n  Geometry,\n  GeometryCollection,\n  LineString,\n  MultiLineString,\n  MultiPoint,\n  MultiPolygon,\n  Point,\n  Polygon,\n  Position,\n} from \"geojson\";\nimport {\n  area as turfArea,\n  bbox as turfBbox,\n  centerOfMass,\n  centroid as turfCentroid,\n  featureCollection,\n  length as turfLength,\n} from \"@turf/turf\";\n\nexport type Coordinates = {\n  lat: number;\n  lon: number;\n};\n\nexport type PolygonMetrics = {\n  areaSqMeters: number | null;\n  areaHectares: number | null;\n  centroid: Coordinates | null;\n  bbox: [number, number, number, number] | null;\n  message: string;\n};\n\nexport const HECTARES_PER_SQUARE_METER = 0.0001;\n\nconst isFeatureCollection = (\n  value: GeoJsonObject\n): value is FeatureCollection => value.type === \"FeatureCollection\";\n\nconst isFeature = (value: GeoJsonObject): value is Feature =>\n  value.type === \"Feature\";\n\nconst isGeometryCollection = (value: Geometry): value is GeometryCollection =>\n  value.type === \"GeometryCollection\";\n\nconst isPolygon = (value: Geometry): value is Polygon =>\n  value.type === \"Polygon\";\n\nconst isMultiPolygon = (value: Geometry): value is MultiPolygon =>\n  value.type === \"MultiPolygon\";\n\nconst isLineString = (value: Geometry): value is LineString =>\n  value.type === \"LineString\";\n\nconst isMultiLineString = (value: Geometry): value is MultiLineString =>\n  value.type === \"MultiLineString\";\n\nconst isPoint = (value: Geometry): value is Point => value.type === \"Point\";\n\nconst isMultiPoint = (value: Geometry): value is MultiPoint =>\n  value.type === \"MultiPoint\";\n\nconst isLineStringClosed = (lineString: LineString): boolean => {\n  const coords = lineString.coordinates;\n  if (coords.length < 4) return false; // Need at least 4 points for a closed ring\n\n  const first = coords[0];\n  const last = coords[coords.length - 1];\n\n  if (!first || !last || first.length < 2 || last.length < 2) return false;\n\n  const firstLon = first[0];\n  const firstLat = first[1];\n  const lastLon = last[0];\n  const lastLat = last[1];\n\n  if (\n    firstLon === undefined ||\n    firstLat === undefined ||\n    lastLon === undefined ||\n    lastLat === undefined\n  ) {\n    return false;\n  }\n\n  // Check if first and last points are the same (with small tolerance for floating point)\n  const tolerance = 1e-10;\n  return (\n    Math.abs(firstLon - lastLon) < tolerance &&\n    Math.abs(firstLat - lastLat) < tolerance\n  );\n};\n\nconst lineStringToPolygon = (lineString: LineString): Polygon | null => {\n  if (!isLineStringClosed(lineString)) return null;\n\n  // Convert closed LineString to Polygon\n  // A Polygon is an array of LinearRings, where the first is the exterior ring\n  return {\n    type: \"Polygon\",\n    coordinates: [lineString.coordinates],\n  };\n};\n\nconst toFeature = (geometry: Geometry): Feature<Geometry> => ({\n  type: \"Feature\",\n  geometry,\n  properties: {},\n});\n\nexport const extractPolygonFeatures = (\n  input: GeoJsonObject\n): Feature<Polygon | MultiPolygon>[] => {\n  if (isFeatureCollection(input)) {\n    return input.features.flatMap((feature) => extractPolygonFeatures(feature));\n  }\n\n  if (isFeature(input)) {\n    const geometry = input.geometry;\n    if (!geometry) return [];\n\n    if (isGeometryCollection(geometry)) {\n      return geometry.geometries.flatMap((subGeometry) =>\n        extractPolygonFeatures(toFeature(subGeometry))\n      );\n    }\n\n    if (isPolygon(geometry) || isMultiPolygon(geometry)) {\n      return [input as Feature<Polygon | MultiPolygon>];\n    }\n\n    return [];\n  }\n\n  const geometry = input as Geometry;\n\n  if (isGeometryCollection(geometry)) {\n    return geometry.geometries.flatMap((subGeometry) =>\n      extractPolygonFeatures(toFeature(subGeometry))\n    );\n  }\n\n  if (isPolygon(geometry) || isMultiPolygon(geometry)) {\n    return [toFeature(geometry) as Feature<Polygon | MultiPolygon>];\n  }\n\n  return [];\n};\n\nexport const extractLineStringFeatures = (\n  input: GeoJsonObject\n): Feature<LineString | MultiLineString>[] => {\n  if (isFeatureCollection(input)) {\n    return input.features.flatMap((feature) =>\n      extractLineStringFeatures(feature)\n    );\n  }\n\n  if (isFeature(input)) {\n    const geometry = input.geometry;\n    if (!geometry) return [];\n\n    if (isGeometryCollection(geometry)) {\n      return geometry.geometries.flatMap((subGeometry) =>\n        extractLineStringFeatures(toFeature(subGeometry))\n      );\n    }\n\n    if (isLineString(geometry) || isMultiLineString(geometry)) {\n      return [input as Feature<LineString | MultiLineString>];\n    }\n\n    return [];\n  }\n\n  const geometry = input as Geometry;\n\n  if (isGeometryCollection(geometry)) {\n    return geometry.geometries.flatMap((subGeometry) =>\n      extractLineStringFeatures(toFeature(subGeometry))\n    );\n  }\n\n  if (isLineString(geometry) || isMultiLineString(geometry)) {\n    return [toFeature(geometry) as Feature<LineString | MultiLineString>];\n  }\n\n  return [];\n};\n\nexport const extractPointFeatures = (\n  input: GeoJsonObject\n): Feature<Point | MultiPoint>[] => {\n  if (isFeatureCollection(input)) {\n    return input.features.flatMap((feature) => extractPointFeatures(feature));\n  }\n\n  if (isFeature(input)) {\n    const geometry = input.geometry;\n    if (!geometry) return [];\n\n    if (isGeometryCollection(geometry)) {\n      return geometry.geometries.flatMap((subGeometry) =>\n        extractPointFeatures(toFeature(subGeometry))\n      );\n    }\n\n    if (isPoint(geometry) || isMultiPoint(geometry)) {\n      return [input as Feature<Point | MultiPoint>];\n    }\n\n    return [];\n  }\n\n  const geometry = input as Geometry;\n\n  if (isGeometryCollection(geometry)) {\n    return geometry.geometries.flatMap((subGeometry) =>\n      extractPointFeatures(toFeature(subGeometry))\n    );\n  }\n\n  if (isPoint(geometry) || isMultiPoint(geometry)) {\n    return [toFeature(geometry) as Feature<Point | MultiPoint>];\n  }\n\n  return [];\n};\n\nconst computeCentroid = (\n  features: Feature<Polygon | MultiPolygon>[]\n): Position | null => {\n  if (features.length === 0) return null;\n\n  const collection = featureCollection(features);\n\n  try {\n    const { geometry } = centerOfMass(collection);\n    return geometry.coordinates;\n  } catch {\n    try {\n      const { geometry } = turfCentroid(collection);\n      return geometry.coordinates;\n    } catch {\n      return null;\n    }\n  }\n};\n\nconst computeCentroidForLineStrings = (\n  features: Feature<LineString | MultiLineString>[]\n): Position | null => {\n  if (features.length === 0) return null;\n\n  const collection = featureCollection(features);\n\n  try {\n    const { geometry } = centerOfMass(collection);\n    return geometry.coordinates;\n  } catch {\n    try {\n      const { geometry } = turfCentroid(collection);\n      return geometry.coordinates;\n    } catch {\n      return null;\n    }\n  }\n};\n\nconst computeCentroidForPoints = (\n  features: Feature<Point | MultiPoint>[]\n): Position | null => {\n  if (features.length === 0) return null;\n\n  const collection = featureCollection(features);\n\n  try {\n    const { geometry } = centerOfMass(collection);\n    return geometry.coordinates;\n  } catch {\n    try {\n      const { geometry } = turfCentroid(collection);\n      return geometry.coordinates;\n    } catch {\n      return null;\n    }\n  }\n};\n\nconst computeCentroidForMixed = (\n  features: Feature<Geometry>[]\n): Position | null => {\n  if (features.length === 0) return null;\n\n  const collection = featureCollection(features);\n\n  try {\n    const { geometry } = centerOfMass(collection);\n    return geometry.coordinates;\n  } catch {\n    try {\n      const { geometry } = turfCentroid(collection);\n      return geometry.coordinates;\n    } catch {\n      return null;\n    }\n  }\n};\n\nexport const computePolygonMetrics = (\n  geoJson: GeoJsonObject\n): PolygonMetrics => {\n  const polygonFeatures = extractPolygonFeatures(geoJson);\n  const lineStringFeatures = extractLineStringFeatures(geoJson);\n  const pointFeatures = extractPointFeatures(geoJson);\n\n  // Try to convert closed LineStrings to Polygons\n  const convertedPolygons: Feature<Polygon>[] = [];\n  for (const lineStringFeature of lineStringFeatures) {\n    if (lineStringFeature.geometry.type === \"LineString\") {\n      const polygon = lineStringToPolygon(lineStringFeature.geometry);\n      if (polygon) {\n        convertedPolygons.push({\n          type: \"Feature\",\n          geometry: polygon,\n          properties: lineStringFeature.properties,\n        });\n      }\n    } else if (lineStringFeature.geometry.type === \"MultiLineString\") {\n      // Handle MultiLineString - convert each closed LineString\n      for (const lineString of lineStringFeature.geometry.coordinates) {\n        const ls: LineString = { type: \"LineString\", coordinates: lineString };\n        const polygon = lineStringToPolygon(ls);\n        if (polygon) {\n          convertedPolygons.push({\n            type: \"Feature\",\n            geometry: polygon,\n            properties: lineStringFeature.properties,\n          });\n        }\n      }\n    }\n  }\n\n  // Combine original polygons with converted ones\n  const allPolygonFeatures = [...polygonFeatures, ...convertedPolygons];\n\n  // Handle Point geometries only\n  if (\n    pointFeatures.length > 0 &&\n    allPolygonFeatures.length === 0 &&\n    lineStringFeatures.length === 0\n  ) {\n    const centroidPosition = computeCentroidForPoints(pointFeatures);\n    const bbox = turfBbox(featureCollection(pointFeatures)) as [\n      number,\n      number,\n      number,\n      number\n    ];\n\n    let centroid: Coordinates | null = null;\n\n    if (\n      centroidPosition &&\n      centroidPosition[0] !== undefined &&\n      centroidPosition[1] !== undefined\n    ) {\n      const [lon, lat] = centroidPosition;\n      centroid = { lat, lon };\n    }\n\n    return {\n      areaSqMeters: null,\n      areaHectares: null,\n      centroid,\n      bbox,\n      message: centroid ? \"Success (Point)\" : \"Centroid calculation failed\",\n    };\n  }\n\n  // Handle LineString geometries (including closed ones that were converted)\n  if (lineStringFeatures.length > 0 && allPolygonFeatures.length === 0) {\n    const lengthMeters = lineStringFeatures.reduce(\n      (acc, feature) => acc + turfLength(feature, { units: \"meters\" }),\n      0\n    );\n\n    const centroidPosition = computeCentroidForLineStrings(lineStringFeatures);\n    const bbox = turfBbox(featureCollection(lineStringFeatures)) as [\n      number,\n      number,\n      number,\n      number\n    ];\n\n    let centroid: Coordinates | null = null;\n\n    if (\n      centroidPosition &&\n      centroidPosition[0] !== undefined &&\n      centroidPosition[1] !== undefined\n    ) {\n      const [lon, lat] = centroidPosition;\n      centroid = { lat, lon };\n    }\n\n    return {\n      areaSqMeters: null,\n      areaHectares: null,\n      centroid,\n      bbox,\n      message: centroid\n        ? \"Success (LineString)\"\n        : \"Centroid calculation failed\",\n    };\n  }\n\n  // Handle mixed geometries (Polygon, LineString, and/or Point)\n  const hasPolygons = allPolygonFeatures.length > 0;\n  const hasLineStrings = lineStringFeatures.length > 0;\n  const hasPoints = pointFeatures.length > 0;\n  const geometryTypeCount =\n    (hasPolygons ? 1 : 0) + (hasLineStrings ? 1 : 0) + (hasPoints ? 1 : 0);\n\n  if (geometryTypeCount > 1) {\n    const areaSqMeters = allPolygonFeatures.reduce(\n      (acc, feature) => acc + turfArea(feature),\n      0\n    );\n\n    const allFeatures = [\n      ...allPolygonFeatures,\n      ...lineStringFeatures,\n      ...pointFeatures,\n    ] as Feature<Geometry>[];\n\n    const centroidPosition = computeCentroidForMixed(allFeatures);\n    const bbox = turfBbox(featureCollection(allFeatures)) as [\n      number,\n      number,\n      number,\n      number\n    ];\n\n    let centroid: Coordinates | null = null;\n\n    if (\n      centroidPosition &&\n      centroidPosition[0] !== undefined &&\n      centroidPosition[1] !== undefined\n    ) {\n      const [lon, lat] = centroidPosition;\n      centroid = { lat, lon };\n    }\n\n    const typeLabels = [];\n    if (hasPolygons) typeLabels.push(\"Polygon\");\n    if (hasLineStrings) typeLabels.push(\"LineString\");\n    if (hasPoints) typeLabels.push(\"Point\");\n\n    return {\n      areaSqMeters,\n      areaHectares: areaSqMeters * HECTARES_PER_SQUARE_METER,\n      centroid,\n      bbox,\n      message: centroid\n        ? `Success (mixed: ${typeLabels.join(\", \")})`\n        : \"Centroid calculation failed\",\n    };\n  }\n\n  // Handle Polygon geometries only (including converted closed LineStrings)\n  if (\n    allPolygonFeatures.length === 0 &&\n    lineStringFeatures.length === 0 &&\n    pointFeatures.length === 0\n  ) {\n    return {\n      areaSqMeters: null,\n      areaHectares: null,\n      centroid: null,\n      bbox: null,\n      message: \"No polygons found\",\n    };\n  }\n\n  const areaSqMeters = allPolygonFeatures.reduce(\n    (acc, feature) => acc + turfArea(feature),\n    0\n  );\n\n  const centroidPosition = computeCentroid(allPolygonFeatures);\n  const bbox = turfBbox(featureCollection(allPolygonFeatures)) as [\n    number,\n    number,\n    number,\n    number\n  ];\n\n  let centroid: Coordinates | null = null;\n\n  if (\n    centroidPosition &&\n    centroidPosition[0] !== undefined &&\n    centroidPosition[1] !== undefined\n  ) {\n    const [lon, lat] = centroidPosition;\n    centroid = { lat, lon };\n  }\n\n  return {\n    areaSqMeters,\n    areaHectares: areaSqMeters * HECTARES_PER_SQUARE_METER,\n    centroid,\n    bbox,\n    message: centroid ? \"Success\" : \"Centroid calculation failed\",\n  };\n};\n\nexport const toFeatureCollection = (\n  geoJson: GeoJsonObject\n): FeatureCollection => {\n  if (isFeatureCollection(geoJson)) return geoJson;\n\n  if (isFeature(geoJson)) {\n    return featureCollection([geoJson]);\n  }\n\n  return featureCollection([toFeature(geoJson as Geometry)]);\n};\n","import type { GeoJsonObject } from \"geojson\";\nimport { TRPCError } from \"@trpc/server\";\nimport { validateGeojsonOrThrow } from \"@/_internal/lib/geojson/validate\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { computePolygonMetrics } from \"@/_internal/lib/geojson/computations\";\n\nexport async function fetchGeojsonFromUrl(url: string) {\n  const response = await fetch(url);\n  if (!response.ok) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to fetch site\",\n    });\n  }\n  const blob = await response.blob();\n  if (blob.type !== \"application/geo+json\") {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Site must be a GeoJSON file\",\n    });\n  }\n  const file = new File([blob], \"site.geojson\", {\n    type: blob.type,\n  });\n  return file;\n}\n\nexport async function processGeojsonFileOrThrow(file: File) {\n  if (file.type !== \"application/geo+json\") {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Site must be a GeoJSON file\",\n    });\n  }\n\n  const geojsonText = await file.text();\n  const geojson = JSON.parse(geojsonText);\n  const [validatedGeojsonObject, geojsonValidationError] = await tryCatch(\n    new Promise<GeoJsonObject>((r) => r(validateGeojsonOrThrow(geojson)))\n  );\n\n  if (geojsonValidationError) {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Invalid GeoJSON file: \" + geojsonValidationError.message,\n    });\n  }\n\n  const polygonMetrics = computePolygonMetrics(validatedGeojsonObject);\n  const lat = polygonMetrics.centroid?.lat;\n  const lon = polygonMetrics.centroid?.lon;\n  const area = polygonMetrics.areaHectares;\n  if (!lat || !lon || !area) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to process the geojson data.\",\n    });\n  }\n\n  return {\n    lat: lat.toFixed(6),\n    lon: lon.toFixed(6),\n    area: area.toFixed(2),\n  };\n}\n","import z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { AppCertifiedLocation } from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { createRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport { FileGeneratorSchema, toFile } from \"@/_internal/zod-schemas/file\";\nimport { processGeojsonFileOrThrow, fetchGeojsonFromUrl } from \"./utils\";\nimport type { Agent } from \"@atproto/api\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.certified.location\" as const;\nconst RESOURCE_NAME = \"location\" as const;\nconst MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB\n\n/**\n * Input schema for location creation\n */\nexport const LocationInputSchema = z.object({\n  name: z.string().min(1, \"Location name is required\"),\n});\n\nexport type LocationInput = z.infer<typeof LocationInputSchema>;\n\n/**\n * Upload schema for location creation\n */\nexport const LocationUploadsSchema = z.object({\n  shapefile: z.union([z.string().url(), FileGeneratorSchema]),\n});\n\nexport type LocationUploads = z.infer<typeof LocationUploadsSchema>;\n\n/**\n * Pure function to create a location.\n * Can be reused outside of tRPC context.\n */\nexport const createLocationPure = async (\n  agent: Agent,\n  locationInput: LocationInput,\n  uploads: LocationUploads,\n  rkey?: string\n): Promise<PutRecordResponse<AppCertifiedLocation.Record>> => {\n  const did = agent.did;\n  if (!did) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized to perform this action.\",\n    });\n  }\n\n  // Fetch or convert the shapefile\n  const file =\n    typeof uploads.shapefile === \"string\"\n      ? await fetchGeojsonFromUrl(uploads.shapefile)\n      : await toFile(uploads.shapefile);\n\n  // Validate file size\n  if (file.size > MAX_FILE_SIZE) {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"The GeoJSON file is too large. It must be less than 10MB.\",\n    });\n  }\n\n  // Process and validate the GeoJSON file\n  await processGeojsonFileOrThrow(file);\n\n  // Upload the blob\n  const [uploadResponse, uploadError] = await tryCatch(agent.uploadBlob(file));\n  if (uploadError !== null || uploadResponse === null) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to upload the GeoJSON file.\",\n      cause: uploadError,\n    });\n  }\n\n  const location: AppCertifiedLocation.Record = {\n    $type: COLLECTION,\n    name: locationInput.name,\n    lpVersion: \"1.0.0\",\n    srs: \"https://epsg.io/3857\",\n    locationType: \"geojson-point\",\n    location: {\n      $type: \"org.hypercerts.defs#smallBlob\",\n      blob: uploadResponse.data.blob,\n    },\n    createdAt: new Date().toISOString(),\n  };\n\n  return createRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    record: location,\n    validator: AppCertifiedLocation,\n    resourceName: RESOURCE_NAME,\n    rkey,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for creating a location.\n */\nexport const createLocationFactory = createMutationFactory(\n  {\n    site: LocationInputSchema,\n    uploads: LocationUploadsSchema,\n    rkey: z.string().optional(),\n  },\n  (agent, input) => createLocationPure(agent, input.site, input.uploads, input.rkey)\n);\n","import z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { AppCertifiedLocation } from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { putRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport {\n  BlobRefGeneratorSchema,\n  toBlobRef,\n} from \"@/_internal/zod-schemas/blobref\";\nimport { FileGeneratorSchema, toFile } from \"@/_internal/zod-schemas/file\";\nimport { processGeojsonFileOrThrow } from \"./utils\";\nimport type { Agent } from \"@atproto/api\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.certified.location\" as const;\nconst RESOURCE_NAME = \"location\" as const;\n\n/**\n * Input schema for location update\n */\nexport const LocationUpdateInputSchema = z.object({\n  name: z.string().min(1, \"Location name is required\"),\n  shapefile: z\n    .object({\n      $type: z.literal(\"app.gainforest.common.defs#smallBlob\"),\n      blob: BlobRefGeneratorSchema,\n    })\n    .optional(),\n});\n\nexport type LocationUpdateInput = z.infer<typeof LocationUpdateInputSchema>;\n\n/**\n * Upload schema for location update\n */\nexport const LocationUpdateUploadsSchema = z\n  .object({\n    shapefile: FileGeneratorSchema.optional(),\n  })\n  .optional();\n\nexport type LocationUpdateUploads = z.infer<typeof LocationUpdateUploadsSchema>;\n\n/**\n * Pure function to update a location.\n * Can be reused outside of tRPC context.\n */\nexport const updateLocationPure = async (\n  agent: Agent,\n  rkey: string,\n  locationInput: LocationUpdateInput,\n  uploads?: LocationUpdateUploads\n): Promise<PutRecordResponse<AppCertifiedLocation.Record>> => {\n  const did = agent.did;\n  if (!did) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized to perform this action.\",\n    });\n  }\n\n  // Determine the shapefile blob\n  let shapefileBlob: AppCertifiedLocation.Record[\"location\"];\n\n  if (uploads?.shapefile) {\n    // New file uploaded - process and upload it\n    const file = await toFile(uploads.shapefile);\n    await processGeojsonFileOrThrow(file);\n\n    const [uploadResponse, uploadError] = await tryCatch(agent.uploadBlob(file));\n    if (uploadError !== null || uploadResponse === null) {\n      throw new TRPCError({\n        code: \"INTERNAL_SERVER_ERROR\",\n        message: \"Failed to upload the GeoJSON file.\",\n        cause: uploadError,\n      });\n    }\n\n    shapefileBlob = {\n      $type: \"org.hypercerts.defs#smallBlob\",\n      blob: uploadResponse.data.blob,\n    };\n  } else if (locationInput.shapefile) {\n    // Use existing blob reference\n    shapefileBlob = {\n      $type: \"org.hypercerts.defs#smallBlob\",\n      blob: toBlobRef(locationInput.shapefile.blob),\n    };\n  } else {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"A shapefile is required. Provide either a new file or an existing blob reference.\",\n    });\n  }\n\n  const location: AppCertifiedLocation.Record = {\n    $type: COLLECTION,\n    name: locationInput.name,\n    lpVersion: \"1.0.0\",\n    srs: \"https://epsg.io/3857\",\n    locationType: \"geojson-point\",\n    location: shapefileBlob,\n    createdAt: new Date().toISOString(),\n  };\n\n  return putRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey,\n    record: location,\n    validator: AppCertifiedLocation,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for updating a location.\n */\nexport const updateLocationFactory = createMutationFactory(\n  {\n    rkey: z.string(),\n    site: LocationUpdateInputSchema,\n    uploads: LocationUpdateUploadsSchema,\n  },\n  (agent, input) => updateLocationPure(agent, input.rkey, input.site, input.uploads)\n);\n","import z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport {\n  AppGainforestOrganizationDefaultSite,\n  AppCertifiedLocation,\n} from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { putRecord, getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport type { Agent } from \"@atproto/api\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst LOCATION_COLLECTION = \"app.certified.location\" as const;\nconst DEFAULT_SITE_COLLECTION = \"app.gainforest.organization.defaultSite\" as const;\n\n/**\n * Pure function to set the default location.\n * Can be reused outside of tRPC context.\n */\nexport const setDefaultLocationPure = async (\n  agent: Agent,\n  locationAtUri: string\n): Promise<PutRecordResponse<AppGainforestOrganizationDefaultSite.Record>> => {\n  const did = agent.did;\n  if (!did) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized to perform this action.\",\n    });\n  }\n\n  // Validate URI format\n  if (!(locationAtUri.startsWith(\"at://\") && locationAtUri.includes(LOCATION_COLLECTION))) {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Invalid location URI format.\",\n    });\n  }\n\n  // Verify the location exists\n  const [, locationError] = await tryCatch(\n    getRecord({\n      agent,\n      collection: LOCATION_COLLECTION,\n      repo: did,\n      rkey: parseAtUri(locationAtUri).rkey,\n      validator: AppCertifiedLocation,\n      resourceName: \"location\",\n    })\n  );\n\n  if (locationError !== null) {\n    throw new TRPCError({\n      code: \"NOT_FOUND\",\n      message: \"The specified location was not found.\",\n      cause: locationError,\n    });\n  }\n\n  // Create the default site record\n  const defaultSite: AppGainforestOrganizationDefaultSite.Record = {\n    $type: DEFAULT_SITE_COLLECTION,\n    site: locationAtUri,\n    createdAt: new Date().toISOString(),\n  };\n\n  return putRecord({\n    agent,\n    collection: DEFAULT_SITE_COLLECTION,\n    repo: did,\n    rkey: \"self\",\n    record: defaultSite,\n    validator: AppGainforestOrganizationDefaultSite,\n    resourceName: \"default location\",\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for setting the default location.\n */\nexport const setDefaultLocationFactory = createMutationFactory(\n  {\n    locationAtUri: z.string(),\n  },\n  (agent, input) => setDefaultLocationPure(agent, input.locationAtUri)\n);\n","import z from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { AppGainforestOrganizationDefaultSite, AppCertifiedLocation } from \"@/../lex-api\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { deleteRecord, getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createMutationFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport type { Agent } from \"@atproto/api\";\nimport type { DeleteRecordResponse } from \"@/_internal/server/utils/atproto-crud\";\n\nconst LOCATION_COLLECTION = \"app.certified.location\" as const;\nconst DEFAULT_SITE_COLLECTION = \"app.gainforest.organization.defaultSite\" as const;\n\n/**\n * Pure function to delete a location.\n * Can be reused outside of tRPC context.\n */\nexport const deleteLocationPure = async (\n  agent: Agent,\n  locationAtUri: string\n): Promise<DeleteRecordResponse> => {\n  const did = agent.did;\n  if (!did) {\n    throw new TRPCError({\n      code: \"UNAUTHORIZED\",\n      message: \"You are not authorized to perform this action.\",\n    });\n  }\n\n  // Check if this is the default location\n  const [defaultSiteResult] = await tryCatch(\n    getRecord({\n      agent,\n      collection: DEFAULT_SITE_COLLECTION,\n      repo: did,\n      rkey: \"self\",\n      validator: AppGainforestOrganizationDefaultSite,\n      resourceName: \"default location\",\n    })\n  );\n\n  if (defaultSiteResult?.value.site === locationAtUri) {\n    throw new TRPCError({\n      code: \"BAD_REQUEST\",\n      message: \"Cannot delete the default location. Please set a different default first.\",\n    });\n  }\n\n  const rkey = parseAtUri(locationAtUri).rkey;\n\n  return deleteRecord({\n    agent,\n    collection: LOCATION_COLLECTION,\n    repo: did,\n    rkey,\n    resourceName: \"location\",\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for deleting a location.\n */\nexport const deleteLocationFactory = createMutationFactory(\n  {\n    locationAtUri: z.string(),\n  },\n  (agent, input) => deleteLocationPure(agent, input.locationAtUri)\n);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimActivity } from \"@/../lex-api\";\nimport { listRecords } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"org.hypercerts.claim.activity\" as const;\nconst RESOURCE_NAME = \"claim activities\" as const;\n\n/**\n * Response type for getAllClaimActivities\n */\nexport type GetAllClaimActivitiesResponse = {\n  activities: GetRecordResponse<OrgHypercertsClaimActivity.Record>[];\n};\n\n/**\n * Pure function to get all claim activities for a DID.\n * Can be reused outside of tRPC context.\n */\nexport const getAllClaimActivitiesPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetAllClaimActivitiesResponse> => {\n  const agent = getReadAgent(pdsDomain);\n  const result = await listRecords({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    validator: OrgHypercertsClaimActivity,\n    resourceName: RESOURCE_NAME,\n    skipInvalid: true,\n  });\n\n  return {\n    activities: result.records,\n  };\n};\n\n/**\n * Factory to create the tRPC procedure for getting all claim activities.\n */\nexport const getAllClaimActivitiesFactory = createDidQueryFactory(getAllClaimActivitiesPure);\n","import { tryCatch } from \"@/_internal/lib/tryCatch\";\nimport { publicProcedure } from \"@/_internal/server/trpc\";\nimport { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { z } from \"zod\";\nimport { TRPCError } from \"@trpc/server\";\nimport { getOrganizationInfoPure } from \"../../../gainforest/organization/info/get\";\nimport { getAllClaimActivitiesPure } from \"./getAll\";\nimport {\n  AppGainforestOrganizationInfo,\n  OrgHypercertsClaimActivity,\n} from \"@/../lex-api\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\n\n/**\n * Organization with its activities\n */\nexport type OrganizationWithActivities = {\n  repo: {\n    did: string;\n  };\n  organizationInfo: AppGainforestOrganizationInfo.Record;\n  activities: GetRecordResponse<OrgHypercertsClaimActivity.Record>[];\n};\n\n/**\n * Pure function to get all claim activities across all organizations.\n * Can be reused outside of tRPC context.\n */\nexport const getAllClaimActivitiesAcrossOrganizationsPure = async <\n  T extends SupportedPDSDomain,\n>(\n  pdsDomain: T\n): Promise<OrganizationWithActivities[]> => {\n  const agent = getReadAgent(pdsDomain);\n\n  // Get all repositories\n  const [repositoriesListResponse, repositoriesListFetchError] = await tryCatch(\n    agent.com.atproto.sync.listRepos({\n      limit: 150,\n    })\n  );\n\n  if (\n    repositoriesListFetchError !== null ||\n    repositoriesListResponse === null ||\n    repositoriesListResponse.success !== true\n  ) {\n    throw new TRPCError({\n      code: \"INTERNAL_SERVER_ERROR\",\n      message: \"Failed to fetch the list of repositories.\",\n      cause: repositoriesListFetchError,\n    });\n  }\n\n  const repositoriesList = repositoriesListResponse.data.repos;\n\n  // Filter repositories that are organizations (have organization info)\n  const organizationResults = await Promise.all(\n    repositoriesList.map(async (repo) => {\n      const [organizationInfoResponse] = await tryCatch(\n        getOrganizationInfoPure(repo.did, pdsDomain)\n      );\n      if (!organizationInfoResponse) {\n        return null;\n      }\n      return {\n        repo: { did: repo.did },\n        organizationInfo: organizationInfoResponse.value,\n      };\n    })\n  );\n\n  const validOrganizations = organizationResults.filter(\n    (org): org is NonNullable<typeof org> => org !== null\n  );\n\n  // Get activities for each organization\n  const activitiesResults = await Promise.all(\n    validOrganizations.map(async (organization) => {\n      const [activitiesResponse] = await tryCatch(\n        getAllClaimActivitiesPure(organization.repo.did, pdsDomain)\n      );\n      if (!activitiesResponse) {\n        return null;\n      }\n      return {\n        repo: organization.repo,\n        activities: activitiesResponse.activities,\n        organizationInfo: organization.organizationInfo,\n      };\n    })\n  );\n\n  return activitiesResults.filter(\n    (activity): activity is NonNullable<typeof activity> => activity !== null\n  );\n};\n\n/**\n * Factory to create the tRPC procedure for getting all claim activities across organizations.\n */\nexport const getAllClaimActivitiesAcrossOrganizationsFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return publicProcedure\n    .input(z.object({ pdsDomain: allowedPDSDomainSchema }))\n    .query(async ({ input }) => {\n      return getAllClaimActivitiesAcrossOrganizationsPure(input.pdsDomain);\n    });\n};\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimActivity } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidRkeyQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"org.hypercerts.claim.activity\" as const;\nconst RESOURCE_NAME = \"claim activity\" as const;\n\n/**\n * Pure function to get a claim activity by DID and rkey.\n * Can be reused outside of tRPC context.\n */\nexport const getClaimActivityPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  rkey: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<OrgHypercertsClaimActivity.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey,\n    validator: OrgHypercertsClaimActivity,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting a claim activity.\n */\nexport const getClaimActivityFactory = createDidRkeyQueryFactory(getClaimActivityPure);\n\n// Backwards compatibility alias (typo in original name)\nexport const getCliamActivityFactory = getClaimActivityFactory;\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\n\nexport const addMeasuredTreesClusterToProjectFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        measuredTreesClusterUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Check if the measured trees clusters are owned by the user\n      const ownedClusterUris = input.measuredTreesClusterUris.filter((uri) =>\n        checkOwnershipByAtUri(uri, input.did)\n      );\n      if (ownedClusterUris.length !== input.measuredTreesClusterUris.length) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            ownedClusterUris.length === 1 ?\n              \"The measured trees cluster you are trying to add is not owned by you\"\n            : \"The measured trees clusters you are trying to add are not owned by you\",\n        });\n      }\n\n      // Check if the measured trees clusters exist\n      const clusterExistencePromise = Promise.all(\n        input.measuredTreesClusterUris.map(async (uri) => {\n          const { did, collection, rkey } = parseAtUri(uri);\n          const response = await readAgent.com.atproto.repo.getRecord({\n            collection: collection,\n            repo: did,\n            rkey: rkey,\n          });\n          return response.success === true;\n        })\n      );\n      const [clusterExistence, clusterExistenceCheckError] = await tryCatch(\n        clusterExistencePromise\n      );\n      if (clusterExistenceCheckError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message:\n            \"Failed to check the existence of the measured trees clusters\",\n        });\n      }\n\n      if (!clusterExistence.every(Boolean)) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            clusterExistence.length === 1 ?\n              \"The measured trees cluster you are trying to add does not exist\"\n            : \"The measured trees clusters you are trying to add do not exist\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      console.log(\" THIS ENDPOINT IS NOT IMPLEMENTED YET \");\n      return true;\n\n      //   const validatedProject =\n      //     validateRecordOrThrow<OrgHypercertsClaimProject.Record>(\n      //       getResponse.data.value,\n      //       OrgHypercertsClaimProject\n      //     );\n\n      //   // Add new measuredTreesCluster URIs, avoiding duplicates\n      //   const existingClusters = new Set(validatedProject.measuredTreesClusters);\n      //   const newClusters = input.measuredTreesClusterUris.filter(\n      //     (uri) => !existingClusters.has(uri)\n      //   );\n      //   const updatedClusters = [\n      //     ...validatedProject.measuredTreesClusters,\n      //     ...newClusters,\n      //   ];\n\n      //   // Create updated project record\n      //   const updatedProject: OrgHypercertsClaimProject.Record = {\n      //     ...validatedProject,\n      //     measuredTreesClusters: updatedClusters,\n      //   };\n\n      //   const ownershipCheckedProject = filterProjectByOwnership(\n      //     updatedProject,\n      //     input.did\n      //   );\n\n      //   validateRecordOrThrow(\n      //     ownershipCheckedProject,\n      //     OrgHypercertsClaimProject\n      //   );\n\n      //   // Update the project\n      //   const putResponse = await writeAgent.com.atproto.repo.putRecord({\n      //     repo: input.did,\n      //     collection: \"app.gainforest.organization.project\",\n      //     record: ownershipCheckedProject,\n      //     rkey: input.projectRkey,\n      //   });\n\n      //   if (putResponse.success !== true) {\n      //     throw new TRPCError({\n      //       code: \"INTERNAL_SERVER_ERROR\",\n      //       message: \"Failed to add measured trees clusters to project\",\n      //     });\n      //   }\n\n      //   return {\n      //     uri: putResponse.data.uri,\n      //     cid: putResponse.data.cid,\n      //     validationStatus: putResponse.data.validationStatus,\n      //     value: ownershipCheckedProject,\n      //   } satisfies PutRecordResponse<OrgHypercertsClaimProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const removeMeasuredTreesClusterFromProjectFactory = <\n  T extends SupportedPDSDomain,\n>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        measuredTreesClusterUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      console.log(\" THIS ENDPOINT IS NOT IMPLEMENTED YET \");\n      return true;\n\n      // const validatedProject =\n      //   validateRecordOrThrow<OrgHypercertsClaimProject.Record>(\n      //     getResponse.data.value,\n      //     OrgHypercertsClaimProject\n      //   );\n\n      // // Remove measuredTreesCluster URIs\n      // const clustersToRemove = new Set(input.measuredTreesClusterUris);\n      // const updatedClusters = validatedProject.measuredTreesClusters.filter(\n      //   (uri) => !clustersToRemove.has(uri)\n      // );\n\n      // // Create updated project record\n      // const updatedProject: OrgHypercertsClaimProject.Record = {\n      //   ...validatedProject,\n      //   measuredTreesClusters: updatedClusters,\n      // };\n\n      // const ownershipCheckedProject = filterProjectByOwnership(\n      //   updatedProject,\n      //   input.did\n      // );\n\n      // validateRecordOrThrow(\n      //   ownershipCheckedProject,\n      //   OrgHypercertsClaimProject\n      // );\n\n      // // Update the project\n      // const putResponse = await writeAgent.com.atproto.repo.putRecord({\n      //   repo: input.did,\n      //   collection: \"app.gainforest.organization.project\",\n      //   record: ownershipCheckedProject,\n      //   rkey: input.projectRkey,\n      // });\n\n      // if (putResponse.success !== true) {\n      //   throw new TRPCError({\n      //     code: \"INTERNAL_SERVER_ERROR\",\n      //     message: \"Failed to remove measured trees clusters from project\",\n      //   });\n      // }\n\n      // return {\n      //   uri: putResponse.data.uri,\n      //   cid: putResponse.data.cid,\n      //   validationStatus: putResponse.data.validationStatus,\n      //   value: ownershipCheckedProject,\n      // } satisfies PutRecordResponse<OrgHypercertsClaimProject.Record>;\n    });\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\nimport { checkOwnershipByAtUri } from \"@/_internal/server/utils/ownership\";\nimport { parseAtUri } from \"@/_internal/utilities/atproto\";\nimport { tryCatch } from \"@/_internal/lib/tryCatch\";\n\nexport const addLayersToProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        layerUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Check if the layers are owned by the user\n      const ownedLayerUris = input.layerUris.filter((uri) =>\n        checkOwnershipByAtUri(uri, input.did)\n      );\n      if (ownedLayerUris.length !== input.layerUris.length) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            ownedLayerUris.length === 1 ?\n              \"The layer you are trying to add is not owned by you\"\n            : \"The layers you are trying to add are not owned by you\",\n        });\n      }\n\n      // Check if the layers exist\n      const layerExistencePromise = Promise.all(\n        input.layerUris.map(async (uri) => {\n          const { did, collection, rkey } = parseAtUri(uri);\n          const response = await readAgent.com.atproto.repo.getRecord({\n            collection: collection,\n            repo: did,\n            rkey: rkey,\n          });\n          return response.success === true;\n        })\n      );\n      const [layerExistence, layerExistenceCheckError] = await tryCatch(\n        layerExistencePromise\n      );\n      if (layerExistenceCheckError) {\n        throw new TRPCError({\n          code: \"INTERNAL_SERVER_ERROR\",\n          message: \"Failed to check the existence of the layers\",\n        });\n      }\n\n      if (!layerExistence.every(Boolean)) {\n        throw new TRPCError({\n          code: \"BAD_REQUEST\",\n          message:\n            layerExistence.length === 1 ?\n              \"The layer you are trying to add does not exist\"\n            : \"The layers you are trying to add do not exist\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      console.log(\" THIS ENDPOINT IS NOT IMPLEMENTED YET \");\n      return true;\n\n      // const validatedProject =\n      //     validateRecordOrThrow<OrgHypercertsClaimProject.Record>(\n      //     getResponse.data.value,\n      //     OrgHypercertsClaimProject\n      //   );\n\n      // Add new layer URIs, avoiding duplicates\n      // const existingLayers = new Set(validatedProject.layers);\n      // const newLayers = input.layerUris.filter(\n      //   (uri) => !existingLayers.has(uri)\n      // );\n      // const updatedLayers = [...validatedProject.layers, ...newLayers];\n\n      // // Create updated project record\n      // const updatedProject: AppGainforestOrganizationProject.Record = {\n      //   ...validatedProject,\n      //   layers: updatedLayers,\n      // };\n\n      // const ownershipCheckedProject = filterProjectByOwnership(\n      //   updatedProject,\n      //   input.did\n      // );\n\n      // validateRecordOrThrow(\n      //   ownershipCheckedProject,\n      //   AppGainforestOrganizationProject\n      // );\n\n      // // Update the project\n      // const putResponse = await writeAgent.com.atproto.repo.putRecord({\n      //   repo: input.did,\n      //   collection: \"app.gainforest.organization.project\",\n      //   record: ownershipCheckedProject,\n      //   rkey: input.projectRkey,\n      // });\n\n      // if (putResponse.success !== true) {\n      //   throw new TRPCError({\n      //     code: \"INTERNAL_SERVER_ERROR\",\n      //     message: \"Failed to add layers to project\",\n      //   });\n      // }\n\n      // return {\n      //   uri: putResponse.data.uri,\n      //   cid: putResponse.data.cid,\n      //   validationStatus: putResponse.data.validationStatus,\n      //   value: ownershipCheckedProject,\n      // } satisfies PutRecordResponse<AppGainforestOrganizationProject.Record>;\n    });\n};\n","import type { ValidationResult } from \"@atproto/lexicon\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const validateRecordOrThrow = <T>(\n  record: unknown,\n  {\n    validateRecord,\n  }: { validateRecord: (record: unknown) => ValidationResult<T> }\n) => {\n  let validationResponse;\n  try {\n    validationResponse = validateRecord(record);\n  } catch (error) {\n    throw new TRPCError({\n      code: \"UNPROCESSABLE_CONTENT\",\n      message: \"Invalid record\",\n      cause: error,\n    });\n  }\n  if (!validationResponse.success) {\n    throw new TRPCError({\n      code: \"UNPROCESSABLE_CONTENT\",\n      message: validationResponse.error.message,\n      cause: validationResponse.error,\n    });\n  }\n  return validationResponse.value;\n};\n","import { protectedProcedure } from \"@/_internal/server/trpc\";\nimport { z } from \"zod\";\nimport { getWriteAgent, getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimProject } from \"@/../lex-api\";\nimport { validateRecordOrThrow } from \"@/_internal/server/utils/validate-record-or-throw\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { PutRecordResponse } from \"@/_internal/server/utils/response-types\";\nimport { TRPCError } from \"@trpc/server\";\n\nexport const removeLayersFromProjectFactory = <T extends SupportedPDSDomain>(\n  allowedPDSDomainSchema: z.ZodEnum<Record<T, T>>\n) => {\n  return protectedProcedure\n    .input(\n      z.object({\n        did: z.string(),\n        projectRkey: z.string(),\n        layerUris: z.array(z.string()).min(1),\n        pdsDomain: allowedPDSDomainSchema,\n      })\n    )\n    .mutation(async ({ input }) => {\n      const readAgent = getReadAgent(input.pdsDomain);\n      const writeAgent = await getWriteAgent(input.pdsDomain);\n\n      if (!writeAgent.did) {\n        throw new TRPCError({\n          code: \"UNAUTHORIZED\",\n          message: \"You are not authenticated\",\n        });\n      }\n\n      // Get the current project\n      const getResponse = await readAgent.com.atproto.repo.getRecord({\n        collection: \"app.gainforest.organization.project\",\n        repo: input.did,\n        rkey: input.projectRkey,\n      });\n\n      if (getResponse.success !== true) {\n        throw new TRPCError({\n          code: \"NOT_FOUND\",\n          message: \"Project not found\",\n        });\n      }\n\n      const validatedProject =\n        validateRecordOrThrow<OrgHypercertsClaimProject.Record>(\n          getResponse.data.value,\n          OrgHypercertsClaimProject\n        );\n\n      console.log(\" THIS ENDPOINT IS NOT IMPLEMENTED YET \");\n      return true;\n\n      // // Remove layer URIs\n      // const layersToRemove = new Set(input.layerUris);\n      // const updatedLayers = validatedProject.layers.filter(\n      //   (uri) => !layersToRemove.has(uri)\n      // );\n\n      // // Create updated project record\n      // const updatedProject: OrgHypercertsClaimProject.Record = {\n      //   ...validatedProject,\n      //   layers: updatedLayers,\n      // };\n\n      // const ownershipCheckedProject = filterProjectByOwnership(\n      //   updatedProject,\n      //   input.did\n      // );\n\n      // validateRecordOrThrow(\n      //   ownershipCheckedProject,\n      //   OrgHypercertsClaimProject\n      // );\n\n      // // Update the project\n      // const putResponse = await writeAgent.com.atproto.repo.putRecord({\n      //   repo: input.did,\n      //   collection: \"app.gainforest.organization.project\",\n      //   record: ownershipCheckedProject,\n      //   rkey: input.projectRkey,\n      // });\n\n      // if (putResponse.success !== true) {\n      //   throw new TRPCError({\n      //     code: \"INTERNAL_SERVER_ERROR\",\n      //     message: \"Failed to remove layers from project\",\n      //   });\n      // }\n\n      // return {\n      //   uri: putResponse.data.uri,\n      //   cid: putResponse.data.cid,\n      //   validationStatus: putResponse.data.validationStatus,\n      //   value: ownershipCheckedProject,\n      // } satisfies PutRecordResponse<OrgHypercertsClaimProject.Record>;\n    });\n};\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationLayer } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidRkeyQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.gainforest.organization.layer\" as const;\nconst RESOURCE_NAME = \"layer\" as const;\n\n/**\n * Pure function to get a layer by DID and rkey.\n * Can be reused outside of tRPC context.\n */\nexport const getLayerPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  rkey: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<AppGainforestOrganizationLayer.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey,\n    validator: AppGainforestOrganizationLayer,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting a layer.\n */\nexport const getLayerFactory = createDidRkeyQueryFactory(getLayerPure);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimProject } from \"@/../lex-api\";\nimport { getRecord } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidRkeyQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"org.hypercerts.claim.project\" as const;\nconst RESOURCE_NAME = \"project\" as const;\n\n/**\n * Pure function to get a project by DID and rkey.\n * Can be reused outside of tRPC context.\n */\nexport const getProjectPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  rkey: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<OrgHypercertsClaimProject.Record>> => {\n  const agent = getReadAgent(pdsDomain);\n  return getRecord({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    rkey,\n    validator: OrgHypercertsClaimProject,\n    resourceName: RESOURCE_NAME,\n  });\n};\n\n/**\n * Factory to create the tRPC procedure for getting a project.\n */\nexport const getProjectFactory = createDidRkeyQueryFactory(getProjectPure);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { OrgHypercertsClaimProject } from \"@/../lex-api\";\nimport { listRecords } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"org.hypercerts.claim.project\" as const;\nconst RESOURCE_NAME = \"projects\" as const;\n\n/**\n * Pure function to get all projects for a DID.\n * Can be reused outside of tRPC context.\n */\nexport const getAllProjectsPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<OrgHypercertsClaimProject.Record>[]> => {\n  const agent = getReadAgent(pdsDomain);\n  const result = await listRecords({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    validator: OrgHypercertsClaimProject,\n    resourceName: RESOURCE_NAME,\n    skipInvalid: true,\n  });\n  return result.records;\n};\n\n/**\n * Factory to create the tRPC procedure for getting all projects.\n */\nexport const getAllProjectsFactory = createDidQueryFactory(getAllProjectsPure);\n","import { getReadAgent } from \"@/_internal/server/utils/agent\";\nimport { AppGainforestOrganizationLayer } from \"@/../lex-api\";\nimport { listRecords } from \"@/_internal/server/utils/atproto-crud\";\nimport { createDidQueryFactory } from \"@/_internal/server/utils/procedure-factories\";\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport type { GetRecordResponse } from \"@/_internal/server/utils/response-types\";\n\nconst COLLECTION = \"app.gainforest.organization.layer\" as const;\nconst RESOURCE_NAME = \"layers\" as const;\n\n/**\n * Pure function to get all layers for a DID.\n * Can be reused outside of tRPC context.\n */\nexport const getAllLayersPure = async <T extends SupportedPDSDomain>(\n  did: string,\n  pdsDomain: T\n): Promise<GetRecordResponse<AppGainforestOrganizationLayer.Record>[]> => {\n  const agent = getReadAgent(pdsDomain);\n  const result = await listRecords({\n    agent,\n    collection: COLLECTION,\n    repo: did,\n    validator: AppGainforestOrganizationLayer,\n    resourceName: RESOURCE_NAME,\n    skipInvalid: true,\n  });\n  return result.records;\n};\n\n/**\n * Factory to create the tRPC procedure for getting all layers.\n */\nexport const getAllLayersFactory = createDidQueryFactory(getAllLayersPure);\n","import { createContext, createTRPCRouter, publicProcedure } from \"../trpc\";\nimport { uploadFileAsBlobFactory } from \"./atproto/common/uploadFileAsBlob\";\nimport { loginFactory } from \"./atproto/auth/login\";\nimport { resumeFactory } from \"./atproto/auth/resume\";\nimport { logoutFactory } from \"./atproto/auth/logout\";\nimport { getOrganizationInfoFactory } from \"./atproto/gainforest/organization/info/get\";\nimport { getLocationFactory } from \"./atproto/hypercerts/location/get\";\nimport { getDefaultLocationFactory } from \"./atproto/hypercerts/location/getDefault\";\nimport { getMeasuredTreesFactory } from \"./atproto/gainforest/organization/observations/measuredTreesCluster/get\";\nimport { createClaimActivityFactory } from \"./atproto/hypercerts/claim/activity/create\";\nimport { createOrUpdateOrganizationInfoFactory } from \"./atproto/gainforest/organization/info/createOrUpdate\";\nimport { createOrUpdateLayerFactory } from \"./atproto/gainforest/organization/layer/createOrUpdate\";\nimport { getAllLocationsFactory } from \"./atproto/hypercerts/location/getAll\";\nimport { createLocationFactory } from \"./atproto/hypercerts/location/create\";\nimport { updateLocationFactory } from \"./atproto/hypercerts/location/update\";\nimport { setDefaultLocationFactory } from \"./atproto/hypercerts/location/setDefault\";\nimport { deleteLocationFactory } from \"./atproto/hypercerts/location/delete\";\nimport { getAllClaimActivitiesAcrossOrganizationsFactory } from \"./atproto/hypercerts/claim/activity/getAllAcrossOrgs\";\nimport { getCliamActivityFactory } from \"./atproto/hypercerts/claim/activity/get\";\nimport { addMeasuredTreesClusterToProjectFactory } from \"./atproto/gainforest/organization/observations/measuredTreesCluster/_addToProject\";\nimport { removeMeasuredTreesClusterFromProjectFactory } from \"./atproto/gainforest/organization/observations/measuredTreesCluster/_removeFromProject\";\nimport { addLayersToProjectFactory } from \"./atproto/gainforest/organization/layer/_addToProject\";\nimport { removeLayersFromProjectFactory } from \"./atproto/gainforest/organization/layer/_removeFromProject\";\nimport { getLayerFactory } from \"./atproto/gainforest/organization/layer/get\";\nimport { getProjectFactory } from \"./atproto/hypercerts/claim/project/get\";\nimport { getAllProjectsFactory } from \"./atproto/hypercerts/claim/project/getAll\";\n\nimport type { SupportedPDSDomain } from \"@/_internal/index\";\nimport z from \"zod\";\nimport { getAllLayersFactory } from \"./atproto/gainforest/organization/layer/getAll\";\nimport { getAllClaimActivitiesFactory } from \"./atproto/hypercerts/claim/activity/getAll\";\nexport class AppRouterFactory<T extends SupportedPDSDomain> {\n  public allowedPDSDomains;\n  public allowedPDSDomainSchema;\n  public appRouter;\n\n  constructor(_allowedPDSDomains: T[]) {\n    this.allowedPDSDomains = _allowedPDSDomains;\n    this.allowedPDSDomainSchema = z.enum(this.allowedPDSDomains);\n\n    this.appRouter = createTRPCRouter({\n      health: publicProcedure.query(() => ({ status: \"ok\" })),\n      common: {\n        uploadFileAsBlob: uploadFileAsBlobFactory(this.allowedPDSDomainSchema),\n      },\n      auth: {\n        login: loginFactory(this.allowedPDSDomainSchema),\n        resume: resumeFactory(this.allowedPDSDomainSchema),\n        logout: logoutFactory(this.allowedPDSDomainSchema),\n      },\n      gainforest: {\n        organization: {\n          info: {\n            get: getOrganizationInfoFactory(this.allowedPDSDomainSchema),\n            createOrUpdate: createOrUpdateOrganizationInfoFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n          layer: {\n            get: getLayerFactory(this.allowedPDSDomainSchema),\n            getAll: getAllLayersFactory(this.allowedPDSDomainSchema),\n            createOrUpdate: createOrUpdateLayerFactory(\n              this.allowedPDSDomainSchema\n            ),\n            addToProject: addLayersToProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n            removeFromProject: removeLayersFromProjectFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n          observations: {\n            measuredTreesCluster: {\n              get: getMeasuredTreesFactory(this.allowedPDSDomainSchema),\n              addToProject: addMeasuredTreesClusterToProjectFactory(\n                this.allowedPDSDomainSchema\n              ),\n              removeFromProject: removeMeasuredTreesClusterFromProjectFactory(\n                this.allowedPDSDomainSchema\n              ),\n            },\n          },\n        },\n      },\n      hypercerts: {\n        claim: {\n          activity: {\n            create: createClaimActivityFactory(this.allowedPDSDomainSchema),\n            getAllAcrossOrgs: getAllClaimActivitiesAcrossOrganizationsFactory(\n              this.allowedPDSDomainSchema\n            ),\n            get: getCliamActivityFactory(this.allowedPDSDomainSchema),\n            getAll: getAllClaimActivitiesFactory(this.allowedPDSDomainSchema),\n          },\n          project: {\n            get: getProjectFactory(this.allowedPDSDomainSchema),\n            getAll: getAllProjectsFactory(this.allowedPDSDomainSchema),\n            createOrUpdate: createOrUpdateOrganizationInfoFactory(\n              this.allowedPDSDomainSchema\n            ),\n          },\n        },\n        location: {\n          get: getLocationFactory(this.allowedPDSDomainSchema),\n          getAll: getAllLocationsFactory(this.allowedPDSDomainSchema),\n          create: createLocationFactory(this.allowedPDSDomainSchema),\n          update: updateLocationFactory(this.allowedPDSDomainSchema),\n          delete: deleteLocationFactory(this.allowedPDSDomainSchema),\n          getDefault: getDefaultLocationFactory(this.allowedPDSDomainSchema),\n          setDefault: setDefaultLocationFactory(this.allowedPDSDomainSchema),\n        },\n      },\n    });\n  }\n\n  getServerCaller = () => {\n    return this.appRouter.createCaller(\n      async () =>\n        await createContext({ allowedPDSDomains: this.allowedPDSDomains })\n    );\n  };\n}\n\nexport type AppRouter<T extends SupportedPDSDomain> =\n  AppRouterFactory<T>[\"appRouter\"];\n","import { z } from \"zod\";\nimport { getBlobUrl, parseAtUri } from \"./utilities/atproto\";\nimport { AppRouterFactory, type AppRouter } from \"./server/routers/_app\";\n\nconst supportedDomains = [\"climateai.org\", \"hypercerts.org\"] as const;\nexport const supportedPDSDomainSchema = z.enum(supportedDomains);\nconst supportedPDSDomainsSchema = z.array(supportedPDSDomainSchema);\nexport type SupportedPDSDomain = (typeof supportedDomains)[number];\n\nexport class GainforestSDK<T extends SupportedPDSDomain> {\n  public allowedPDSDomains;\n  public appRouter;\n  public getServerCaller;\n  public utilities;\n\n  constructor(_allowedPDSDomains: T[]) {\n    if (!Array.isArray(_allowedPDSDomains)) {\n      throw new Error(\"Allowed domains must be an array\");\n    } else if (_allowedPDSDomains.length === 0) {\n      throw new Error(\"There should be at least one allowed domain\");\n    }\n    if (!supportedPDSDomainsSchema.safeParse(_allowedPDSDomains).success) {\n      throw new Error(\n        \"One of the domains is not supported. Supported domains are: \" +\n          supportedDomains.join(\", \") +\n          \". Received domains: \" +\n          JSON.stringify(_allowedPDSDomains, null, 2)\n      );\n    }\n    this.allowedPDSDomains = _allowedPDSDomains;\n    const appRouterFactory = new AppRouterFactory<T>(this.allowedPDSDomains);\n    this.appRouter = appRouterFactory.appRouter;\n    this.getServerCaller = appRouterFactory.getServerCaller;\n    this.utilities = {\n      getBlobUrl: getBlobUrl<T>,\n      parseAtUri,\n    };\n  }\n}\n\nexport type { AppRouter };\nexport { createContext } from \"./server/trpc\";\n","export * from \"../_internal\";\n\nimport { GainforestSDK as SDKInternal } from \"../_internal\";\n\nconst sdkInternal = new SDKInternal([\"climateai.org\", \"hypercerts.org\"]);\nconst serverCallerInternal = sdkInternal.getServerCaller();\n"]}